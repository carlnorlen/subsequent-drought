join.type.second.live.other$Tree_Status <- 'Live'
#Add the total live tree data by plot
type.second.live.total <- subset(trees.second.type, Tree_Status == 'Live')
colnames(type.second.live.other) <- c("tree_type", "PLOT", "Tree_Status", "drought", "biomass.live", "count.live", "basal_area.live")
join.type.second.live.other <- left_join(plots.second.both, type.second.live.other, by = c('PLOT', 'drought'))
join.type.second.live.other$Tree_Status <- 'Live'
type.second.live <- rbind(join.type.second.live.pine, join.type.second.live.other)
type.second.live <- dplyr::select(type.second.live, -rmv)
type.second.dead.pine <- subset(trees.second.type, Tree_Status == 'Dead' & tree_type == 'pine/fir')
colnames(type.second.dead.pine) <- c("tree_type", "PLOT", "Tree_Status", "drought", "biomass.dead", "count.dead", "basal_area.dead")
join.type.second.dead.pine <- left_join(plots.second.both, type.second.dead.pine, by = c('PLOT', 'drought'))
join.type.second.dead.pine$Tree_Status <- 'Dead'
type.second.dead.other <- subset(trees.second.type, Tree_Status == 'Dead' & tree_type == 'other tree')
colnames(type.second.dead.other) <- c("tree_type", "PLOT", "Tree_Status", "drought", "biomass.dead", "count.dead", "basal_area.dead")
join.type.second.dead.other <- left_join(plots.second.both, type.second.dead.other, by = c('PLOT', 'drought'))
join.type.second.dead.other$Tree_Status <- 'Dead'
type.second.dead <- rbind(join.type.second.dead.pine, join.type.second.dead.other)
type.second.dead <- dplyr::select(type.second.dead, -rmv)
#Add a row for each plot of with the total live and dead biomass
type.second.join <- left_join(type.second.sum, type.second.live, by = c('PLOT', 'drought', 'tree_type'))
type.second.all <- left_join(type.second.join, type.second.dead, by = c('PLOT', 'drought', 'tree_type'))
head(type.second.all)
#Filling in live plot variables
type.second.all$count.live[is.na(type.second.all$count.live)] <- 0
type.second.all$biomass.live[is.na(type.second.all$biomass.live)] <- 0
type.second.all$basal_area.live[is.na(type.second.all$basal_area.live)] <- 0
#Filling in dead plot variables
type.second.all$count.dead[is.na(type.second.all$count.dead)] <- 0
type.second.all$biomass.dead[is.na(type.second.all$biomass.dead)] <- 0
type.second.all$basal_area.dead[is.na(type.second.all$basal_area.dead)] <- 0
type.second.all$basal_area.mort <- type.second.all$basal_area.dead / type.second.all$basal_area * 100
type.second.all <- as.data.frame(type.second.all)
head(type.second.all)
#Summaries by tree types across plots
type.second.summary <- type.second.all %>% group_by(tree_type, drought) %>% summarize(
biomass.mean = mean(biomass),
biomass.sd = sd(biomass),
biomass.se = sd(biomass) / sqrt(length(biomass)),
count.mean = mean(count),
count.sd = sd(count),
count.se = sd(count) / sqrt(length(count)),
basal_area.mean = mean(basal_area),
basal_area.sd = sd(basal_area),
basal_area.se = sd(basal_area) / sqrt(length(basal_area.dead)),
basal_area.dead.mean = mean(basal_area.dead),
basal_area.dead.sd = sd(basal_area.dead),
basal_area.dead.se = sd(basal_area.dead) / sqrt(length(basal_area.dead)),
mortality.mean = mean(basal_area.mort),
mortality.sd = sd(basal_area.mort),
mortality.se = sd(basal_area.mort) / sqrt(length(basal_area.mort)),
sample.size = length(count)
)
#Make the summary by tree type a data frame
type.second.summary <- as.data.frame(type.second.summary)
#Add the drought exposure sequence to the script.
type.summary$sequence <- 'Both Droughts'
type.second.summary$sequence <- '2012-2015 Only'
type.summary.all <- rbind(type.summary, type.second.summary)
# Combining the type data for the two drought sequence regions
type.all$sequence <- 'Both Droughts'
type.second.all$sequence <- '2012-2015 Only'
type.both.all <- rbind(type.all, type.second.all)
#Make tree_type a factor
type.both.all$tree_type <- factor(type.both.all$tree_type, levels = c("pine/fir", "other tree"))
p3 <- ggbarplot(filter(DIA.both.all), x = "drought", y = "basal_area.mort", fill = "DIA.group", color = 'sequence',
ylab = 'Mortality (%)', xlab = "Time Period", order = c("1999-2002", "2012-2015"), position = position_dodge(), #stat = "density",
add = "mean_se" , error.plot = "errorbar", alpha = 0.8) +
theme_bw() + guides(color = 'none') +
# scale_color_manual(values = c("#E66100", "#5D3A9B"), name = 'Drought \nSequence',
#                   #labels = c("pine/fir" = "Needleleaf \nConifer", "other tree" = 'Other \nTrees'),
#                   labels = c("Both Droughts" =  "Both \nDroughts", "2012-2015 Only" = "2012-2015 \nOnly"),
#                   aesthetics = "fill") +
theme(legend.background = element_rect(colour = NA, fill = NA), legend.justification = c(1, 0),
legend.position = c(0.75, 0.45), legend.text = element_text(size = 6), legend.title = element_text(size = 8),
legend.direction = "vertical", axis.text.x = element_text(size = 8), axis.title.x = element_text(size = 10),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10)) +
# geom_text(data = p1_texta, mapping = aes(x = x, y = y, label = label), size = 5) +
# geom_text(data = p1_textb, mapping = aes(x = x, y = y, label = label), size = 3) +
geom_text(data = data.frame(label = "Mean \n+/- SE", y = 30, x = 1.25, sequence = 'Both Droughts'), mapping = aes(x=x, y=y, label = label), size = 2) +
facet_grid(~ factor(sequence, levels = c('Both Droughts', '2012-2015 Only')))
p3
DIA.both.all
DIA.summary.all
DIA.second.all
DIA.second.join
DIA.second.sum
DIA.second.dead
DIA.second.live
DIA.second.live.small <- subset(trees.second.DIA, Tree_Status == 'Live' & DIA.group == '12.7-19.9 cm')
colnames(DIA.second.live.small) <- c("DIA.group", "PLOT", "Tree_Status", "drought", "biomass.live", "count.live", "basal_area.live")
join.DIA.second.live.small <- left_join(plots.second.both, DIA.second.live.small, by = c('PLOT', 'drought'))
join.DIA.second.live.small$DIA.group <- '12.7-19.9 cm'
join.DIA.second.live.small$Tree_Status <- 'Live'
#Create the DIA mid group
DIA.second.live.mid <- subset(trees.second.DIA, Tree_Status == 'Live' & DIA.group == '20-29.9 cm')
colnames(DIA.second.live.mid) <- c("DIA.group", "PLOT", "Tree_Status", "drought", "biomass.live", "count.live", "basal_area.live")
join.DIA.second.live.mid <- left_join(plots.second.both, DIA.second.live.mid, by = c('PLOT', 'drought'))
join.DIA.second.live.mid$DIA.group <- '20-29.9 cm'
join.DIA.second.live.mid$Tree_Status <- 'Live'
#Create the DIA large group
DIA.second.live.large <- subset(trees.second.DIA, Tree_Status == 'Live' & DIA.group == '30-39.9 cm')
colnames(DIA.second.live.large) <- c("DIA.group", "PLOT", "Tree_Status", "drought", "biomass.live", "count.live", "basal_area.live")
join.DIA.second.live.large <- left_join(plots.second.both, DIA.second.live.large, by = c('PLOT', 'drought'))
join.DIA.second.live.large$DIA.group <- '30-39.9 cm'
join.DIA.second.live.large$Tree_Status <- 'Live'
#Create the DIA largest group
DIA.second.live.largest <- subset(trees.second.DIA, Tree_Status == 'Live' & DIA.group == '40+ cm')
colnames(DIA.second.live.largest) <- c("DIA.group", "PLOT", "Tree_Status", "drought", "biomass.live", "count.live", "basal_area.live")
join.DIA.second.live.largest <- left_join(plots.second.both, DIA.second.live.largest, by = c('PLOT', 'drought'))
join.DIA.second.live.largest$DIA.group <- '40+ cm'
join.DIA.second.live.largest$Tree_Status <- 'Live'
DIA.second.live <- rbind(join.DIA.second.live.small, join.DIA.second.live.mid, join.DIA.second.live.large, join.DIA.second.live.largest)
rmv <- c('Tree_Status')
DIA.second.live <- select(DIA.second.live, -rmv)
#Dead plots
#Create the DIA small group
DIA.second.dead.small <- subset(trees.second.DIA, Tree_Status == 'Dead' & DIA.group == '12.7-19.9 cm')
colnames(DIA.second.dead.small) <- c("DIA.group", "PLOT", "Tree_Status", "drought", "biomass.dead", "count.dead", "basal_area.dead")
join.DIA.second.dead.small <- left_join(plots.second.both, DIA.second.dead.small, by = c('PLOT', 'drought'))
join.DIA.second.dead.small$DIA.group <- '12.7-19.9 cm'
join.DIA.second.dead.small$Tree_Status <- 'dead'
#Create the DIA mid group
DIA.second.dead.mid <- subset(trees.second.DIA, Tree_Status == 'Dead' & DIA.group == '20-29.9 cm')
colnames(DIA.second.dead.mid) <- c("DIA.group", "PLOT", "Tree_Status", "drought", "biomass.dead", "count.dead", "basal_area.dead")
join.DIA.second.dead.mid <- left_join(plots.second.both, DIA.second.dead.mid, by = c('PLOT', 'drought'))
join.DIA.second.dead.mid$DIA.group <- '20-29.9 cm'
join.DIA.second.dead.mid$Tree_Status <- 'Dead'
#Create the DIA large group
DIA.second.dead.large <- subset(trees.second.DIA, Tree_Status == 'Dead' & DIA.group == '30-39.9 cm')
colnames(DIA.second.dead.large) <- c("DIA.group", "PLOT", "Tree_Status", "drought", "biomass.dead", "count.dead", "basal_area.dead")
join.DIA.second.dead.large <- left_join(plots.second.both, DIA.second.dead.large, by = c('PLOT', 'drought'))
join.DIA.second.dead.large$DIA.group <- '30-39.9 cm'
join.DIA.second.dead.large$Tree_Status <- 'Dead'
#Create the DIA largest group
DIA.second.dead.largest <- subset(trees.second.DIA, Tree_Status == 'Dead' & DIA.group == '40+ cm')
colnames(DIA.second.dead.largest) <- c("DIA.group", "PLOT", "Tree_Status", "drought", "biomass.dead", "count.dead", "basal_area.dead")
join.DIA.second.dead.largest <- left_join(plots.second.both, DIA.second.dead.largest, by = c('PLOT', 'drought'))
join.DIA.second.dead.largest$DIA.group <- '40+ cm'
join.DIA.second.dead.largest$Tree_Status <- 'Dead'
#Bind the dead DIA groups together
DIA.second.dead <- rbind(join.DIA.second.dead.small, join.DIA.second.dead.mid, join.DIA.second.dead.large, join.DIA.second.dead.largest) #, join.DIA.dead.large)
DIA.second.dead <- select(DIA.second.dead, -rmv)
DIA.second.join <- left_join(DIA.second.sum, DIA.second.live, by = c('PLOT', 'drought', 'DIA.group'))
DIA.second.join
DIA.second.sum
DIA.second.dead
DIA.second.live
DIA.second.join
DIA.second.all <- left_join(DIA.second.join, DIA.second.dead, by = c('PLOT', 'drought', 'DIA.group'))
#Filling in live plot variables
DIA.second.all$count.live[is.na(DIA.second.all$count.live)] <- 0
DIA.second.all$biomass.live[is.na(DIA.second.all$biomass.live)] <- 0
DIA.second.all$basal_area.live[is.na(DIA.second.all$basal_area.live)] <- 0
#Filling in dead plot variables
DIA.second.all$count.dead[is.na(DIA.second.all$count.dead)] <- 0
DIA.second.all$biomass.dead[is.na(DIA.second.all$biomass.dead)] <- 0
DIA.second.all$basal_area.dead[is.na(DIA.second.all$basal_area.dead)] <- 0
DIA.second.all$basal_area.mort <- DIA.second.all$basal_area.dead / DIA.second.all$basal_area * 100
DIA.second.all <- as.data.frame(DIA.second.all)
DIA.second.all
#Summary statistics across plots by DIA
DIA.second.summary <- DIA.second.all %>% group_by(DIA.group, drought) %>% summarize(
biomass.mean = mean(biomass),
biomass.sd = sd(biomass),
biomass.se = sd(biomass) / sqrt(length(biomass)),
count.mean = mean(count),
count.sd = sd(count),
count.se = sd(count) / sqrt(length(count)),
basal_area.mean = mean(basal_area),
basal_area.sd = sd(basal_area),
basal_area.se = sd(basal_area) / sqrt(length(basal_area)),
mortality.mean = mean(basal_area.mort),
mortality.sd = sd(basal_area.mort),
mortality.se = sd(basal_area.mort) / sqrt(length(basal_area.mort)),
sample.size = length(count)
)
DIA.second.summary <- as.data.frame(DIA.second.summary)
DIA.second.all
DIA.second.summary
#Add the drought exposure sequence to the script.
DIA.summary$sequence <- 'Both Droughts'
DIA.second.summary$sequence <- '2012-2015 Only'
DIA.summary.all <- rbind(DIA.summary, DIA.second.summary)
DIA.summary.all
# Combining the type data for the two drought sequence regions
DIA.all$sequence <- 'Both Droughts'
DIA.second.all$sequence <- '2012-2015 Only'
DIA.both.all <- rbind(DIA.all, DIA.second.all)
#Make DIA.group a factor
DIA.both.all$DIA.group <- factor(DIA.both.all$DIA.group, levels = c('12.7-19.9 cm', '20-29.9 cm', '30-39.9 cm', '40+ cm'))
#Summarize by tree type
trees.second.type <- trees.second %>% group_by(tree_type, PLOT, Tree_Status, drought) %>% summarize(
biomass = sum(live_biomass),
count = sum(count),
basal_area = sum(basal_area)
)
#Convert into a data frame
trees.second.type <- as.data.frame(trees.second.type)
#Full plot summaries by tree type
type.second.sum <- trees.second %>% group_by(tree_type, PLOT, drought) %>% summarize(
biomass = sum(live_biomass),
count = sum(count),
basal_area = sum(basal_area)
)
#Full plot summaries without tree type
plot.second.sum <- trees.second %>% group_by(PLOT, drought, Tree_Status) %>% summarize(
biomass = sum(live_biomass),
count = sum(count),
basal_area = sum(basal_area)
)
head(plot.second.sum)
#Adding in zero rows for Tree Types analysis
#Add the live pine tree data by plot
type.second.live.pine <- subset(trees.second.type, Tree_Status == 'Live' & tree_type == 'pine/fir')
colnames(type.second.live.pine) <- c("tree_type", "PLOT", "Tree_Status", "drought", "biomass.live", "count.live", "basal_area.live")
join.type.second.live.pine <- left_join(plots.second.both, type.second.live.pine, by = c('PLOT', 'drought'))
join.type.second.live.pine$Tree_Status <- 'Live'
#Add the live other tree data by plot
type.second.live.other <- subset(trees.second.type, Tree_Status == 'Live' & tree_type == 'other tree')
colnames(type.second.live.other) <- c("tree_type", "PLOT", "Tree_Status", "drought", "biomass.live", "count.live", "basal_area.live")
join.type.second.live.other <- left_join(plots.second.both, type.second.live.other, by = c('PLOT', 'drought'))
join.type.second.live.other$Tree_Status <- 'Live'
#Add the total live tree data by plot
type.second.live.total <- subset(trees.second.type, Tree_Status == 'Live')
colnames(type.second.live.other) <- c("tree_type", "PLOT", "Tree_Status", "drought", "biomass.live", "count.live", "basal_area.live")
join.type.second.live.other <- left_join(plots.second.both, type.second.live.other, by = c('PLOT', 'drought'))
join.type.second.live.other$Tree_Status <- 'Live'
type.second.live <- rbind(join.type.second.live.pine, join.type.second.live.other)
type.second.live <- dplyr::select(type.second.live, -rmv)
type.second.dead.pine <- subset(trees.second.type, Tree_Status == 'Dead' & tree_type == 'pine/fir')
colnames(type.second.dead.pine) <- c("tree_type", "PLOT", "Tree_Status", "drought", "biomass.dead", "count.dead", "basal_area.dead")
join.type.second.dead.pine <- left_join(plots.second.both, type.second.dead.pine, by = c('PLOT', 'drought'))
join.type.second.dead.pine$Tree_Status <- 'Dead'
type.second.dead.other <- subset(trees.second.type, Tree_Status == 'Dead' & tree_type == 'other tree')
colnames(type.second.dead.other) <- c("tree_type", "PLOT", "Tree_Status", "drought", "biomass.dead", "count.dead", "basal_area.dead")
join.type.second.dead.other <- left_join(plots.second.both, type.second.dead.other, by = c('PLOT', 'drought'))
join.type.second.dead.other$Tree_Status <- 'Dead'
type.second.dead <- rbind(join.type.second.dead.pine, join.type.second.dead.other)
type.second.dead <- dplyr::select(type.second.dead, -rmv)
#Add a row for each plot of with the total live and dead biomass
type.second.join <- left_join(type.second.sum, type.second.live, by = c('PLOT', 'drought', 'tree_type'))
type.second.all <- left_join(type.second.join, type.second.dead, by = c('PLOT', 'drought', 'tree_type'))
head(type.second.all)
#Filling in live plot variables
type.second.all$count.live[is.na(type.second.all$count.live)] <- 0
type.second.all$biomass.live[is.na(type.second.all$biomass.live)] <- 0
type.second.all$basal_area.live[is.na(type.second.all$basal_area.live)] <- 0
#Filling in dead plot variables
type.second.all$count.dead[is.na(type.second.all$count.dead)] <- 0
type.second.all$biomass.dead[is.na(type.second.all$biomass.dead)] <- 0
type.second.all$basal_area.dead[is.na(type.second.all$basal_area.dead)] <- 0
type.second.all$basal_area.mort <- type.second.all$basal_area.dead / type.second.all$basal_area * 100
type.second.all <- as.data.frame(type.second.all)
head(type.second.all)
#Summaries by tree types across plots
type.second.summary <- type.second.all %>% group_by(tree_type, drought) %>% summarize(
biomass.mean = mean(biomass),
biomass.sd = sd(biomass),
biomass.se = sd(biomass) / sqrt(length(biomass)),
count.mean = mean(count),
count.sd = sd(count),
count.se = sd(count) / sqrt(length(count)),
basal_area.mean = mean(basal_area),
basal_area.sd = sd(basal_area),
basal_area.se = sd(basal_area) / sqrt(length(basal_area.dead)),
basal_area.dead.mean = mean(basal_area.dead),
basal_area.dead.sd = sd(basal_area.dead),
basal_area.dead.se = sd(basal_area.dead) / sqrt(length(basal_area.dead)),
mortality.mean = mean(basal_area.mort),
mortality.sd = sd(basal_area.mort),
mortality.se = sd(basal_area.mort) / sqrt(length(basal_area.mort)),
sample.size = length(count)
)
#Make the summary by tree type a data frame
type.second.summary <- as.data.frame(type.second.summary)
#Add the drought exposure sequence to the script.
type.summary$sequence <- 'Both Droughts'
type.second.summary$sequence <- '2012-2015 Only'
type.summary.all <- rbind(type.summary, type.second.summary)
# Combining the type data for the two drought sequence regions
type.all$sequence <- 'Both Droughts'
type.second.all$sequence <- '2012-2015 Only'
type.both.all <- rbind(type.all, type.second.all)
#Make tree_type a factor
type.both.all$tree_type <- factor(type.both.all$tree_type, levels = c("pine/fir", "other tree"))
p3 <- ggbarplot(filter(DIA.both.all), x = "drought", y = "basal_area.mort", fill = "DIA.group", color = 'sequence',
ylab = 'Mortality (%)', xlab = "Time Period", order = c("1999-2002", "2012-2015"), position = position_dodge(), #stat = "density",
add = "mean_se" , error.plot = "errorbar", alpha = 0.8) +
theme_bw() + guides(color = 'none') +
# scale_color_manual(values = c("#E66100", "#5D3A9B"), name = 'Drought \nSequence',
#                   #labels = c("pine/fir" = "Needleleaf \nConifer", "other tree" = 'Other \nTrees'),
#                   labels = c("Both Droughts" =  "Both \nDroughts", "2012-2015 Only" = "2012-2015 \nOnly"),
#                   aesthetics = "fill") +
theme(legend.background = element_rect(colour = NA, fill = NA), legend.justification = c(1, 0),
legend.position = c(0.75, 0.45), legend.text = element_text(size = 6), legend.title = element_text(size = 8),
legend.direction = "vertical", axis.text.x = element_text(size = 8), axis.title.x = element_text(size = 10),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10)) +
# geom_text(data = p1_texta, mapping = aes(x = x, y = y, label = label), size = 5) +
# geom_text(data = p1_textb, mapping = aes(x = x, y = y, label = label), size = 3) +
geom_text(data = data.frame(label = "Mean \n+/- SE", y = 30, x = 1.25, sequence = 'Both Droughts'), mapping = aes(x=x, y=y, label = label), size = 2) +
facet_grid(~ factor(sequence, levels = c('Both Droughts', '2012-2015 Only')))
p3
#Save the figure as a .png file
ggsave(filename = 'SFig7_mortality_by_DBH_boxplot.png', height=7, width=14, units = 'cm', dpi=900)
p3 <- ggbarplot(filter(DIA.both.all), x = "drought", y = "basal_area.mort", fill = "DIA.group", color = 'sequence',
ylab = 'Mortality (%)', xlab = "Time Period", order = c("1999-2002", "2012-2015"), position = position_dodge(), #stat = "density",
add = "mean_se" , error.plot = "errorbar", alpha = 0.8) +
theme_bw() + guides(color = 'none') +
scale_color_manual(values = c("#E66100", "#5D3A9B"), name = 'Drought \nSequence',
#labels = c("pine/fir" = "Needleleaf \nConifer", "other tree" = 'Other \nTrees'),
labels = c("Both Droughts" =  "Both \nDroughts", "2012-2015 Only" = "2012-2015 \nOnly"),
aesthetics = "fill") +
theme(legend.background = element_rect(colour = NA, fill = NA), legend.justification = c(1, 0),
legend.position = c(0.75, 0.4), legend.text = element_text(size = 6), legend.title = element_text(size = 8),
legend.direction = "vertical", axis.text.x = element_text(size = 8), axis.title.x = element_text(size = 10),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10)) +
# geom_text(data = p1_texta, mapping = aes(x = x, y = y, label = label), size = 5) +
# geom_text(data = p1_textb, mapping = aes(x = x, y = y, label = label), size = 3) +
geom_text(data = data.frame(label = "Mean \n+/- SE", y = 35, x = 1.5, sequence = 'Both Droughts'), mapping = aes(x=x, y=y, label = label), size = 2) +
facet_grid(~ factor(sequence, levels = c('Both Droughts', '2012-2015 Only')))
p3
p3 <- ggbarplot(filter(DIA.both.all), x = "drought", y = "basal_area.mort", fill = "DIA.group", color = 'sequence',
ylab = 'Mortality (%)', xlab = "Time Period", order = c("1999-2002", "2012-2015"), position = position_dodge(), #stat = "density",
add = "mean_se" , error.plot = "errorbar", alpha = 0.8) +
theme_bw() + guides(color = 'none') +
scale_color_manual(values = c("#E66100", "#5D3A9B"), name = 'Drought \nSequence',
#labels = c("pine/fir" = "Needleleaf \nConifer", "other tree" = 'Other \nTrees'),
labels = c("Both Droughts" =  "Both \nDroughts", "2012-2015 Only" = "2012-2015 \nOnly"),
aesthetics = "color") +
theme(legend.background = element_rect(colour = NA, fill = NA), legend.justification = c(1, 0),
legend.position = c(0.75, 0.4), legend.text = element_text(size = 6), legend.title = element_text(size = 8),
legend.direction = "vertical", axis.text.x = element_text(size = 8), axis.title.x = element_text(size = 10),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10)) +
# geom_text(data = p1_texta, mapping = aes(x = x, y = y, label = label), size = 5) +
# geom_text(data = p1_textb, mapping = aes(x = x, y = y, label = label), size = 3) +
geom_text(data = data.frame(label = "Mean \n+/- SE", y = 35, x = 1.5, sequence = 'Both Droughts'), mapping = aes(x=x, y=y, label = label), size = 2) +
facet_grid(~ factor(sequence, levels = c('Both Droughts', '2012-2015 Only')))
p3
#Save the figure as a .png file
ggsave(filename = 'SFig7_mortality_by_DBH_boxplot.png', height=7, width=14, units = 'cm', dpi=900)
p3 <- ggbarplot(filter(DIA.both.all), x = "drought", y = "basal_area.mort", fill = "DIA.group", color = 'sequence',
ylab = 'Mortality (%)', xlab = "Time Period", order = c("1999-2002", "2012-2015"), position = position_dodge(), #stat = "density",
add = "mean_se" , error.plot = "errorbar", alpha = 0.8) +
theme_bw() + guides(color = 'none', fill = 'Diameter \nGroup') +
scale_color_manual(values = c("#E66100", "#5D3A9B"), name = 'Drought \nSequence',
#labels = c("pine/fir" = "Needleleaf \nConifer", "other tree" = 'Other \nTrees'),
labels = c("Both Droughts" =  "Both \nDroughts", "2012-2015 Only" = "2012-2015 \nOnly"),
aesthetics = "color") +
theme(legend.background = element_rect(colour = NA, fill = NA), legend.justification = c(1, 0),
legend.position = c(0.75, 0.4), legend.text = element_text(size = 6), legend.title = element_text(size = 8),
legend.direction = "vertical", axis.text.x = element_text(size = 8), axis.title.x = element_text(size = 10),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10)) +
# geom_text(data = p1_texta, mapping = aes(x = x, y = y, label = label), size = 5) +
# geom_text(data = p1_textb, mapping = aes(x = x, y = y, label = label), size = 3) +
geom_text(data = data.frame(label = "Mean \n+/- SE", y = 35, x = 1.5, sequence = 'Both Droughts'), mapping = aes(x=x, y=y, label = label), size = 2) +
facet_grid(~ factor(sequence, levels = c('Both Droughts', '2012-2015 Only')))
p3
p3 <- ggbarplot(filter(DIA.both.all), x = "drought", y = "basal_area.mort", fill = "DIA.group", color = 'sequence',
ylab = 'Mortality (%)', xlab = "Time Period", order = c("1999-2002", "2012-2015"), position = position_dodge(), #stat = "density",
add = "mean_se" , error.plot = "errorbar", alpha = 0.8) +
theme_bw() + guides(color = 'none') + labs(color = "Diameter \nGroup")
scale_color_manual(values = c("#E66100", "#5D3A9B"), name = 'Drought \nSequence',
#labels = c("pine/fir" = "Needleleaf \nConifer", "other tree" = 'Other \nTrees'),
labels = c("Both Droughts" =  "Both \nDroughts", "2012-2015 Only" = "2012-2015 \nOnly"),
aesthetics = "color") +
theme(legend.background = element_rect(colour = NA, fill = NA), legend.justification = c(1, 0),
legend.position = c(0.75, 0.4), legend.text = element_text(size = 6), legend.title = element_text(size = 8),
legend.direction = "vertical", axis.text.x = element_text(size = 8), axis.title.x = element_text(size = 10),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10)) +
# geom_text(data = p1_texta, mapping = aes(x = x, y = y, label = label), size = 5) +
# geom_text(data = p1_textb, mapping = aes(x = x, y = y, label = label), size = 3) +
geom_text(data = data.frame(label = "Mean \n+/- SE", y = 35, x = 1.5, sequence = 'Both Droughts'), mapping = aes(x=x, y=y, label = label), size = 2) +
facet_grid(~ factor(sequence, levels = c('Both Droughts', '2012-2015 Only')))
p3
p3 <- ggbarplot(filter(DIA.both.all), x = "drought", y = "basal_area.mort", fill = "DIA.group", color = 'sequence',
ylab = 'Mortality (%)', xlab = "Time Period", order = c("1999-2002", "2012-2015"), position = position_dodge(), #stat = "density",
add = "mean_se" , error.plot = "errorbar", alpha = 0.8) +
theme_bw() + guides(color = 'none') + labs(color = "Diameter \nGroup") +
scale_color_manual(values = c("#E66100", "#5D3A9B"), name = 'Drought \nSequence',
#labels = c("pine/fir" = "Needleleaf \nConifer", "other tree" = 'Other \nTrees'),
labels = c("Both Droughts" =  "Both \nDroughts", "2012-2015 Only" = "2012-2015 \nOnly"),
aesthetics = "color") +
theme(legend.background = element_rect(colour = NA, fill = NA), legend.justification = c(1, 0),
legend.position = c(0.75, 0.4), legend.text = element_text(size = 6), legend.title = element_text(size = 8),
legend.direction = "vertical", axis.text.x = element_text(size = 8), axis.title.x = element_text(size = 10),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10)) +
# geom_text(data = p1_texta, mapping = aes(x = x, y = y, label = label), size = 5) +
# geom_text(data = p1_textb, mapping = aes(x = x, y = y, label = label), size = 3) +
geom_text(data = data.frame(label = "Mean \n+/- SE", y = 35, x = 1.5, sequence = 'Both Droughts'), mapping = aes(x=x, y=y, label = label), size = 2) +
facet_grid(~ factor(sequence, levels = c('Both Droughts', '2012-2015 Only')))
p3
p3 <- ggbarplot(filter(DIA.both.all), x = "drought", y = "basal_area.mort", fill = "DIA.group", color = 'sequence',
ylab = 'Mortality (%)', xlab = "Time Period", order = c("1999-2002", "2012-2015"), position = position_dodge(), #stat = "density",
add = "mean_se" , error.plot = "errorbar", alpha = 0.8) +
theme_bw() + guides(color = 'none') + labs(col = "Diameter \nGroup") +
scale_color_manual(values = c("#E66100", "#5D3A9B"), name = 'Drought \nSequence',
#labels = c("pine/fir" = "Needleleaf \nConifer", "other tree" = 'Other \nTrees'),
labels = c("Both Droughts" =  "Both \nDroughts", "2012-2015 Only" = "2012-2015 \nOnly"),
aesthetics = "color") +
theme(legend.background = element_rect(colour = NA, fill = NA), legend.justification = c(1, 0),
legend.position = c(0.75, 0.4), legend.text = element_text(size = 6), legend.title = element_text(size = 8),
legend.direction = "vertical", axis.text.x = element_text(size = 8), axis.title.x = element_text(size = 10),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10)) +
# geom_text(data = p1_texta, mapping = aes(x = x, y = y, label = label), size = 5) +
# geom_text(data = p1_textb, mapping = aes(x = x, y = y, label = label), size = 3) +
geom_text(data = data.frame(label = "Mean \n+/- SE", y = 35, x = 1.5, sequence = 'Both Droughts'), mapping = aes(x=x, y=y, label = label), size = 2) +
facet_grid(~ factor(sequence, levels = c('Both Droughts', '2012-2015 Only')))
p3
p3 <- ggbarplot(filter(DIA.both.all), x = "drought", y = "basal_area.mort", fill = "DIA.group", color = 'sequence',
ylab = 'Mortality (%)', xlab = "Time Period", order = c("1999-2002", "2012-2015"), position = position_dodge(), #stat = "density",
add = "mean_se" , error.plot = "errorbar", alpha = 0.8) +
theme_bw() + guides(color = 'none', color = guide_legend("Diameter \nGroup")) +
scale_color_manual(values = c("#E66100", "#5D3A9B"), name = 'Drought \nSequence',
#labels = c("pine/fir" = "Needleleaf \nConifer", "other tree" = 'Other \nTrees'),
labels = c("Both Droughts" =  "Both \nDroughts", "2012-2015 Only" = "2012-2015 \nOnly"),
aesthetics = "color") +
theme(legend.background = element_rect(colour = NA, fill = NA), legend.justification = c(1, 0),
legend.position = c(0.75, 0.4), legend.text = element_text(size = 6), legend.title = element_text(size = 8),
legend.direction = "vertical", axis.text.x = element_text(size = 8), axis.title.x = element_text(size = 10),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10)) +
# geom_text(data = p1_texta, mapping = aes(x = x, y = y, label = label), size = 5) +
# geom_text(data = p1_textb, mapping = aes(x = x, y = y, label = label), size = 3) +
geom_text(data = data.frame(label = "Mean \n+/- SE", y = 35, x = 1.5, sequence = 'Both Droughts'), mapping = aes(x=x, y=y, label = label), size = 2) +
facet_grid(~ factor(sequence, levels = c('Both Droughts', '2012-2015 Only')))
p3
p3 <- ggbarplot(filter(DIA.both.all), x = "drought", y = "basal_area.mort", fill = "DIA.group", color = 'sequence',
ylab = 'Mortality (%)', xlab = "Time Period", order = c("1999-2002", "2012-2015"), position = position_dodge(), #stat = "density",
add = "mean_se" , error.plot = "errorbar", alpha = 0.8) +
theme_bw() + guides(color = 'none', fill = guide_legend("Diameter \nGroup")) +
scale_color_manual(values = c("#E66100", "#5D3A9B"), name = 'Drought \nSequence',
#labels = c("pine/fir" = "Needleleaf \nConifer", "other tree" = 'Other \nTrees'),
labels = c("Both Droughts" =  "Both \nDroughts", "2012-2015 Only" = "2012-2015 \nOnly"),
aesthetics = "color") +
theme(legend.background = element_rect(colour = NA, fill = NA), legend.justification = c(1, 0),
legend.position = c(0.75, 0.4), legend.text = element_text(size = 6), legend.title = element_text(size = 8),
legend.direction = "vertical", axis.text.x = element_text(size = 8), axis.title.x = element_text(size = 10),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10)) +
# geom_text(data = p1_texta, mapping = aes(x = x, y = y, label = label), size = 5) +
# geom_text(data = p1_textb, mapping = aes(x = x, y = y, label = label), size = 3) +
geom_text(data = data.frame(label = "Mean \n+/- SE", y = 35, x = 1.5, sequence = 'Both Droughts'), mapping = aes(x=x, y=y, label = label), size = 2) +
facet_grid(~ factor(sequence, levels = c('Both Droughts', '2012-2015 Only')))
p3
#Save the figure as a .png file
ggsave(filename = 'SFig7_mortality_by_DBH_boxplot.png', height=7, width=14, units = 'cm', dpi=900)
p3 <- ggbarplot(filter(DIA.both.all), x = "drought", y = "basal_area.mort", fill = "DIA.group", color = 'sequence',
ylab = 'Mortality (%)', xlab = "Time Period", order = c("1999-2002", "2012-2015"), position = position_dodge(), #stat = "density",
add = "mean_se" , error.plot = "errorbar", alpha = 0.8) +
theme_bw() + guides(color = 'none', fill = guide_legend("Diameter \nGroup")) +
scale_color_manual(values = c("#E66100", "#5D3A9B"), name = 'Drought \nSequence',
#labels = c("pine/fir" = "Needleleaf \nConifer", "other tree" = 'Other \nTrees'),
labels = c("Both Droughts" =  "Both \nDroughts", "2012-2015 Only" = "2012-2015 \nOnly"),
aesthetics = "color") +
theme(legend.background = element_rect(colour = NA, fill = NA), legend.justification = c(1, 0),
legend.position = c(0.7, 0.35), legend.text = element_text(size = 6), legend.title = element_text(size = 8),
legend.direction = "vertical", axis.text.x = element_text(size = 8), axis.title.x = element_text(size = 10),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10)) +
# geom_text(data = p1_texta, mapping = aes(x = x, y = y, label = label), size = 5) +
# geom_text(data = p1_textb, mapping = aes(x = x, y = y, label = label), size = 3) +
geom_text(data = data.frame(label = "Mean \n+/- SE", y = 35, x = 1.5, sequence = 'Both Droughts'), mapping = aes(x=x, y=y, label = label), size = 2) +
facet_grid(~ factor(sequence, levels = c('Both Droughts', '2012-2015 Only')))
p3
#Save the figure as a .png file
ggsave(filename = 'SFig7_mortality_by_DBH_boxplot.png', height=7, width=14, units = 'cm', dpi=900)
p3 <- ggbarplot(filter(DIA.both.all), x = "drought", y = "basal_area.mort", fill = "DIA.group", color = 'sequence',
ylab = 'Mortality (%)', xlab = "Time Period", order = c("1999-2002", "2012-2015"), position = position_dodge(), #stat = "density",
add = "mean_se" , error.plot = "errorbar", alpha = 0.8) +
theme_bw() + guides(color = 'none', fill = guide_legend("Diameter \nGroup")) +
scale_color_manual(values = c("#E66100", "#5D3A9B"), name = 'Drought \nSequence',
#labels = c("pine/fir" = "Needleleaf \nConifer", "other tree" = 'Other \nTrees'),
labels = c("Both Droughts" =  "Both \nDroughts", "2012-2015 Only" = "2012-2015 \nOnly"),
aesthetics = "color") +
theme(legend.background = element_rect(colour = NA, fill = NA), legend.justification = c(1, 0),
legend.position = c(0.7, 0.3), legend.text = element_text(size = 6), legend.title = element_text(size = 8),
legend.direction = "vertical", axis.text.x = element_text(size = 8), axis.title.x = element_text(size = 10),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10)) +
# geom_text(data = p1_texta, mapping = aes(x = x, y = y, label = label), size = 5) +
# geom_text(data = p1_textb, mapping = aes(x = x, y = y, label = label), size = 3) +
geom_text(data = data.frame(label = "Mean \n+/- SE", y = 35, x = 1.5, sequence = 'Both Droughts'), mapping = aes(x=x, y=y, label = label), size = 2) +
facet_grid(~ factor(sequence, levels = c('Both Droughts', '2012-2015 Only')))
p3
#Save the figure as a .png file
ggsave(filename = 'SFig7_mortality_by_DBH_boxplot.png', height=7, width=14, units = 'cm', dpi=900)
p3 <- ggbarplot(filter(DIA.both.all), x = "drought", y = "basal_area.mort", fill = "DIA.group", color = 'sequence',
ylab = 'Mortality (%)', xlab = "Time Period", order = c("1999-2002", "2012-2015"), position = position_dodge(), #stat = "density",
add = "mean_se" , error.plot = "errorbar", alpha = 0.8) +
theme_bw() + guides(color = 'none', fill = guide_legend("Diameter \nGroup")) +
scale_color_manual(values = c("#E66100", "#5D3A9B"), name = 'Drought \nSequence',
#labels = c("pine/fir" = "Needleleaf \nConifer", "other tree" = 'Other \nTrees'),
labels = c("Both Droughts" =  "Both \nDroughts", "2012-2015 Only" = "2012-2015 \nOnly"),
aesthetics = "color") +
theme(legend.background = element_rect(colour = NA, fill = NA), legend.justification = c(1, 0),
legend.position = c(0.72, 0.28), legend.text = element_text(size = 6), legend.title = element_text(size = 8),
legend.direction = "vertical", axis.text.x = element_text(size = 8), axis.title.x = element_text(size = 10),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10)) +
# geom_text(data = p1_texta, mapping = aes(x = x, y = y, label = label), size = 5) +
# geom_text(data = p1_textb, mapping = aes(x = x, y = y, label = label), size = 3) +
geom_text(data = data.frame(label = "Mean \n+/- SE", y = 35, x = 1.5, sequence = 'Both Droughts'), mapping = aes(x=x, y=y, label = label), size = 2) +
facet_grid(~ factor(sequence, levels = c('Both Droughts', '2012-2015 Only')))
p3
#Save the figure as a .png file
ggsave(filename = 'SFig7_mortality_by_DBH_boxplot.png', height=7, width=14, units = 'cm', dpi=900)
DIA.aov.dead <- aov(data = filter(DIA.both.all), basal_area.mort ~ DIA.group + drought * sequence)
#Tukey Post Hoc analysis of dead basal area by DIA
DIA.dead.tHSD <- TukeyHSD(DIA.aov.dead)
summary(DIA.aov.dead)
summary(DIA.dead.tHSD)
DIA.dead.tHSD
DIA.aov.dead <- aov(data = filter(DIA.both.all), basal_area.mort ~ DIA.group * drought * sequence)
summary(DIA.aov.dead)
#Tukey Post Hoc analysis of dead basal area by DIA
DIA.dead.tHSD <- TukeyHSD(DIA.aov.dead)
DIA.dead.tHSD
