legend.position = c(0.66, 0.28), legend.text = element_text(size = 8), legend.title = element_text(size = 10),
legend.direction = "vertical", axis.text.x = element_text(size = 8), axis.title.x = element_text(size = 10),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10), strip.background = element_blank(),
strip.text.x = element_blank(), plot.margin = unit(c(0.5,0.5,0.5,0), "pt")) +
scale_x_discrete(labels = c("1st Exposure", "2nd Exposure")) +
geom_text(data = p2_texta, mapping = aes(x = x, y = y, label = label), size = 5) +
# geom_text(data = p1_textb, mapping = aes(x = x, y = y, label = label), size = 3) +
# geom_text(data = data.frame(label = "Mean \n+/- SE", y = 1.7, x = 1.5, sequence = 'Both Droughts'), mapping = aes(x=x, y=y, label = label), size = 2) +
facet_grid(~ factor(sequence, levels = c('Both Droughts', '2nd Drought Only')))
p2
# ggbarplot(order)
#Combine the two figure panels into one
f1 <- ggarrange(p1, p2, ncol = 1, labels = "auto", align = "v", nrow = 2, heights = c(1, 0.95), common.legend = FALSE)
f1
p1 <- ggbarplot(all.forest %>% filter(pltID %in% plots) %>% group_by(time.period, sequence, pltID) %>% summarize(BAA.all = sum(BAA.all), BAA.live = sum(BAA), BAA.dead.sum = sum(BAA.dead), BAA.mort = sum(BAA.dead) / sum(BAA.all) * 100), #%>% filter(COMMON_NAME %in% sp.both.2002[! sp.both.2002 %in% c('curlleaf mountain-mahogany', 'California live oak')]), #, (sequence == 'Both Droughts' & drought == '1999-2002') | (sequence == '2012-2015 Only' & drought == '2012-2015')),
x = "time.period", y = "BAA.dead.sum", position = position_dodge(), color = "sequence", fill = 'gray',
add = "mean_se" , error.plot = "errorbar", alpha = 0.8,
ylab = expression('Total Mortality\n(m'^2*' ha'^-1*')'),
xlab = "Time Period", order = c("1999-2002", "2012-2015")) +
theme_bw() + guides(color = 'none') +
scale_color_manual(values = c("black", "black"),
aesthetics = "color") +
theme(legend.background = element_rect(colour = NA, fill = NA), legend.justification = c(1, 0),
legend.position = c(0.76, 0.1), legend.text = element_text(size = 6), legend.title = element_text(size = 8),
legend.direction = "vertical", axis.text.x = element_blank(), axis.title.x = element_blank(),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10), plot.margin = unit(c(0.5,0.5,0.5,5), "pt")) +
scale_x_discrete(labels = c("1st Exposure", "2nd Exposure")) +
geom_text(data = p1_texta, mapping = aes(x = x, y = y, label = label), size = 5) +
geom_text(data = p1_textb, mapping = aes(x = x, y = y, label = label), size = 3) +
geom_text(data = data.frame(label = "Mean \n+/- SE", y = 2.88, x = 1.2, sequence = 'Both Droughts'), mapping = aes(x=x, y=y, label = label), size = 2) +
facet_grid(~ factor(sequence, levels = c('Both Droughts', '2nd Drought Only')))
p1
#Create a tree_type factor variable and sort it to make the plots
all.forest.type$tree_type.f <- all.forest.type$tree_type
all.forest.type$tree_type.f <- factor(all.forest.type$tree_type.f, levels= c('pine', 'fir', 'oak', 'juniper', 'cedar'))
# all.forest.type <- all.forest.type %>% mutate(tree_type.f = as.factor(tree.type.f(levels = c('pine', 'fir', 'oak', 'juniper', 'cedar'))))
#Add text to the plot
p2_texta <- data.frame(label = c("a", "ab", "bc", "c", "c", "bc", "bc", "bc", "c", "c",
"bc", "c", "c", "c", "c","a", "a", "bc", "c", "bc"),
sequence   = c('Both Droughts', 'Both Droughts', 'Both Droughts', 'Both Droughts', 'Both Droughts', 'Both Droughts',
'Both Droughts', 'Both Droughts', 'Both Droughts', 'Both Droughts', '2nd Drought Only', '2nd Drought Only',
'2nd Drought Only', '2nd Drought Only', '2nd Drought Only', '2nd Drought Only', '2nd Drought Only', '2nd Drought Only',
'2nd Drought Only', '2nd Drought Only'),
# tree_type = c('pine/fir', 'other tree', 'pine/fir', 'other tree',
#               'pine/fir', 'other tree', 'pine/fir', 'other tree'),
y     = c(2, 1.05, 0.55, 0.3, 0.18, 0.4, 0.26, 0.24, 0.3, 0.12,
0.24, 0.2, 0.12, 0.12, 0.12, 1.3, 1.33, 0.25, 0.12, 0.35),
x     = c(0.615, 0.81, 1.01, 1.2, 1.38, 1.615, 1.81, 2.01, 2.2, 2.38,
0.615, 0.81, 1.01, 1.2, 1.38, 1.615, 1.81, 2.01, 2.2, 2.38)
)
#Die-off Mortality as a % of basal area
p2 <- ggbarplot(all.forest.type %>% filter(pltID %in% plots & tree_type != 'other conifer' & tree_type != 'deciduous'), #%>% filter(COMMON_NAME %in% sp.both.2002[! sp.both.2002 %in% c('curlleaf mountain-mahogany', 'California live oak')]), #, (sequence == 'Both Droughts' & drought == '1999-2002') | (sequence == '2012-2015 Only' & drought == '2012-2015')),
x = "time.period", y = "BAA.dead.sum", fill = 'tree_type.f',
color = "sequence",
position = position_dodge(), add = "mean_se" , error.plot = "errorbar", alpha = 0.8,
ylab = expression('Mortality by Tree Type\n(m'^2*' ha'^-1*')'),
xlab = "Time Period", order = c("1999-2002", "2012-2015")) +
theme_bw() + guides(color = 'none', fill = guide_legend(title = "Tree Type", ncol = 1)) +
scale_color_manual(values = c("black", "black"), aesthetics = "color") +
scale_fill_discrete(labels = c("pine" = "Pine", "fir" = "Fir", "juniper" = "Juniper", "oak" = "Oak", "cedar" = "Cedar")) +
theme(legend.background = element_rect(colour = NA, fill = NA), legend.justification = c(1, 0),
legend.position = c(0.66, 0.28), legend.text = element_text(size = 8), legend.title = element_text(size = 10),
legend.direction = "vertical", axis.text.x = element_text(size = 8), axis.title.x = element_text(size = 10),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10), strip.background = element_blank(),
strip.text.x = element_blank(), plot.margin = unit(c(0.5,0.5,0.5,0), "pt")) +
scale_x_discrete(labels = c("1st Exposure", "2nd Exposure")) +
geom_text(data = p2_texta, mapping = aes(x = x, y = y, label = label), size = 5) +
# geom_text(data = p1_textb, mapping = aes(x = x, y = y, label = label), size = 3) +
# geom_text(data = data.frame(label = "Mean \n+/- SE", y = 1.7, x = 1.5, sequence = 'Both Droughts'), mapping = aes(x=x, y=y, label = label), size = 2) +
facet_grid(~ factor(sequence, levels = c('Both Droughts', '2nd Drought Only')))
p2
# ggbarplot(order)
#Combine the two figure panels into one
f1 <- ggarrange(p1, p2, ncol = 1, labels = "auto", align = "v", nrow = 2, heights = c(1, 0.95), common.legend = FALSE)
f1
ggsave(filename = 'Fig4_FIA_mortality_by_tree_type.png', height=14, width=16, units = 'cm', dpi=900)
p1 <- ggbarplot(all.forest %>% filter(pltID %in% plots) %>% group_by(time.period, sequence, pltID) %>% summarize(BAA.all = sum(BAA.all), BAA.live = sum(BAA), BAA.dead.sum = sum(BAA.dead), BAA.mort = sum(BAA.dead) / sum(BAA.all) * 100), #%>% filter(COMMON_NAME %in% sp.both.2002[! sp.both.2002 %in% c('curlleaf mountain-mahogany', 'California live oak')]), #, (sequence == 'Both Droughts' & drought == '1999-2002') | (sequence == '2012-2015 Only' & drought == '2012-2015')),
x = "time.period", y = "BAA.dead.sum", position = position_dodge(), color = "sequence", fill = 'gray',
add = "mean_se" , error.plot = "errorbar", alpha = 0.8,
ylab = expression('Mortality (m'^2*' ha'^-1*')'),
xlab = "Time Period", order = c("1999-2002", "2012-2015")) +
theme_bw() + guides(color = 'none') +
scale_color_manual(values = c("black", "black"),
aesthetics = "color") +
theme(legend.background = element_rect(colour = NA, fill = NA), legend.justification = c(1, 0),
legend.position = c(0.76, 0.1), legend.text = element_text(size = 6), legend.title = element_text(size = 8),
legend.direction = "vertical", axis.text.x = element_blank(), axis.title.x = element_blank(),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10), plot.margin = unit(c(0.5,0.5,0.5,5), "pt")) +
scale_x_discrete(labels = c("1st Exposure", "2nd Exposure")) +
geom_text(data = p1_texta, mapping = aes(x = x, y = y, label = label), size = 5) +
geom_text(data = p1_textb, mapping = aes(x = x, y = y, label = label), size = 3) +
geom_text(data = data.frame(label = "Mean \n+/- SE", y = 2.88, x = 1.2, sequence = 'Both Droughts'), mapping = aes(x=x, y=y, label = label), size = 2) +
facet_grid(~ factor(sequence, levels = c('Both Droughts', '2nd Drought Only')))
p1
#Create a tree_type factor variable and sort it to make the plots
all.forest.type$tree_type.f <- all.forest.type$tree_type
all.forest.type$tree_type.f <- factor(all.forest.type$tree_type.f, levels= c('pine', 'fir', 'oak', 'juniper', 'cedar'))
# all.forest.type <- all.forest.type %>% mutate(tree_type.f = as.factor(tree.type.f(levels = c('pine', 'fir', 'oak', 'juniper', 'cedar'))))
#Add text to the plot
p2_texta <- data.frame(label = c("a", "ab", "bc", "c", "c", "bc", "bc", "bc", "c", "c",
"bc", "c", "c", "c", "c","a", "a", "bc", "c", "bc"),
sequence   = c('Both Droughts', 'Both Droughts', 'Both Droughts', 'Both Droughts', 'Both Droughts', 'Both Droughts',
'Both Droughts', 'Both Droughts', 'Both Droughts', 'Both Droughts', '2nd Drought Only', '2nd Drought Only',
'2nd Drought Only', '2nd Drought Only', '2nd Drought Only', '2nd Drought Only', '2nd Drought Only', '2nd Drought Only',
'2nd Drought Only', '2nd Drought Only'),
# tree_type = c('pine/fir', 'other tree', 'pine/fir', 'other tree',
#               'pine/fir', 'other tree', 'pine/fir', 'other tree'),
y     = c(2, 1.05, 0.55, 0.3, 0.18, 0.4, 0.26, 0.24, 0.3, 0.12,
0.24, 0.2, 0.12, 0.12, 0.12, 1.3, 1.33, 0.25, 0.12, 0.35),
x     = c(0.615, 0.81, 1.01, 1.2, 1.38, 1.615, 1.81, 2.01, 2.2, 2.38,
0.615, 0.81, 1.01, 1.2, 1.38, 1.615, 1.81, 2.01, 2.2, 2.38)
)
#Die-off Mortality as a % of basal area
p2 <- ggbarplot(all.forest.type %>% filter(pltID %in% plots & tree_type != 'other conifer' & tree_type != 'deciduous'), #%>% filter(COMMON_NAME %in% sp.both.2002[! sp.both.2002 %in% c('curlleaf mountain-mahogany', 'California live oak')]), #, (sequence == 'Both Droughts' & drought == '1999-2002') | (sequence == '2012-2015 Only' & drought == '2012-2015')),
x = "time.period", y = "BAA.dead.sum", fill = 'tree_type.f',
color = "sequence",
position = position_dodge(), add = "mean_se" , error.plot = "errorbar", alpha = 0.8,
ylab = expression('Mortality (m'^2*' ha'^-1*')'),
xlab = "Time Period", order = c("1999-2002", "2012-2015")) +
theme_bw() + guides(color = 'none', fill = guide_legend(title = "Tree Type", ncol = 1)) +
scale_color_manual(values = c("black", "black"), aesthetics = "color") +
scale_fill_discrete(labels = c("pine" = "Pine", "fir" = "Fir", "juniper" = "Juniper", "oak" = "Oak", "cedar" = "Cedar")) +
theme(legend.background = element_rect(colour = NA, fill = NA), legend.justification = c(1, 0),
legend.position = c(0.66, 0.28), legend.text = element_text(size = 8), legend.title = element_text(size = 10),
legend.direction = "vertical", axis.text.x = element_text(size = 8), axis.title.x = element_text(size = 10),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10), strip.background = element_blank(),
strip.text.x = element_blank(), plot.margin = unit(c(0.5,0.5,0.5,0), "pt")) +
scale_x_discrete(labels = c("1st Exposure", "2nd Exposure")) +
geom_text(data = p2_texta, mapping = aes(x = x, y = y, label = label), size = 5) +
# geom_text(data = p1_textb, mapping = aes(x = x, y = y, label = label), size = 3) +
# geom_text(data = data.frame(label = "Mean \n+/- SE", y = 1.7, x = 1.5, sequence = 'Both Droughts'), mapping = aes(x=x, y=y, label = label), size = 2) +
facet_grid(~ factor(sequence, levels = c('Both Droughts', '2nd Drought Only')))
p2
# ggbarplot(order)
#Combine the two figure panels into one
f1 <- ggarrange(p1, p2, ncol = 1, labels = "auto", align = "v", nrow = 2, heights = c(1, 0.95), common.legend = FALSE)
f1
ggsave(filename = 'Fig4_FIA_mortality_by_tree_type.png', height=14, width=16, units = 'cm', dpi=900)
p1 <- ggbarplot(all.forest %>% filter(pltID %in% plots) %>% group_by(time.period, sequence, pltID) %>% summarize(BAA.all = sum(BAA.all), BAA.live = sum(BAA), BAA.dead.sum = sum(BAA.dead), BAA.mort = sum(BAA.dead) / sum(BAA.all) * 100), #%>% filter(COMMON_NAME %in% sp.both.2002[! sp.both.2002 %in% c('curlleaf mountain-mahogany', 'California live oak')]), #, (sequence == 'Both Droughts' & drought == '1999-2002') | (sequence == '2012-2015 Only' & drought == '2012-2015')),
x = "time.period", y = "BAA.dead.sum", position = position_dodge(), color = "sequence", fill = 'gray',
add = "mean_se" , error.plot = "errorbar", alpha = 0.8,
ylab = expression('Mortality (m'^2*' ha'^-1*')'),
xlab = "Time Period", order = c("1999-2002", "2012-2015")) +
theme_bw() + guides(color = 'none') +
scale_color_manual(values = c("black", "black"),
aesthetics = "color") +
theme(legend.background = element_rect(colour = NA, fill = NA), legend.justification = c(1, 0),
legend.position = c(0.76, 0.1), legend.text = element_text(size = 6), legend.title = element_text(size = 8),
legend.direction = "vertical", axis.text.x = element_blank(), axis.title.x = element_blank(),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10), plot.margin = unit(c(0,0,3,0), "pt")) +
scale_x_discrete(labels = c("1st Exposure", "2nd Exposure")) +
geom_text(data = p1_texta, mapping = aes(x = x, y = y, label = label), size = 5) +
geom_text(data = p1_textb, mapping = aes(x = x, y = y, label = label), size = 3) +
geom_text(data = data.frame(label = "Mean \n+/- SE", y = 2.88, x = 1.2, sequence = 'Both Droughts'), mapping = aes(x=x, y=y, label = label), size = 2) +
facet_grid(~ factor(sequence, levels = c('Both Droughts', '2nd Drought Only')))
p1
#Create a tree_type factor variable and sort it to make the plots
all.forest.type$tree_type.f <- all.forest.type$tree_type
all.forest.type$tree_type.f <- factor(all.forest.type$tree_type.f, levels= c('pine', 'fir', 'oak', 'juniper', 'cedar'))
# all.forest.type <- all.forest.type %>% mutate(tree_type.f = as.factor(tree.type.f(levels = c('pine', 'fir', 'oak', 'juniper', 'cedar'))))
#Add text to the plot
p2_texta <- data.frame(label = c("a", "ab", "bc", "c", "c", "bc", "bc", "bc", "c", "c",
"bc", "c", "c", "c", "c","a", "a", "bc", "c", "bc"),
sequence   = c('Both Droughts', 'Both Droughts', 'Both Droughts', 'Both Droughts', 'Both Droughts', 'Both Droughts',
'Both Droughts', 'Both Droughts', 'Both Droughts', 'Both Droughts', '2nd Drought Only', '2nd Drought Only',
'2nd Drought Only', '2nd Drought Only', '2nd Drought Only', '2nd Drought Only', '2nd Drought Only', '2nd Drought Only',
'2nd Drought Only', '2nd Drought Only'),
# tree_type = c('pine/fir', 'other tree', 'pine/fir', 'other tree',
#               'pine/fir', 'other tree', 'pine/fir', 'other tree'),
y     = c(2, 1.05, 0.55, 0.3, 0.18, 0.4, 0.26, 0.24, 0.3, 0.12,
0.24, 0.2, 0.12, 0.12, 0.12, 1.3, 1.33, 0.25, 0.12, 0.35),
x     = c(0.615, 0.81, 1.01, 1.2, 1.38, 1.615, 1.81, 2.01, 2.2, 2.38,
0.615, 0.81, 1.01, 1.2, 1.38, 1.615, 1.81, 2.01, 2.2, 2.38)
)
#Die-off Mortality as a % of basal area
p2 <- ggbarplot(all.forest.type %>% filter(pltID %in% plots & tree_type != 'other conifer' & tree_type != 'deciduous'), #%>% filter(COMMON_NAME %in% sp.both.2002[! sp.both.2002 %in% c('curlleaf mountain-mahogany', 'California live oak')]), #, (sequence == 'Both Droughts' & drought == '1999-2002') | (sequence == '2012-2015 Only' & drought == '2012-2015')),
x = "time.period", y = "BAA.dead.sum", fill = 'tree_type.f',
color = "sequence",
position = position_dodge(), add = "mean_se" , error.plot = "errorbar", alpha = 0.8,
ylab = expression('Mortality (m'^2*' ha'^-1*')'),
xlab = "Time Period", order = c("1999-2002", "2012-2015")) +
theme_bw() + guides(color = 'none', fill = guide_legend(title = "Tree Type", ncol = 1)) +
scale_color_manual(values = c("black", "black"), aesthetics = "color") +
scale_fill_discrete(labels = c("pine" = "Pine", "fir" = "Fir", "juniper" = "Juniper", "oak" = "Oak", "cedar" = "Cedar")) +
theme(legend.background = element_rect(colour = NA, fill = NA), legend.justification = c(1, 0),
legend.position = c(0.66, 0.28), legend.text = element_text(size = 8), legend.title = element_text(size = 10),
legend.direction = "vertical", axis.text.x = element_text(size = 8), axis.title.x = element_text(size = 10),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10), strip.background = element_blank(),
strip.text.x = element_blank(), plot.margin = unit(c(3,0,0,0), "pt")) +
scale_x_discrete(labels = c("1st Exposure", "2nd Exposure")) +
geom_text(data = p2_texta, mapping = aes(x = x, y = y, label = label), size = 5) +
# geom_text(data = p1_textb, mapping = aes(x = x, y = y, label = label), size = 3) +
# geom_text(data = data.frame(label = "Mean \n+/- SE", y = 1.7, x = 1.5, sequence = 'Both Droughts'), mapping = aes(x=x, y=y, label = label), size = 2) +
facet_grid(~ factor(sequence, levels = c('Both Droughts', '2nd Drought Only')))
p2
# ggbarplot(order)
#Combine the two figure panels into one
f1 <- ggarrange(p1, p2, ncol = 1, labels = c("a)", "c)"), align = "v", nrow = 2, heights = c(1, 0.95), common.legend = FALSE)
f1
ggsave(filename = 'Fig4_FIA_mortality_by_tree_type.png', height=14, width=16, units = 'cm', dpi=900)
p1 <- ggbarplot(all.forest %>% filter(pltID %in% plots) %>% group_by(time.period, sequence, pltID) %>% summarize(BAA.all = sum(BAA.all), BAA.live = sum(BAA), BAA.dead.sum = sum(BAA.dead), BAA.mort = sum(BAA.dead) / sum(BAA.all) * 100), #%>% filter(COMMON_NAME %in% sp.both.2002[! sp.both.2002 %in% c('curlleaf mountain-mahogany', 'California live oak')]), #, (sequence == 'Both Droughts' & drought == '1999-2002') | (sequence == '2012-2015 Only' & drought == '2012-2015')),
x = "time.period", y = "BAA.dead.sum", position = position_dodge(), color = "sequence", fill = 'gray',
add = "mean_se" , error.plot = "errorbar", alpha = 0.8,
ylab = expression('Mortality (m'^2*' ha'^-1*')'),
xlab = "Time Period", order = c("1999-2002", "2012-2015")) +
theme_bw() + guides(color = 'none') +
scale_color_manual(values = c("black", "black"),
aesthetics = "color") +
theme(legend.background = element_rect(colour = NA, fill = NA), legend.justification = c(1, 0),
legend.position = c(0.76, 0.1), legend.text = element_text(size = 6), legend.title = element_text(size = 8),
legend.direction = "vertical", axis.text.x = element_blank(), axis.title.x = element_blank(),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10), plot.margin = unit(c(0,0,2.5,0), "pt"),
panel.spacing = unit(5, "pt")) +
scale_x_discrete(labels = c("1st Exposure", "2nd Exposure")) +
geom_text(data = p1_texta, mapping = aes(x = x, y = y, label = label), size = 5) +
geom_text(data = p1_textb, mapping = aes(x = x, y = y, label = label), size = 3) +
geom_text(data = data.frame(label = "Mean \n+/- SE", y = 2.88, x = 1.2, sequence = 'Both Droughts'), mapping = aes(x=x, y=y, label = label), size = 2) +
facet_grid(~ factor(sequence, levels = c('Both Droughts', '2nd Drought Only')))
p1
#Create a tree_type factor variable and sort it to make the plots
all.forest.type$tree_type.f <- all.forest.type$tree_type
all.forest.type$tree_type.f <- factor(all.forest.type$tree_type.f, levels= c('pine', 'fir', 'oak', 'juniper', 'cedar'))
# all.forest.type <- all.forest.type %>% mutate(tree_type.f = as.factor(tree.type.f(levels = c('pine', 'fir', 'oak', 'juniper', 'cedar'))))
#Add text to the plot
p2_texta <- data.frame(label = c("a", "ab", "bc", "c", "c", "bc", "bc", "bc", "c", "c",
"bc", "c", "c", "c", "c","a", "a", "bc", "c", "bc"),
sequence   = c('Both Droughts', 'Both Droughts', 'Both Droughts', 'Both Droughts', 'Both Droughts', 'Both Droughts',
'Both Droughts', 'Both Droughts', 'Both Droughts', 'Both Droughts', '2nd Drought Only', '2nd Drought Only',
'2nd Drought Only', '2nd Drought Only', '2nd Drought Only', '2nd Drought Only', '2nd Drought Only', '2nd Drought Only',
'2nd Drought Only', '2nd Drought Only'),
# tree_type = c('pine/fir', 'other tree', 'pine/fir', 'other tree',
#               'pine/fir', 'other tree', 'pine/fir', 'other tree'),
y     = c(2, 1.05, 0.55, 0.3, 0.18, 0.4, 0.26, 0.24, 0.3, 0.12,
0.24, 0.2, 0.12, 0.12, 0.12, 1.3, 1.33, 0.25, 0.12, 0.35),
x     = c(0.615, 0.81, 1.01, 1.2, 1.38, 1.615, 1.81, 2.01, 2.2, 2.38,
0.615, 0.81, 1.01, 1.2, 1.38, 1.615, 1.81, 2.01, 2.2, 2.38)
)
#Die-off Mortality as a % of basal area
p2 <- ggbarplot(all.forest.type %>% filter(pltID %in% plots & tree_type != 'other conifer' & tree_type != 'deciduous'), #%>% filter(COMMON_NAME %in% sp.both.2002[! sp.both.2002 %in% c('curlleaf mountain-mahogany', 'California live oak')]), #, (sequence == 'Both Droughts' & drought == '1999-2002') | (sequence == '2012-2015 Only' & drought == '2012-2015')),
x = "time.period", y = "BAA.dead.sum", fill = 'tree_type.f',
color = "sequence",
position = position_dodge(), add = "mean_se" , error.plot = "errorbar", alpha = 0.8,
ylab = expression('Mortality (m'^2*' ha'^-1*')'),
xlab = "Time Period", order = c("1999-2002", "2012-2015")) +
theme_bw() + guides(color = 'none', fill = guide_legend(title = "Tree Type", ncol = 1)) +
scale_color_manual(values = c("black", "black"), aesthetics = "color") +
scale_fill_discrete(labels = c("pine" = "Pine", "fir" = "Fir", "juniper" = "Juniper", "oak" = "Oak", "cedar" = "Cedar")) +
theme(legend.background = element_rect(colour = NA, fill = NA), legend.justification = c(1, 0),
legend.position = c(0.66, 0.28), legend.text = element_text(size = 8), legend.title = element_text(size = 10),
legend.direction = "vertical", axis.text.x = element_text(size = 8), axis.title.x = element_text(size = 10),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10), strip.background = element_blank(),
strip.text.x = element_blank(), plot.margin = unit(c(2.5,0,0,0), "pt"), panel.spacing = unit(15, "pt")) +
scale_x_discrete(labels = c("1st Exposure", "2nd Exposure")) +
geom_text(data = p2_texta, mapping = aes(x = x, y = y, label = label), size = 5) +
# geom_text(data = p1_textb, mapping = aes(x = x, y = y, label = label), size = 3) +
# geom_text(data = data.frame(label = "Mean \n+/- SE", y = 1.7, x = 1.5, sequence = 'Both Droughts'), mapping = aes(x=x, y=y, label = label), size = 2) +
facet_grid(~ factor(sequence, levels = c('Both Droughts', '2nd Drought Only')))
p2
# ggbarplot(order)
#Combine the two figure panels into one
f1 <- ggarrange(p1, p2, ncol = 1, labels = c("a)", "c)"), align = "v", nrow = 2, heights = c(1, 0.95), common.legend = FALSE)
f1
ggsave(filename = 'Fig4_FIA_mortality_by_tree_type.png', height=14, width=16, units = 'cm', dpi=900)
p1 <- ggbarplot(all.forest %>% filter(pltID %in% plots) %>% group_by(time.period, sequence, pltID) %>% summarize(BAA.all = sum(BAA.all), BAA.live = sum(BAA), BAA.dead.sum = sum(BAA.dead), BAA.mort = sum(BAA.dead) / sum(BAA.all) * 100), #%>% filter(COMMON_NAME %in% sp.both.2002[! sp.both.2002 %in% c('curlleaf mountain-mahogany', 'California live oak')]), #, (sequence == 'Both Droughts' & drought == '1999-2002') | (sequence == '2012-2015 Only' & drought == '2012-2015')),
x = "time.period", y = "BAA.dead.sum", position = position_dodge(), color = "sequence", fill = 'gray',
add = "mean_se" , error.plot = "errorbar", alpha = 0.8,
ylab = expression('Mortality (m'^2*' ha'^-1*')'),
xlab = "Time Period", order = c("1999-2002", "2012-2015")) +
theme_bw() + guides(color = 'none') +
scale_color_manual(values = c("black", "black"),
aesthetics = "color") +
theme(legend.background = element_rect(colour = NA, fill = NA), legend.justification = c(1, 0),
legend.position = c(0.76, 0.1), legend.text = element_text(size = 6), legend.title = element_text(size = 8),
legend.direction = "vertical", axis.text.x = element_blank(), axis.title.x = element_blank(),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10), plot.margin = unit(c(0,0,2.5,0), "pt"),
panel.spacing = unit(20, "pt")) +
scale_x_discrete(labels = c("1st Exposure", "2nd Exposure")) +
geom_text(data = p1_texta, mapping = aes(x = x, y = y, label = label), size = 5) +
geom_text(data = p1_textb, mapping = aes(x = x, y = y, label = label), size = 3) +
geom_text(data = data.frame(label = "Mean \n+/- SE", y = 2.88, x = 1.2, sequence = 'Both Droughts'), mapping = aes(x=x, y=y, label = label), size = 2) +
facet_grid(~ factor(sequence, levels = c('Both Droughts', '2nd Drought Only')))
p1
#Create a tree_type factor variable and sort it to make the plots
all.forest.type$tree_type.f <- all.forest.type$tree_type
all.forest.type$tree_type.f <- factor(all.forest.type$tree_type.f, levels= c('pine', 'fir', 'oak', 'juniper', 'cedar'))
# all.forest.type <- all.forest.type %>% mutate(tree_type.f = as.factor(tree.type.f(levels = c('pine', 'fir', 'oak', 'juniper', 'cedar'))))
#Add text to the plot
p2_texta <- data.frame(label = c("a", "ab", "bc", "c", "c", "bc", "bc", "bc", "c", "c",
"bc", "c", "c", "c", "c","a", "a", "bc", "c", "bc"),
sequence   = c('Both Droughts', 'Both Droughts', 'Both Droughts', 'Both Droughts', 'Both Droughts', 'Both Droughts',
'Both Droughts', 'Both Droughts', 'Both Droughts', 'Both Droughts', '2nd Drought Only', '2nd Drought Only',
'2nd Drought Only', '2nd Drought Only', '2nd Drought Only', '2nd Drought Only', '2nd Drought Only', '2nd Drought Only',
'2nd Drought Only', '2nd Drought Only'),
# tree_type = c('pine/fir', 'other tree', 'pine/fir', 'other tree',
#               'pine/fir', 'other tree', 'pine/fir', 'other tree'),
y     = c(2, 1.05, 0.55, 0.3, 0.18, 0.4, 0.26, 0.24, 0.3, 0.12,
0.24, 0.2, 0.12, 0.12, 0.12, 1.3, 1.33, 0.25, 0.12, 0.35),
x     = c(0.615, 0.81, 1.01, 1.2, 1.38, 1.615, 1.81, 2.01, 2.2, 2.38,
0.615, 0.81, 1.01, 1.2, 1.38, 1.615, 1.81, 2.01, 2.2, 2.38)
)
#Die-off Mortality as a % of basal area
p2 <- ggbarplot(all.forest.type %>% filter(pltID %in% plots & tree_type != 'other conifer' & tree_type != 'deciduous'), #%>% filter(COMMON_NAME %in% sp.both.2002[! sp.both.2002 %in% c('curlleaf mountain-mahogany', 'California live oak')]), #, (sequence == 'Both Droughts' & drought == '1999-2002') | (sequence == '2012-2015 Only' & drought == '2012-2015')),
x = "time.period", y = "BAA.dead.sum", fill = 'tree_type.f',
color = "sequence",
position = position_dodge(), add = "mean_se" , error.plot = "errorbar", alpha = 0.8,
ylab = expression('Mortality (m'^2*' ha'^-1*')'),
xlab = "Time Period", order = c("1999-2002", "2012-2015")) +
theme_bw() + guides(color = 'none', fill = guide_legend(title = "Tree Type", ncol = 1)) +
scale_color_manual(values = c("black", "black"), aesthetics = "color") +
scale_fill_discrete(labels = c("pine" = "Pine", "fir" = "Fir", "juniper" = "Juniper", "oak" = "Oak", "cedar" = "Cedar")) +
theme(legend.background = element_rect(colour = NA, fill = NA), legend.justification = c(1, 0),
legend.position = c(0.66, 0.28), legend.text = element_text(size = 8), legend.title = element_text(size = 10),
legend.direction = "vertical", axis.text.x = element_text(size = 8), axis.title.x = element_text(size = 10),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10), strip.background = element_blank(),
strip.text.x = element_blank(), plot.margin = unit(c(2.5,0,0,0), "pt"), panel.spacing = unit(20, "pt")) +
scale_x_discrete(labels = c("1st Exposure", "2nd Exposure")) +
geom_text(data = p2_texta, mapping = aes(x = x, y = y, label = label), size = 5) +
# geom_text(data = p1_textb, mapping = aes(x = x, y = y, label = label), size = 3) +
# geom_text(data = data.frame(label = "Mean \n+/- SE", y = 1.7, x = 1.5, sequence = 'Both Droughts'), mapping = aes(x=x, y=y, label = label), size = 2) +
facet_grid(~ factor(sequence, levels = c('Both Droughts', '2nd Drought Only')))
p2
# ggbarplot(order)
#Combine the two figure panels into one
f1 <- ggarrange(p1, p2, ncol = 1, labels = c("a)", "c)"), align = "v", nrow = 2, heights = c(1, 0.95), common.legend = FALSE)
f1
ggsave(filename = 'Fig4_FIA_mortality_by_tree_type.png', height=14, width=16, units = 'cm', dpi=900)
p1 <- ggbarplot(all.forest %>% filter(pltID %in% plots) %>% group_by(time.period, sequence, pltID) %>% summarize(BAA.all = sum(BAA.all), BAA.live = sum(BAA), BAA.dead.sum = sum(BAA.dead), BAA.mort = sum(BAA.dead) / sum(BAA.all) * 100), #%>% filter(COMMON_NAME %in% sp.both.2002[! sp.both.2002 %in% c('curlleaf mountain-mahogany', 'California live oak')]), #, (sequence == 'Both Droughts' & drought == '1999-2002') | (sequence == '2012-2015 Only' & drought == '2012-2015')),
x = "time.period", y = "BAA.dead.sum", position = position_dodge(), color = "sequence", fill = 'gray',
add = "mean_se" , error.plot = "errorbar", alpha = 0.8,
ylab = expression('Mortality (m'^2*' ha'^-1*')'),
xlab = "Time Period", order = c("1999-2002", "2012-2015")) +
theme_bw() + guides(color = 'none') +
scale_color_manual(values = c("black", "black"),
aesthetics = "color") +
theme(legend.background = element_rect(colour = NA, fill = NA), legend.justification = c(1, 0),
legend.position = c(0.76, 0.1), legend.text = element_text(size = 6), legend.title = element_text(size = 8),
legend.direction = "vertical", axis.text.x = element_blank(), axis.title.x = element_blank(),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10), plot.margin = unit(c(0,0,2.5,0), "pt"),
panel.spacing = unit(20, "pt")) +
scale_x_discrete(labels = c("1st Exposure", "2nd Exposure")) +
geom_text(data = p1_texta, mapping = aes(x = x, y = y, label = label), size = 5) +
geom_text(data = p1_textb, mapping = aes(x = x, y = y, label = label), size = 3) +
geom_text(data = data.frame(label = "Mean \n+/- SE", y = 2.88, x = 1.2, sequence = 'Both Droughts'), mapping = aes(x=x, y=y, label = label), size = 2) +
facet_grid(~ factor(sequence, levels = c('Both Droughts', '2nd Drought Only')), facets = c('a)', 'b)'))
p1
#Create a tree_type factor variable and sort it to make the plots
all.forest.type$tree_type.f <- all.forest.type$tree_type
all.forest.type$tree_type.f <- factor(all.forest.type$tree_type.f, levels= c('pine', 'fir', 'oak', 'juniper', 'cedar'))
# all.forest.type <- all.forest.type %>% mutate(tree_type.f = as.factor(tree.type.f(levels = c('pine', 'fir', 'oak', 'juniper', 'cedar'))))
#Add text to the plot
p2_texta <- data.frame(label = c("a", "ab", "bc", "c", "c", "bc", "bc", "bc", "c", "c",
"bc", "c", "c", "c", "c","a", "a", "bc", "c", "bc"),
sequence   = c('Both Droughts', 'Both Droughts', 'Both Droughts', 'Both Droughts', 'Both Droughts', 'Both Droughts',
'Both Droughts', 'Both Droughts', 'Both Droughts', 'Both Droughts', '2nd Drought Only', '2nd Drought Only',
'2nd Drought Only', '2nd Drought Only', '2nd Drought Only', '2nd Drought Only', '2nd Drought Only', '2nd Drought Only',
'2nd Drought Only', '2nd Drought Only'),
# tree_type = c('pine/fir', 'other tree', 'pine/fir', 'other tree',
#               'pine/fir', 'other tree', 'pine/fir', 'other tree'),
y     = c(2, 1.05, 0.55, 0.3, 0.18, 0.4, 0.26, 0.24, 0.3, 0.12,
0.24, 0.2, 0.12, 0.12, 0.12, 1.3, 1.33, 0.25, 0.12, 0.35),
x     = c(0.615, 0.81, 1.01, 1.2, 1.38, 1.615, 1.81, 2.01, 2.2, 2.38,
0.615, 0.81, 1.01, 1.2, 1.38, 1.615, 1.81, 2.01, 2.2, 2.38)
)
#Die-off Mortality as a % of basal area
p2 <- ggbarplot(all.forest.type %>% filter(pltID %in% plots & tree_type != 'other conifer' & tree_type != 'deciduous'), #%>% filter(COMMON_NAME %in% sp.both.2002[! sp.both.2002 %in% c('curlleaf mountain-mahogany', 'California live oak')]), #, (sequence == 'Both Droughts' & drought == '1999-2002') | (sequence == '2012-2015 Only' & drought == '2012-2015')),
x = "time.period", y = "BAA.dead.sum", fill = 'tree_type.f',
color = "sequence",
position = position_dodge(), add = "mean_se" , error.plot = "errorbar", alpha = 0.8,
ylab = expression('Mortality (m'^2*' ha'^-1*')'),
xlab = "Time Period", order = c("1999-2002", "2012-2015")) +
theme_bw() + guides(color = 'none', fill = guide_legend(title = "Tree Type", ncol = 1)) +
scale_color_manual(values = c("black", "black"), aesthetics = "color") +
scale_fill_discrete(labels = c("pine" = "Pine", "fir" = "Fir", "juniper" = "Juniper", "oak" = "Oak", "cedar" = "Cedar")) +
theme(legend.background = element_rect(colour = NA, fill = NA), legend.justification = c(1, 0),
legend.position = c(0.66, 0.28), legend.text = element_text(size = 8), legend.title = element_text(size = 10),
legend.direction = "vertical", axis.text.x = element_text(size = 8), axis.title.x = element_text(size = 10),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10), strip.background = element_blank(),
strip.text.x = element_blank(), plot.margin = unit(c(2.5,0,0,0), "pt"), panel.spacing = unit(20, "pt")) +
scale_x_discrete(labels = c("1st Exposure", "2nd Exposure")) +
geom_text(data = p2_texta, mapping = aes(x = x, y = y, label = label), size = 5) +
# geom_text(data = p1_textb, mapping = aes(x = x, y = y, label = label), size = 3) +
# geom_text(data = data.frame(label = "Mean \n+/- SE", y = 1.7, x = 1.5, sequence = 'Both Droughts'), mapping = aes(x=x, y=y, label = label), size = 2) +
facet_grid(~ factor(sequence, levels = c('Both Droughts', '2nd Drought Only')), facets = c('a)', 'b)'))
p2
# ggbarplot(order)
#Combine the two figure panels into one
f1 <- ggarrange(p1, p2, ncol = 1, align = "v", nrow = 2, heights = c(1, 0.95), common.legend = FALSE)
f1
ggsave(filename = 'Fig4_FIA_mortality_by_tree_type.png', height=14, width=16, units = 'cm', dpi=900)
p1 <- ggbarplot(all.forest %>% filter(pltID %in% plots) %>% group_by(time.period, sequence, pltID) %>% summarize(BAA.all = sum(BAA.all), BAA.live = sum(BAA), BAA.dead.sum = sum(BAA.dead), BAA.mort = sum(BAA.dead) / sum(BAA.all) * 100), #%>% filter(COMMON_NAME %in% sp.both.2002[! sp.both.2002 %in% c('curlleaf mountain-mahogany', 'California live oak')]), #, (sequence == 'Both Droughts' & drought == '1999-2002') | (sequence == '2012-2015 Only' & drought == '2012-2015')),
x = "time.period", y = "BAA.dead.sum", position = position_dodge(), color = "sequence", fill = 'gray',
add = "mean_se" , error.plot = "errorbar", alpha = 0.8,
ylab = expression('Mortality (m'^2*' ha'^-1*')'),
xlab = "Time Period", order = c("1999-2002", "2012-2015")) +
theme_bw() + guides(color = 'none') +
scale_color_manual(values = c("black", "black"),
aesthetics = "color") +
theme(legend.background = element_rect(colour = NA, fill = NA), legend.justification = c(1, 0),
legend.position = c(0.76, 0.1), legend.text = element_text(size = 6), legend.title = element_text(size = 8),
legend.direction = "vertical", axis.text.x = element_blank(), axis.title.x = element_blank(),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10), plot.margin = unit(c(0,0,2.5,0), "pt"),
panel.spacing = unit(20, "pt")) +
scale_x_discrete(labels = c("1st Exposure", "2nd Exposure")) +
geom_text(data = p1_texta, mapping = aes(x = x, y = y, label = label), size = 5) +
geom_text(data = p1_textb, mapping = aes(x = x, y = y, label = label), size = 3) +
geom_text(data = data.frame(label = "Mean \n+/- SE", y = 2.88, x = 1.2, sequence = 'Both Droughts'), mapping = aes(x=x, y=y, label = label), size = 2) +
facet_grid(~ factor(sequence, levels = c('Both Droughts', '2nd Drought Only'))) +
annotate(geom = "text", x = 0.7, y = 0.05, label = "b)", size = 3)
p1
#Create a tree_type factor variable and sort it to make the plots
all.forest.type$tree_type.f <- all.forest.type$tree_type
all.forest.type$tree_type.f <- factor(all.forest.type$tree_type.f, levels= c('pine', 'fir', 'oak', 'juniper', 'cedar'))
# all.forest.type <- all.forest.type %>% mutate(tree_type.f = as.factor(tree.type.f(levels = c('pine', 'fir', 'oak', 'juniper', 'cedar'))))
#Add text to the plot
p2_texta <- data.frame(label = c("a", "ab", "bc", "c", "c", "bc", "bc", "bc", "c", "c",
"bc", "c", "c", "c", "c","a", "a", "bc", "c", "bc"),
sequence   = c('Both Droughts', 'Both Droughts', 'Both Droughts', 'Both Droughts', 'Both Droughts', 'Both Droughts',
'Both Droughts', 'Both Droughts', 'Both Droughts', 'Both Droughts', '2nd Drought Only', '2nd Drought Only',
'2nd Drought Only', '2nd Drought Only', '2nd Drought Only', '2nd Drought Only', '2nd Drought Only', '2nd Drought Only',
'2nd Drought Only', '2nd Drought Only'),
# tree_type = c('pine/fir', 'other tree', 'pine/fir', 'other tree',
#               'pine/fir', 'other tree', 'pine/fir', 'other tree'),
y     = c(2, 1.05, 0.55, 0.3, 0.18, 0.4, 0.26, 0.24, 0.3, 0.12,
0.24, 0.2, 0.12, 0.12, 0.12, 1.3, 1.33, 0.25, 0.12, 0.35),
x     = c(0.615, 0.81, 1.01, 1.2, 1.38, 1.615, 1.81, 2.01, 2.2, 2.38,
0.615, 0.81, 1.01, 1.2, 1.38, 1.615, 1.81, 2.01, 2.2, 2.38)
)
#Die-off Mortality as a % of basal area
p2 <- ggbarplot(all.forest.type %>% filter(pltID %in% plots & tree_type != 'other conifer' & tree_type != 'deciduous'), #%>% filter(COMMON_NAME %in% sp.both.2002[! sp.both.2002 %in% c('curlleaf mountain-mahogany', 'California live oak')]), #, (sequence == 'Both Droughts' & drought == '1999-2002') | (sequence == '2012-2015 Only' & drought == '2012-2015')),
x = "time.period", y = "BAA.dead.sum", fill = 'tree_type.f',
color = "sequence",
position = position_dodge(), add = "mean_se" , error.plot = "errorbar", alpha = 0.8,
ylab = expression('Mortality (m'^2*' ha'^-1*')'),
xlab = "Time Period", order = c("1999-2002", "2012-2015")) +
theme_bw() + guides(color = 'none', fill = guide_legend(title = "Tree Type", ncol = 1)) +
scale_color_manual(values = c("black", "black"), aesthetics = "color") +
scale_fill_discrete(labels = c("pine" = "Pine", "fir" = "Fir", "juniper" = "Juniper", "oak" = "Oak", "cedar" = "Cedar")) +
theme(legend.background = element_rect(colour = NA, fill = NA), legend.justification = c(1, 0),
legend.position = c(0.66, 0.28), legend.text = element_text(size = 8), legend.title = element_text(size = 10),
legend.direction = "vertical", axis.text.x = element_text(size = 8), axis.title.x = element_text(size = 10),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10), strip.background = element_blank(),
strip.text.x = element_blank(), plot.margin = unit(c(2.5,0,0,0), "pt"), panel.spacing = unit(20, "pt")) +
scale_x_discrete(labels = c("1st Exposure", "2nd Exposure")) +
geom_text(data = p2_texta, mapping = aes(x = x, y = y, label = label), size = 5) +
# geom_text(data = p1_textb, mapping = aes(x = x, y = y, label = label), size = 3) +
# geom_text(data = data.frame(label = "Mean \n+/- SE", y = 1.7, x = 1.5, sequence = 'Both Droughts'), mapping = aes(x=x, y=y, label = label), size = 2) +
facet_grid(~ factor(sequence, levels = c('Both Droughts', '2nd Drought Only')))
p2
# ggbarplot(order)
#Combine the two figure panels into one
f1 <- ggarrange(p1, p2, ncol = 1, align = "v", labels = c("a)", "c)"), nrow = 2, heights = c(1, 0.95), common.legend = FALSE)
f1
ggsave(filename = 'Fig4_FIA_mortality_by_tree_type.png', height=14, width=16, units = 'cm', dpi=900)
p1 <- ggbarplot(all.forest %>% filter(pltID %in% plots) %>% group_by(time.period, sequence, pltID) %>% summarize(BAA.all = sum(BAA.all), BAA.live = sum(BAA), BAA.dead.sum = sum(BAA.dead), BAA.mort = sum(BAA.dead) / sum(BAA.all) * 100), #%>% filter(COMMON_NAME %in% sp.both.2002[! sp.both.2002 %in% c('curlleaf mountain-mahogany', 'California live oak')]), #, (sequence == 'Both Droughts' & drought == '1999-2002') | (sequence == '2012-2015 Only' & drought == '2012-2015')),
x = "time.period", y = "BAA.dead.sum", position = position_dodge(), color = "sequence", fill = 'gray',
add = "mean_se" , error.plot = "errorbar", alpha = 0.8,
ylab = expression('Mortality (m'^2*' ha'^-1*')'),
xlab = "Time Period", order = c("1999-2002", "2012-2015")) +
theme_bw() + guides(color = 'none') +
scale_color_manual(values = c("black", "black"),
aesthetics = "color") +
theme(legend.background = element_rect(colour = NA, fill = NA), legend.justification = c(1, 0),
legend.position = c(0.76, 0.1), legend.text = element_text(size = 6), legend.title = element_text(size = 8),
legend.direction = "vertical", axis.text.x = element_blank(), axis.title.x = element_blank(),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10), plot.margin = unit(c(0,0,2.5,0), "pt"),
panel.spacing = unit(20, "pt")) +
scale_x_discrete(labels = c("1st Exposure", "2nd Exposure")) +
geom_text(data = p1_texta, mapping = aes(x = x, y = y, label = label), size = 5) +
geom_text(data = p1_textb, mapping = aes(x = x, y = y, label = label), size = 3) +
geom_text(data = data.frame(label = "Mean \n+/- SE", y = 2.88, x = 1.2, sequence = 'Both Droughts'), mapping = aes(x=x, y=y, label = label), size = 2) +
facet_grid(~ factor(sequence, levels = c('Both Droughts', '2nd Drought Only'))) +
annotate(geom = "text", x = 1.5, y = 4.2, label = "b)", size = 3)
p1
p1 <- ggbarplot(all.forest %>% filter(pltID %in% plots) %>% group_by(time.period, sequence, pltID) %>% summarize(BAA.all = sum(BAA.all), BAA.live = sum(BAA), BAA.dead.sum = sum(BAA.dead), BAA.mort = sum(BAA.dead) / sum(BAA.all) * 100), #%>% filter(COMMON_NAME %in% sp.both.2002[! sp.both.2002 %in% c('curlleaf mountain-mahogany', 'California live oak')]), #, (sequence == 'Both Droughts' & drought == '1999-2002') | (sequence == '2012-2015 Only' & drought == '2012-2015')),
x = "time.period", y = "BAA.dead.sum", position = position_dodge(), color = "sequence", fill = 'gray',
add = "mean_se" , error.plot = "errorbar", alpha = 0.8,
ylab = expression('Mortality (m'^2*' ha'^-1*')'),
xlab = "Time Period", order = c("1999-2002", "2012-2015")) +
theme_bw() + guides(color = 'none') +
scale_color_manual(values = c("black", "black"),
aesthetics = "color") +
theme(legend.background = element_rect(colour = NA, fill = NA), legend.justification = c(1, 0),
legend.position = c(0.76, 0.1), legend.text = element_text(size = 6), legend.title = element_text(size = 8),
legend.direction = "vertical", axis.text.x = element_blank(), axis.title.x = element_blank(),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10), plot.margin = unit(c(0,0,2.5,0), "pt"),
panel.spacing = unit(20, "pt")) +
scale_x_discrete(labels = c("1st Exposure", "2nd Exposure")) +
geom_text(data = p1_texta, mapping = aes(x = x, y = y, label = label), size = 5) +
geom_text(data = p1_textb, mapping = aes(x = x, y = y, label = label), size = 3) +
geom_text(data = data.frame(label = "Mean \n+/- SE", y = 2.88, x = 1.2, sequence = 'Both Droughts'), mapping = aes(x=x, y=y, label = label), size = 2) +
facet_grid(~ factor(sequence, levels = c('Both Droughts', '2nd Drought Only'))) +
annotate(geom = "text", x = -0.3, y = 4.4, label = "b)", size = 6)
p1
p1 <- ggbarplot(all.forest %>% filter(pltID %in% plots) %>% group_by(time.period, sequence, pltID) %>% summarize(BAA.all = sum(BAA.all), BAA.live = sum(BAA), BAA.dead.sum = sum(BAA.dead), BAA.mort = sum(BAA.dead) / sum(BAA.all) * 100), #%>% filter(COMMON_NAME %in% sp.both.2002[! sp.both.2002 %in% c('curlleaf mountain-mahogany', 'California live oak')]), #, (sequence == 'Both Droughts' & drought == '1999-2002') | (sequence == '2012-2015 Only' & drought == '2012-2015')),
x = "time.period", y = "BAA.dead.sum", position = position_dodge(), color = "sequence", fill = 'gray',
add = "mean_se" , error.plot = "errorbar", alpha = 0.8,
ylab = expression('Mortality (m'^2*' ha'^-1*')'),
xlab = "Time Period", order = c("1999-2002", "2012-2015")) +
theme_bw() + guides(color = 'none') +
scale_color_manual(values = c("black", "black"),
aesthetics = "color") +
theme(legend.background = element_rect(colour = NA, fill = NA), legend.justification = c(1, 0),
legend.position = c(0.76, 0.1), legend.text = element_text(size = 6), legend.title = element_text(size = 8),
legend.direction = "vertical", axis.text.x = element_blank(), axis.title.x = element_blank(),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10), plot.margin = unit(c(0,0,2.5,0), "pt"),
panel.spacing = unit(20, "pt")) +
scale_x_discrete(labels = c("1st Exposure", "2nd Exposure")) +
geom_text(data = p1_texta, mapping = aes(x = x, y = y, label = label), size = 5) +
geom_text(data = p1_textb, mapping = aes(x = x, y = y, label = label), size = 3) +
geom_text(data = data.frame(label = "Mean \n+/- SE", y = 2.88, x = 1.2, sequence = 'Both Droughts'), mapping = aes(x=x, y=y, label = label), size = 2) +
facet_grid(~ factor(sequence, levels = c('Both Droughts', '2nd Drought Only')))
p1
