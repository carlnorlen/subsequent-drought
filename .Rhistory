aesthetics = "color") +
theme(legend.background = element_rect(colour = NA, fill = NA), legend.justification = c(1, 0),
legend.position = c(0.75, 0.45), legend.text = element_text(size = 6), legend.title = element_text(size = 8),
legend.direction = "vertical", axis.text.x = element_text(size = 8), axis.title.x = element_text(size = 10),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10)) +
# geom_text(data = p1_texta, mapping = aes(x = x, y = y, label = label), size = 5) +
# geom_text(data = p1_textb, mapping = aes(x = x, y = y, label = label), size = 3) +
geom_text(data = data.frame(label = "Mean \n+/- SE", y = 3.5, x = 1.25, sequence = 'Both Droughts'), mapping = aes(x=x, y=y, label = label), size = 2) +
facet_grid(~ factor(sequence, levels = c('Both Droughts', '2012-2015 Only')))
p1
type.aov.dead <- aov(data = filter(type.both.all), basal_area.dead ~ drought * sequence * tree_type)
summary(type.aov.dead)
#Tukey Post Hoc analysis of dead basal area by tree species type
type.dead.tHSD <- TukeyHSD(type.aov.dead)
type.dead.tHSD
type.aov.dead <- aov(data = filter(type.both.all), basal_area.mort ~ drought * sequence * tree_type)
summary(type.aov.dead)
#Tukey Post Hoc analysis of dead basal area by tree species type
type.dead.tHSD <- TukeyHSD(type.aov.dead)
type.dead.tHSD
type.aov.dead <- aov(data = filter(type.both.all), basal_area.dead ~ drought * sequence * tree_type)
summary(type.aov.dead)
#Tukey Post Hoc analysis of dead basal area by tree species type
type.dead.tHSD <- TukeyHSD(type.aov.dead)
type.dead.tHSD
p1_texta <- data.frame(label = c("a", "b", "b","b", "b", "b", "b", "a"),
sequence   = c('Both Droughts', 'Both Droughts', 'Both Droughts', 'Both Droughts',
'2012-2015 Only', '2012-2015 Only', '2012-2015 Only', '2012-2015 Only'),
y     = c(4, 1.2, 1.9, 0.9, 0.4, 0,4, 3.6,1.2),
x     = c(1, 2, 1, 2)
)
#Letters to indicate sample sizes
p1_textb <- data.frame(label = c("n = 44", "n = 26", "n = 199", "n = 192"),
sequence   = c('Both Droughts', 'Both Droughts', '2012-2015 Only', '2012-2015 Only'),
y     = c(34.5, 11, 3, 17.5),
x     = c(1, 2, 1, 2)
)
#Create the mortality (%) bar chart
p1 <- ggbarplot(filter(type.both.all), x = "drought", y = "basal_area.dead", fill = "tree_type", color = 'sequence',
ylab = 'Mortality (%)', xlab = "Time Period", order = c("1999-2002", "2012-2015"), position = position_dodge(), #stat = "density",
add = "mean_se" , error.plot = "errorbar", alpha = 0.8) +
guides(color = "none", fill = guide_legend('Tree \nType')) + theme_bw() +
scale_color_manual(values = c("black", "black"), name = 'Drought \nSequence',
# labels = c("pine/fir" = "Needleleaf \nConifer", "other tree" = 'Other \nTrees'),
labels = c("Both Droughts" =  "Both \nDroughts", "2012-2015 Only" = "2012-2015 \nOnly"),
aesthetics = "color") +
theme(legend.background = element_rect(colour = NA, fill = NA), legend.justification = c(1, 0),
legend.position = c(0.75, 0.45), legend.text = element_text(size = 6), legend.title = element_text(size = 8),
legend.direction = "vertical", axis.text.x = element_text(size = 8), axis.title.x = element_text(size = 10),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10)) +
geom_text(data = p1_texta, mapping = aes(x = x, y = y, label = label), size = 5) +
# geom_text(data = p1_textb, mapping = aes(x = x, y = y, label = label), size = 3) +
geom_text(data = data.frame(label = "Mean \n+/- SE", y = 3.5, x = 1.25, sequence = 'Both Droughts'), mapping = aes(x=x, y=y, label = label), size = 2) +
facet_grid(~ factor(sequence, levels = c('Both Droughts', '2012-2015 Only')))
p1
p1_texta <- data.frame(label = c("a", "b", "b","b", "b", "b", "b", "a"),
sequence   = c('Both Droughts', 'Both Droughts', 'Both Droughts', 'Both Droughts',
'2012-2015 Only', '2012-2015 Only', '2012-2015 Only', '2012-2015 Only'),
tree_type = c('pine/fir', 'other tree', 'pine/fir', 'other tree',
'pine/fir', 'other tree', 'pine/fir', 'other tree'),
y     = c(4, 1.2, 1.9, 0.9, 0.4, 0,4, 3.6,1.2),
x     = c(1, 2, 1, 2)
)
#Letters to indicate sample sizes
p1_textb <- data.frame(label = c("n = 44", "n = 26", "n = 199", "n = 192"),
sequence   = c('Both Droughts', 'Both Droughts', '2012-2015 Only', '2012-2015 Only'),
y     = c(34.5, 11, 3, 17.5),
x     = c(1, 2, 1, 2)
)
#Create the mortality (%) bar chart
p1 <- ggbarplot(filter(type.both.all), x = "drought", y = "basal_area.dead", fill = "tree_type", color = 'sequence',
ylab = 'Mortality (%)', xlab = "Time Period", order = c("1999-2002", "2012-2015"), position = position_dodge(), #stat = "density",
add = "mean_se" , error.plot = "errorbar", alpha = 0.8) +
guides(color = "none", fill = guide_legend('Tree \nType')) + theme_bw() +
scale_color_manual(values = c("black", "black"), name = 'Drought \nSequence',
# labels = c("pine/fir" = "Needleleaf \nConifer", "other tree" = 'Other \nTrees'),
labels = c("Both Droughts" =  "Both \nDroughts", "2012-2015 Only" = "2012-2015 \nOnly"),
aesthetics = "color") +
theme(legend.background = element_rect(colour = NA, fill = NA), legend.justification = c(1, 0),
legend.position = c(0.75, 0.45), legend.text = element_text(size = 6), legend.title = element_text(size = 8),
legend.direction = "vertical", axis.text.x = element_text(size = 8), axis.title.x = element_text(size = 10),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10)) +
geom_text(data = p1_texta, mapping = aes(x = x, y = y, label = label), size = 5) +
# geom_text(data = p1_textb, mapping = aes(x = x, y = y, label = label), size = 3) +
geom_text(data = data.frame(label = "Mean \n+/- SE", y = 3.5, x = 1.25, sequence = 'Both Droughts'), mapping = aes(x=x, y=y, label = label), size = 2) +
facet_grid(~ factor(sequence, levels = c('Both Droughts', '2012-2015 Only')))
p1
p1 <- ggbarplot(filter(type.both.all), x = "drought", y = "basal_area.dead", fill = "tree_type", color = 'sequence',
ylab = 'Mortality (%)', xlab = "Time Period", order = c("1999-2002", "2012-2015"), position = position_dodge(), #stat = "density",
add = "mean_se" , error.plot = "errorbar", alpha = 0.8) +
guides(color = "none", fill = guide_legend('Tree \nType')) + theme_bw() +
scale_color_manual(values = c("black", "black"), name = 'Drought \nSequence',
# labels = c("pine/fir" = "Needleleaf \nConifer", "other tree" = 'Other \nTrees'),
labels = c("Both Droughts" =  "Both \nDroughts", "2012-2015 Only" = "2012-2015 \nOnly"),
aesthetics = "color") +
theme(legend.background = element_rect(colour = NA, fill = NA), legend.justification = c(1, 0),
legend.position = c(0.75, 0.45), legend.text = element_text(size = 6), legend.title = element_text(size = 8),
legend.direction = "vertical", axis.text.x = element_text(size = 8), axis.title.x = element_text(size = 10),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10)) +
geom_text(data = p1_texta, mapping = aes(x = x, y = y, label = label, color = tree_type), size = 5) +
# geom_text(data = p1_textb, mapping = aes(x = x, y = y, label = label), size = 3) +
geom_text(data = data.frame(label = "Mean \n+/- SE", y = 3.5, x = 1.25, sequence = 'Both Droughts'), mapping = aes(x=x, y=y, label = label), size = 2) +
facet_grid(~ factor(sequence, levels = c('Both Droughts', '2012-2015 Only')))
p1
#Create the mortality (%) bar chart
p1 <- ggbarplot(filter(type.both.all), x = "drought", y = "basal_area.dead", fill = "tree_type", color = 'sequence',
ylab = 'Mortality (%)', xlab = "Time Period", order = c("1999-2002", "2012-2015"), position = position_dodge(), #stat = "density",
add = "mean_se" , error.plot = "errorbar", alpha = 0.8) +
guides(color = "none", fill = guide_legend('Tree \nType')) + theme_bw() +
scale_color_manual(values = c("black", "black"), name = 'Drought \nSequence',
# labels = c("pine/fir" = "Needleleaf \nConifer", "other tree" = 'Other \nTrees'),
labels = c("Both Droughts" =  "Both \nDroughts", "2012-2015 Only" = "2012-2015 \nOnly"),
aesthetics = "color") +
theme(legend.background = element_rect(colour = NA, fill = NA), legend.justification = c(1, 0),
legend.position = c(0.75, 0.45), legend.text = element_text(size = 6), legend.title = element_text(size = 8),
legend.direction = "vertical", axis.text.x = element_text(size = 8), axis.title.x = element_text(size = 10),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10)) +
geom_text(data = p1_texta, mapping = aes(x = x, y = y, label = label, colour = tree_type), size = 5) +
# geom_text(data = p1_textb, mapping = aes(x = x, y = y, label = label), size = 3) +
geom_text(data = data.frame(label = "Mean \n+/- SE", y = 3.5, x = 1.25, sequence = 'Both Droughts'), mapping = aes(x=x, y=y, label = label), size = 2) +
facet_grid(~ factor(sequence, levels = c('Both Droughts', '2012-2015 Only')))
p1
p1_texta <- data.frame(label = c("a", "b", "b","b", "b", "b", "b", "a"),
sequence   = c('Both Droughts', 'Both Droughts', 'Both Droughts', 'Both Droughts',
'2012-2015 Only', '2012-2015 Only', '2012-2015 Only', '2012-2015 Only'),
tree_type = c('pine/fir', 'other tree', 'pine/fir', 'other tree',
'pine/fir', 'other tree', 'pine/fir', 'other tree'),
y     = c(4, 1.2, 1.9, 0.9, 0.4, 0,4, 3.6,1.2),
x     = c(1, 1.25, 1.5, 2, 1, 1.25, 1.5, 2)
)
#Letters to indicate sample sizes
p1_textb <- data.frame(label = c("n = 44", "n = 26", "n = 199", "n = 192"),
sequence   = c('Both Droughts', 'Both Droughts', '2012-2015 Only', '2012-2015 Only'),
y     = c(34.5, 11, 3, 17.5),
x     = c(1, 2, 1, 2)
)
#Create the mortality (%) bar chart
p1 <- ggbarplot(filter(type.both.all), x = "drought", y = "basal_area.dead", fill = "tree_type", color = 'sequence',
ylab = 'Mortality (%)', xlab = "Time Period", order = c("1999-2002", "2012-2015"), position = position_dodge(), #stat = "density",
add = "mean_se" , error.plot = "errorbar", alpha = 0.8) +
guides(color = "none", fill = guide_legend('Tree \nType')) + theme_bw() +
scale_color_manual(values = c("black", "black"), name = 'Drought \nSequence',
# labels = c("pine/fir" = "Needleleaf \nConifer", "other tree" = 'Other \nTrees'),
labels = c("Both Droughts" =  "Both \nDroughts", "2012-2015 Only" = "2012-2015 \nOnly"),
aesthetics = "color") +
theme(legend.background = element_rect(colour = NA, fill = NA), legend.justification = c(1, 0),
legend.position = c(0.75, 0.45), legend.text = element_text(size = 6), legend.title = element_text(size = 8),
legend.direction = "vertical", axis.text.x = element_text(size = 8), axis.title.x = element_text(size = 10),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10)) +
geom_text(data = p1_texta, mapping = aes(x = x, y = y, label = label), size = 5) +
# geom_text(data = p1_textb, mapping = aes(x = x, y = y, label = label), size = 3) +
geom_text(data = data.frame(label = "Mean \n+/- SE", y = 3.5, x = 1.25, sequence = 'Both Droughts'), mapping = aes(x=x, y=y, label = label), size = 2) +
facet_grid(~ factor(sequence, levels = c('Both Droughts', '2012-2015 Only')))
p1
p1_texta <- data.frame(label = c("a", "b", "b","b", "b", "b", "b", "a"),
sequence   = c('Both Droughts', 'Both Droughts', 'Both Droughts', 'Both Droughts',
'2012-2015 Only', '2012-2015 Only', '2012-2015 Only', '2012-2015 Only'),
# tree_type = c('pine/fir', 'other tree', 'pine/fir', 'other tree',
#               'pine/fir', 'other tree', 'pine/fir', 'other tree'),
y     = c(4, 1.2, 1.9, 0.9, 0.4, 0,4, 3.6,1.2),
x     = c(1, 1.25, 1.5, 2, 1, 1.25, 1.5, 2)
)
p1_texta <- data.frame(label = c("a", "b", "b","b", "b", "b", "b", "a"),
sequence   = c('Both Droughts', 'Both Droughts', 'Both Droughts', 'Both Droughts',
'2012-2015 Only', '2012-2015 Only', '2012-2015 Only', '2012-2015 Only'),
# tree_type = c('pine/fir', 'other tree', 'pine/fir', 'other tree',
#               'pine/fir', 'other tree', 'pine/fir', 'other tree'),
y     = c(4, 1.2, 1.9, 0.9, 0.4, 0.4, 3.6,1.2),
x     = c(1, 1.25, 1.5, 2, 1, 1.25, 1.5, 2)
)
p1 <- ggbarplot(filter(type.both.all), x = "drought", y = "basal_area.dead", fill = "tree_type", color = 'sequence',
ylab = 'Mortality (%)', xlab = "Time Period", order = c("1999-2002", "2012-2015"), position = position_dodge(), #stat = "density",
add = "mean_se" , error.plot = "errorbar", alpha = 0.8) +
guides(color = "none", fill = guide_legend('Tree \nType')) + theme_bw() +
scale_color_manual(values = c("black", "black"), name = 'Drought \nSequence',
# labels = c("pine/fir" = "Needleleaf \nConifer", "other tree" = 'Other \nTrees'),
labels = c("Both Droughts" =  "Both \nDroughts", "2012-2015 Only" = "2012-2015 \nOnly"),
aesthetics = "color") +
theme(legend.background = element_rect(colour = NA, fill = NA), legend.justification = c(1, 0),
legend.position = c(0.75, 0.45), legend.text = element_text(size = 6), legend.title = element_text(size = 8),
legend.direction = "vertical", axis.text.x = element_text(size = 8), axis.title.x = element_text(size = 10),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10)) +
geom_text(data = p1_texta, mapping = aes(x = x, y = y, label = label), size = 5) +
# geom_text(data = p1_textb, mapping = aes(x = x, y = y, label = label), size = 3) +
geom_text(data = data.frame(label = "Mean \n+/- SE", y = 3.5, x = 1.25, sequence = 'Both Droughts'), mapping = aes(x=x, y=y, label = label), size = 2) +
facet_grid(~ factor(sequence, levels = c('Both Droughts', '2012-2015 Only')))
p1
p1_texta <- data.frame(label = c("a", "b", "b","b", "b", "b", "a", "b"),
sequence   = c('Both Droughts', 'Both Droughts', 'Both Droughts', 'Both Droughts',
'2012-2015 Only', '2012-2015 Only', '2012-2015 Only', '2012-2015 Only'),
# tree_type = c('pine/fir', 'other tree', 'pine/fir', 'other tree',
#               'pine/fir', 'other tree', 'pine/fir', 'other tree'),
y     = c(4, 1.2, 1.9, 0.9, 0.4, 0.4, 3.6,1.3),
x     = c(0.75, 1.25, 1.75, 2.25, 0.75, 1.25, 1.75, 2.25)
)
#Letters to indicate sample sizes
p1_textb <- data.frame(label = c("n = 44", "n = 26", "n = 199", "n = 192"),
sequence   = c('Both Droughts', 'Both Droughts', '2012-2015 Only', '2012-2015 Only'),
y     = c(34.5, 11, 3, 17.5),
x     = c(1, 2, 1, 2)
)
#Create the mortality (%) bar chart
p1 <- ggbarplot(filter(type.both.all), x = "drought", y = "basal_area.dead", fill = "tree_type", color = 'sequence',
ylab = 'Mortality (%)', xlab = "Time Period", order = c("1999-2002", "2012-2015"), position = position_dodge(), #stat = "density",
add = "mean_se" , error.plot = "errorbar", alpha = 0.8) +
guides(color = "none", fill = guide_legend('Tree \nType')) + theme_bw() +
scale_color_manual(values = c("black", "black"), name = 'Drought \nSequence',
# labels = c("pine/fir" = "Needleleaf \nConifer", "other tree" = 'Other \nTrees'),
labels = c("Both Droughts" =  "Both \nDroughts", "2012-2015 Only" = "2012-2015 \nOnly"),
aesthetics = "color") +
theme(legend.background = element_rect(colour = NA, fill = NA), legend.justification = c(1, 0),
legend.position = c(0.75, 0.45), legend.text = element_text(size = 6), legend.title = element_text(size = 8),
legend.direction = "vertical", axis.text.x = element_text(size = 8), axis.title.x = element_text(size = 10),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10)) +
geom_text(data = p1_texta, mapping = aes(x = x, y = y, label = label), size = 5) +
# geom_text(data = p1_textb, mapping = aes(x = x, y = y, label = label), size = 3) +
geom_text(data = data.frame(label = "Mean \n+/- SE", y = 3.5, x = 1.25, sequence = 'Both Droughts'), mapping = aes(x=x, y=y, label = label), size = 2) +
facet_grid(~ factor(sequence, levels = c('Both Droughts', '2012-2015 Only')))
p1
p1_texta <- data.frame(label = c("a", "b", "b","b", "b", "b", "a", "b"),
sequence   = c('Both Droughts', 'Both Droughts', 'Both Droughts', 'Both Droughts',
'2012-2015 Only', '2012-2015 Only', '2012-2015 Only', '2012-2015 Only'),
# tree_type = c('pine/fir', 'other tree', 'pine/fir', 'other tree',
#               'pine/fir', 'other tree', 'pine/fir', 'other tree'),
y     = c(3.95, 1.15, 1.85, 0.8, 0.3, 0.2, 3.5,1.3),
x     = c(0.75, 1.25, 1.75, 2.25, 0.75, 1.25, 1.75, 2.25)
)
#Letters to indicate sample sizes
p1_textb <- data.frame(label = c("n = 44", "n = 26", "n = 199", "n = 192"),
sequence   = c('Both Droughts', 'Both Droughts', '2012-2015 Only', '2012-2015 Only'),
y     = c(34.5, 11, 3, 17.5),
x     = c(1, 2, 1, 2)
)
#Create the mortality (%) bar chart
p1 <- ggbarplot(filter(type.both.all), x = "drought", y = "basal_area.dead", fill = "tree_type", color = 'sequence',
ylab = 'Mortality (%)', xlab = "Time Period", order = c("1999-2002", "2012-2015"), position = position_dodge(), #stat = "density",
add = "mean_se" , error.plot = "errorbar", alpha = 0.8) +
guides(color = "none", fill = guide_legend('Tree \nType')) + theme_bw() +
scale_color_manual(values = c("black", "black"), name = 'Drought \nSequence',
# labels = c("pine/fir" = "Needleleaf \nConifer", "other tree" = 'Other \nTrees'),
labels = c("Both Droughts" =  "Both \nDroughts", "2012-2015 Only" = "2012-2015 \nOnly"),
aesthetics = "color") +
theme(legend.background = element_rect(colour = NA, fill = NA), legend.justification = c(1, 0),
legend.position = c(0.75, 0.45), legend.text = element_text(size = 6), legend.title = element_text(size = 8),
legend.direction = "vertical", axis.text.x = element_text(size = 8), axis.title.x = element_text(size = 10),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10)) +
geom_text(data = p1_texta, mapping = aes(x = x, y = y, label = label), size = 5) +
# geom_text(data = p1_textb, mapping = aes(x = x, y = y, label = label), size = 3) +
geom_text(data = data.frame(label = "Mean \n+/- SE", y = 3.5, x = 1.25, sequence = 'Both Droughts'), mapping = aes(x=x, y=y, label = label), size = 2) +
facet_grid(~ factor(sequence, levels = c('Both Droughts', '2012-2015 Only')))
p1
p1 <- ggbarplot(filter(type.both.all), x = "drought", y = "basal_area.dead", fill = "tree_type", color = 'sequence',
ylab = 'Mortality (%)', xlab = "Time Period", order = c("1999-2002", "2012-2015"), position = position_dodge(), #stat = "density",
add = "mean_se" , error.plot = "errorbar", alpha = 0.8) +
guides(color = "none", fill = guide_legend('Tree \nType')) + theme_bw() +
scale_color_manual(values = c("black", "black"), name = 'Drought \nSequence',
# labels = c("pine/fir" = "Needleleaf \nConifer", "other tree" = 'Other \nTrees'),
labels = c("Both Droughts" =  "Both \nDroughts", "2012-2015 Only" = "2012-2015 \nOnly"),
aesthetics = "color") +
theme(legend.background = element_rect(colour = NA, fill = NA), legend.justification = c(1, 0),
legend.position = c(0.75, 0.45), legend.text = element_text(size = 6), legend.title = element_text(size = 8),
legend.direction = "vertical", axis.text.x = element_text(size = 8), axis.title.x = element_text(size = 10),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10)) +
geom_text(data = p1_texta, mapping = aes(x = x, y = y, label = label), size = 5) +
# geom_text(data = p1_textb, mapping = aes(x = x, y = y, label = label), size = 3) +
geom_text(data = data.frame(label = "Mean \n+/- SE", y = 3.5, x = 1, sequence = 'Both Droughts'), mapping = aes(x=x, y=y, label = label), size = 2) +
facet_grid(~ factor(sequence, levels = c('Both Droughts', '2012-2015 Only')))
p1
#Save figure as a .png file
ggsave(filename = 'Fig4_needleleaf_conifer_mortality_barplot.png', height=7, width=12, units = 'cm', dpi=900)
p1_texta <- data.frame(label = c("a", "b", "b","b", "b", "b", "a", "b"),
sequence   = c('Both Droughts', 'Both Droughts', 'Both Droughts', 'Both Droughts',
'2012-2015 Only', '2012-2015 Only', '2012-2015 Only', '2012-2015 Only'),
# tree_type = c('pine/fir', 'other tree', 'pine/fir', 'other tree',
#               'pine/fir', 'other tree', 'pine/fir', 'other tree'),
y     = c(4.05, 1.2, 1.85, 0.85, 0.4, 0.35, 3.55,1.4),
x     = c(0.75, 1.25, 1.75, 2.25, 0.75, 1.25, 1.75, 2.25)
)
#Letters to indicate sample sizes
p1_textb <- data.frame(label = c("n = 44", "n = 26", "n = 199", "n = 192"),
sequence   = c('Both Droughts', 'Both Droughts', '2012-2015 Only', '2012-2015 Only'),
y     = c(34.5, 11, 3, 17.5),
x     = c(1, 2, 1, 2)
)
#Create the mortality (%) bar chart
p1 <- ggbarplot(filter(type.both.all), x = "drought", y = "basal_area.dead", fill = "tree_type", color = 'sequence',
ylab = 'Mortality (%)', xlab = "Time Period", order = c("1999-2002", "2012-2015"), position = position_dodge(), #stat = "density",
add = "mean_se" , error.plot = "errorbar", alpha = 0.8) +
guides(color = "none", fill = guide_legend('Tree \nType')) + theme_bw() +
scale_color_manual(values = c("black", "black"), name = 'Drought \nSequence',
# labels = c("pine/fir" = "Needleleaf \nConifer", "other tree" = 'Other \nTrees'),
labels = c("Both Droughts" =  "Both \nDroughts", "2012-2015 Only" = "2012-2015 \nOnly"),
aesthetics = "color") +
theme(legend.background = element_rect(colour = NA, fill = NA), legend.justification = c(1, 0),
legend.position = c(0.75, 0.45), legend.text = element_text(size = 6), legend.title = element_text(size = 8),
legend.direction = "vertical", axis.text.x = element_text(size = 8), axis.title.x = element_text(size = 10),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10)) +
geom_text(data = p1_texta, mapping = aes(x = x, y = y, label = label), size = 5) +
# geom_text(data = p1_textb, mapping = aes(x = x, y = y, label = label), size = 3) +
geom_text(data = data.frame(label = "Mean \n+/- SE", y = 3.5, x = 1, sequence = 'Both Droughts'), mapping = aes(x=x, y=y, label = label), size = 2) +
facet_grid(~ factor(sequence, levels = c('Both Droughts', '2012-2015 Only')))
p1
#Save figure as a .png file
ggsave(filename = 'Fig4_needleleaf_conifer_mortality_barplot.png', height=7, width=12, units = 'cm', dpi=900)
p1 <- ggbarplot(all.forest %>% filter(COMMON_NAME %in% sp.both.2002[! sp.both.2002 %in% c('curlleaf mountain-mahogany', 'California live oak')]), #, (sequence == 'Both Droughts' & drought == '1999-2002') | (sequence == '2012-2015 Only' & drought == '2012-2015')),
x = "time.period", y = "BAA.dead", position = position_dodge(), fill = 'COMMON_NAME', color = "sequence",
add = "mean_se" , error.plot = "errorbar", alpha = 0.8) +
theme_bw() + guides(color = 'none', fill = guide_legend("Tree \nSpecies")) +
scale_color_manual(values = c("black", "black"),
aesthetics = "color") +
# theme(legend.background = element_rect(colour = NA, fill = NA), legend.justification = c(1, 0),
#       legend.position = c(0.72, 0.28), legend.text = element_text(size = 6), legend.title = element_text(size = 8),
#       legend.direction = "vertical", axis.text.x = element_text(size = 8), axis.title.x = element_text(size = 10),
#       axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10)) +
# geom_text(data = p1_texta, mapping = aes(x = x, y = y, label = label), size = 5) +
# geom_text(data = p1_textb, mapping = aes(x = x, y = y, label = label), size = 3) +
geom_text(data = data.frame(label = "Mean \n+/- SE", y = 35, x = 1.5, sequence = 'Both Droughts'), mapping = aes(x=x, y=y, label = label), size = 2) +
facet_grid(~ factor(sequence, levels = c('Both Droughts', '2012-2015 Only')))
p1
ggsave(filename = 'SFig10_species_mortality_barplot.png', height=7, width=16, units = 'cm', dpi=900)
#Convert basal area from sq ft / acre to sq meter / hectare
all.forest$BAA.dead <- all.forest$BAA.dead * (1/4.356)
p1 <- ggbarplot(all.forest %>% filter(COMMON_NAME %in% sp.both.2002[! sp.both.2002 %in% c('curlleaf mountain-mahogany', 'California live oak')]), #, (sequence == 'Both Droughts' & drought == '1999-2002') | (sequence == '2012-2015 Only' & drought == '2012-2015')),
x = "time.period", y = "BAA.dead", position = position_dodge(), fill = 'COMMON_NAME', color = "sequence",
add = "mean_se" , error.plot = "errorbar", alpha = 0.8) +
theme_bw() + guides(color = 'none', fill = guide_legend("Tree \nSpecies")) +
scale_color_manual(values = c("black", "black"),
aesthetics = "color") +
# theme(legend.background = element_rect(colour = NA, fill = NA), legend.justification = c(1, 0),
#       legend.position = c(0.72, 0.28), legend.text = element_text(size = 6), legend.title = element_text(size = 8),
#       legend.direction = "vertical", axis.text.x = element_text(size = 8), axis.title.x = element_text(size = 10),
#       axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10)) +
# geom_text(data = p1_texta, mapping = aes(x = x, y = y, label = label), size = 5) +
# geom_text(data = p1_textb, mapping = aes(x = x, y = y, label = label), size = 3) +
geom_text(data = data.frame(label = "Mean \n+/- SE", y = 35, x = 1.5, sequence = 'Both Droughts'), mapping = aes(x=x, y=y, label = label), size = 2) +
facet_grid(~ factor(sequence, levels = c('Both Droughts', '2012-2015 Only')))
p1
p1 <- ggbarplot(all.forest %>% filter(COMMON_NAME %in% sp.both.2002[! sp.both.2002 %in% c('curlleaf mountain-mahogany', 'California live oak')]), #, (sequence == 'Both Droughts' & drought == '1999-2002') | (sequence == '2012-2015 Only' & drought == '2012-2015')),
x = "time.period", y = "BAA.dead", position = position_dodge(), fill = 'COMMON_NAME', color = "sequence",
add = "mean_se" , error.plot = "errorbar", alpha = 0.8) +
theme_bw() + guides(color = 'none', fill = guide_legend("Tree \nSpecies")) +
scale_color_manual(values = c("black", "black"),
aesthetics = "color") +
# theme(legend.background = element_rect(colour = NA, fill = NA), legend.justification = c(1, 0),
#       legend.position = c(0.72, 0.28), legend.text = element_text(size = 6), legend.title = element_text(size = 8),
#       legend.direction = "vertical", axis.text.x = element_text(size = 8), axis.title.x = element_text(size = 10),
#       axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10)) +
# geom_text(data = p1_texta, mapping = aes(x = x, y = y, label = label), size = 5) +
# geom_text(data = p1_textb, mapping = aes(x = x, y = y, label = label), size = 3) +
geom_text(data = data.frame(label = "Mean \n+/- SE", y = 5, x = 1.5, sequence = 'Both Droughts'), mapping = aes(x=x, y=y, label = label), size = 2) +
facet_grid(~ factor(sequence, levels = c('Both Droughts', '2012-2015 Only')))
ggsave(filename = 'SFig10_species_mortality_barplot.png', height=7, width=16, units = 'cm', dpi=900)
p1 <- ggbarplot(all.forest %>% filter(COMMON_NAME %in% sp.both.2002[! sp.both.2002 %in% c('curlleaf mountain-mahogany', 'California live oak')]), #, (sequence == 'Both Droughts' & drought == '1999-2002') | (sequence == '2012-2015 Only' & drought == '2012-2015')),
x = "time.period", y = "BAA.dead", position = position_dodge(), fill = 'COMMON_NAME', color = "sequence",
add = "mean_se" , error.plot = "errorbar", alpha = 0.8) +
theme_bw() + guides(color = 'none', fill = guide_legend("Tree \nSpecies")) +
scale_color_manual(values = c("black", "black"),
aesthetics = "color") +
theme(legend.background = element_rect(colour = NA, fill = NA), legend.justification = c(1, 0),
legend.position = c(0.72, 0.28), legend.text = element_text(size = 6), legend.title = element_text(size = 8),
legend.direction = "vertical", axis.text.x = element_text(size = 8), axis.title.x = element_text(size = 10),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10)) +
# geom_text(data = p1_texta, mapping = aes(x = x, y = y, label = label), size = 5) +
# geom_text(data = p1_textb, mapping = aes(x = x, y = y, label = label), size = 3) +
geom_text(data = data.frame(label = "Mean \n+/- SE", y = 5, x = 1.5, sequence = 'Both Droughts'), mapping = aes(x=x, y=y, label = label), size = 2) +
facet_grid(~ factor(sequence, levels = c('Both Droughts', '2012-2015 Only')))
p1
ggsave(filename = 'SFig10_species_mortality_barplot.png', height=7, width=16, units = 'cm', dpi=900)
p1 <- ggbarplot(all.forest %>% filter(COMMON_NAME %in% sp.both.2002[! sp.both.2002 %in% c('curlleaf mountain-mahogany', 'California live oak')]), #, (sequence == 'Both Droughts' & drought == '1999-2002') | (sequence == '2012-2015 Only' & drought == '2012-2015')),
x = "time.period", y = "BAA.dead", position = position_dodge(), fill = 'COMMON_NAME', color = "sequence",
add = "mean_se" , error.plot = "errorbar", alpha = 0.8) +
theme_bw() + guides(color = 'none', fill = guide_legend(title = "Tree \nSpecies", ncol = 2)) +
scale_color_manual(values = c("black", "black"),
aesthetics = "color") +
theme(legend.background = element_rect(colour = NA, fill = NA), legend.justification = c(1, 0),
legend.position = c(0.72, 0.28), legend.text = element_text(size = 4), legend.title = element_text(size = 6),
legend.direction = "vertical", axis.text.x = element_text(size = 8), axis.title.x = element_text(size = 10),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10)) +
# geom_text(data = p1_texta, mapping = aes(x = x, y = y, label = label), size = 5) +
# geom_text(data = p1_textb, mapping = aes(x = x, y = y, label = label), size = 3) +
geom_text(data = data.frame(label = "Mean \n+/- SE", y = 5, x = 1.5, sequence = 'Both Droughts'), mapping = aes(x=x, y=y, label = label), size = 2) +
facet_grid(~ factor(sequence, levels = c('Both Droughts', '2012-2015 Only')))
p1
ggsave(filename = 'SFig10_species_mortality_barplot.png', height=7, width=16, units = 'cm', dpi=900)
p1 <- ggbarplot(all.forest %>% filter(COMMON_NAME %in% sp.both.2002[! sp.both.2002 %in% c('curlleaf mountain-mahogany', 'California live oak')]), #, (sequence == 'Both Droughts' & drought == '1999-2002') | (sequence == '2012-2015 Only' & drought == '2012-2015')),
x = "time.period", y = "BAA.dead", position = position_dodge(), fill = 'COMMON_NAME', color = "sequence",
add = "mean_se" , error.plot = "errorbar", alpha = 0.8) +
theme_bw() + guides(color = 'none', fill = guide_legend(title = "Tree \nSpecies", ncol = 2)) +
scale_color_manual(values = c("black", "black"),
aesthetics = "color") +
theme(legend.background = element_rect(colour = NA, fill = NA), legend.justification = c(1, 0),
legend.position = c(0.8, 0.28), legend.text = element_text(size = 4), legend.title = element_text(size = 6),
legend.direction = "vertical", axis.text.x = element_text(size = 8), axis.title.x = element_text(size = 10),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10)) +
# geom_text(data = p1_texta, mapping = aes(x = x, y = y, label = label), size = 5) +
# geom_text(data = p1_textb, mapping = aes(x = x, y = y, label = label), size = 3) +
geom_text(data = data.frame(label = "Mean \n+/- SE", y = 5, x = 1.5, sequence = 'Both Droughts'), mapping = aes(x=x, y=y, label = label), size = 2) +
facet_grid(~ factor(sequence, levels = c('Both Droughts', '2012-2015 Only')))
p1
ggsave(filename = 'SFig10_species_mortality_barplot.png', height=7, width=16, units = 'cm', dpi=900)
p1 <- ggbarplot(all.forest %>% filter(COMMON_NAME %in% sp.both.2002[! sp.both.2002 %in% c('curlleaf mountain-mahogany', 'California live oak')]), #, (sequence == 'Both Droughts' & drought == '1999-2002') | (sequence == '2012-2015 Only' & drought == '2012-2015')),
x = "time.period", y = "BAA.dead", position = position_dodge(), fill = 'COMMON_NAME', color = "sequence",
add = "mean_se" , error.plot = "errorbar", alpha = 0.8) +
theme_bw() + guides(color = 'none', fill = guide_legend(title = "Tree \nSpecies", ncol = 2)) +
scale_color_manual(values = c("black", "black"),
aesthetics = "color") +
theme(legend.background = element_rect(colour = NA, fill = NA), legend.justification = c(1, 0),
legend.position = c(0.8, 0.28), legend.text = element_text(size = 3), legend.title = element_text(size = 5),
legend.direction = "vertical", axis.text.x = element_text(size = 8), axis.title.x = element_text(size = 10),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10)) +
# geom_text(data = p1_texta, mapping = aes(x = x, y = y, label = label), size = 5) +
# geom_text(data = p1_textb, mapping = aes(x = x, y = y, label = label), size = 3) +
geom_text(data = data.frame(label = "Mean \n+/- SE", y = 5, x = 1.5, sequence = 'Both Droughts'), mapping = aes(x=x, y=y, label = label), size = 2) +
facet_grid(~ factor(sequence, levels = c('Both Droughts', '2012-2015 Only')))
p1
ggsave(filename = 'SFig10_species_mortality_barplot.png', height=7, width=16, units = 'cm', dpi=900)
p1 <- ggbarplot(all.forest %>% filter(COMMON_NAME %in% sp.both.2002[! sp.both.2002 %in% c('curlleaf mountain-mahogany', 'California live oak')]), #, (sequence == 'Both Droughts' & drought == '1999-2002') | (sequence == '2012-2015 Only' & drought == '2012-2015')),
x = "time.period", y = "BAA.dead", position = position_dodge(), fill = 'COMMON_NAME', color = "sequence",
add = "mean_se" , error.plot = "errorbar", alpha = 0.8) +
theme_bw() + guides(color = 'none', fill = guide_legend(title = "Tree \nSpecies", ncol = 2)) +
scale_color_manual(values = c("black", "black"),
aesthetics = "color") +
theme(legend.background = element_rect(colour = NA, fill = NA), legend.justification = c(1, 0),
legend.position = c(0.76, 0.25), legend.text = element_text(size = 3), legend.title = element_text(size = 5),
legend.direction = "vertical", axis.text.x = element_text(size = 8), axis.title.x = element_text(size = 10),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10)) +
# geom_text(data = p1_texta, mapping = aes(x = x, y = y, label = label), size = 5) +
# geom_text(data = p1_textb, mapping = aes(x = x, y = y, label = label), size = 3) +
geom_text(data = data.frame(label = "Mean \n+/- SE", y = 5, x = 1.5, sequence = 'Both Droughts'), mapping = aes(x=x, y=y, label = label), size = 2) +
facet_grid(~ factor(sequence, levels = c('Both Droughts', '2012-2015 Only')))
p1
ggsave(filename = 'SFig10_species_mortality_barplot.png', height=7, width=16, units = 'cm', dpi=900)
p1 <- ggbarplot(all.forest %>% filter(COMMON_NAME %in% sp.both.2002[! sp.both.2002 %in% c('curlleaf mountain-mahogany', 'California live oak')]), #, (sequence == 'Both Droughts' & drought == '1999-2002') | (sequence == '2012-2015 Only' & drought == '2012-2015')),
x = "time.period", y = "BAA.dead", position = position_dodge(), fill = 'COMMON_NAME', color = "sequence",
add = "mean_se" , error.plot = "errorbar", alpha = 0.8) +
theme_bw() + guides(color = 'none', fill = guide_legend(title = "Tree \nSpecies", ncol = 2)) +
scale_color_manual(values = c("black", "black"),
aesthetics = "color") +
theme(legend.background = element_rect(colour = NA, fill = NA), legend.justification = c(1, 0),
legend.position = c(0.76, 0.22), legend.text = element_text(size = 3), legend.title = element_text(size = 5),
legend.direction = "vertical", axis.text.x = element_text(size = 8), axis.title.x = element_text(size = 10),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10)) +
# geom_text(data = p1_texta, mapping = aes(x = x, y = y, label = label), size = 5) +
# geom_text(data = p1_textb, mapping = aes(x = x, y = y, label = label), size = 3) +
geom_text(data = data.frame(label = "Mean \n+/- SE", y = 5, x = 1.5, sequence = 'Both Droughts'), mapping = aes(x=x, y=y, label = label), size = 2) +
facet_grid(~ factor(sequence, levels = c('Both Droughts', '2012-2015 Only')))
p1
ggsave(filename = 'SFig10_species_mortality_barplot.png', height=7, width=16, units = 'cm', dpi=900)
p1 <- ggbarplot(all.forest %>% filter(COMMON_NAME %in% sp.both.2002[! sp.both.2002 %in% c('curlleaf mountain-mahogany', 'California live oak')]), #, (sequence == 'Both Droughts' & drought == '1999-2002') | (sequence == '2012-2015 Only' & drought == '2012-2015')),
x = "time.period", y = "BAA.dead", position = position_dodge(), fill = 'COMMON_NAME', color = "sequence",
add = "mean_se" , error.plot = "errorbar", alpha = 0.8) +
theme_bw() + guides(color = 'none', fill = guide_legend(title = "Tree \nSpecies", ncol = 2)) +
scale_color_manual(values = c("black", "black"),
aesthetics = "color") +
theme(legend.background = element_rect(colour = NA, fill = NA), legend.justification = c(1, 0),
legend.position = c(0.76, 0.19), legend.text = element_text(size = 3), legend.title = element_text(size = 5),
legend.direction = "vertical", axis.text.x = element_text(size = 8), axis.title.x = element_text(size = 10),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10)) +
# geom_text(data = p1_texta, mapping = aes(x = x, y = y, label = label), size = 5) +
# geom_text(data = p1_textb, mapping = aes(x = x, y = y, label = label), size = 3) +
geom_text(data = data.frame(label = "Mean \n+/- SE", y = 5, x = 1.5, sequence = 'Both Droughts'), mapping = aes(x=x, y=y, label = label), size = 2) +
facet_grid(~ factor(sequence, levels = c('Both Droughts', '2012-2015 Only')))
p1
ggsave(filename = 'SFig10_species_mortality_barplot.png', height=7, width=16, units = 'cm', dpi=900)
p1 <- ggbarplot(all.forest %>% filter(COMMON_NAME %in% sp.both.2002[! sp.both.2002 %in% c('curlleaf mountain-mahogany', 'California live oak')]), #, (sequence == 'Both Droughts' & drought == '1999-2002') | (sequence == '2012-2015 Only' & drought == '2012-2015')),
x = "time.period", y = "BAA.dead", position = position_dodge(), fill = 'COMMON_NAME', color = "sequence",
add = "mean_se" , error.plot = "errorbar", alpha = 0.8) +
theme_bw() + guides(color = 'none', fill = guide_legend(title = "Tree \nSpecies", ncol = 2)) +
scale_color_manual(values = c("black", "black"),
aesthetics = "color") +
theme(legend.background = element_rect(colour = NA, fill = NA), legend.justification = c(1, 0),
legend.position = c(0.76, 0.16), legend.text = element_text(size = 3), legend.title = element_text(size = 5),
legend.direction = "vertical", axis.text.x = element_text(size = 8), axis.title.x = element_text(size = 10),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10)) +
# geom_text(data = p1_texta, mapping = aes(x = x, y = y, label = label), size = 5) +
# geom_text(data = p1_textb, mapping = aes(x = x, y = y, label = label), size = 3) +
geom_text(data = data.frame(label = "Mean \n+/- SE", y = 5, x = 1.5, sequence = 'Both Droughts'), mapping = aes(x=x, y=y, label = label), size = 2) +
facet_grid(~ factor(sequence, levels = c('Both Droughts', '2012-2015 Only')))
p1
ggsave(filename = 'SFig10_species_mortality_barplot.png', height=7, width=16, units = 'cm', dpi=900)
p1 <- ggbarplot(all.forest %>% filter(COMMON_NAME %in% sp.both.2002[! sp.both.2002 %in% c('curlleaf mountain-mahogany', 'California live oak')]), #, (sequence == 'Both Droughts' & drought == '1999-2002') | (sequence == '2012-2015 Only' & drought == '2012-2015')),
x = "time.period", y = "BAA.dead", position = position_dodge(), fill = 'COMMON_NAME', color = "sequence",
add = "mean_se" , error.plot = "errorbar", alpha = 0.8) +
theme_bw() + guides(color = 'none', fill = guide_legend(title = "Tree \nSpecies", ncol = 2)) +
scale_color_manual(values = c("black", "black"),
aesthetics = "color") +
theme(legend.background = element_rect(colour = NA, fill = NA), legend.justification = c(1, 0),
legend.position = c(0.76, 0.15), legend.text = element_text(size = 3), legend.title = element_text(size = 5),
legend.direction = "vertical", axis.text.x = element_text(size = 8), axis.title.x = element_text(size = 10),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10)) +
# geom_text(data = p1_texta, mapping = aes(x = x, y = y, label = label), size = 5) +
# geom_text(data = p1_textb, mapping = aes(x = x, y = y, label = label), size = 3) +
geom_text(data = data.frame(label = "Mean \n+/- SE", y = 5, x = 1.5, sequence = 'Both Droughts'), mapping = aes(x=x, y=y, label = label), size = 2) +
facet_grid(~ factor(sequence, levels = c('Both Droughts', '2012-2015 Only')))
p1
ggsave(filename = 'SFig10_species_mortality_barplot.png', height=7, width=16, units = 'cm', dpi=900)
p1 <- ggbarplot(all.forest %>% filter(COMMON_NAME %in% sp.both.2002[! sp.both.2002 %in% c('curlleaf mountain-mahogany', 'California live oak')]), #, (sequence == 'Both Droughts' & drought == '1999-2002') | (sequence == '2012-2015 Only' & drought == '2012-2015')),
x = "time.period", y = "BAA.dead", position = position_dodge(), fill = 'COMMON_NAME', color = "sequence",
add = "mean_se" , error.plot = "errorbar", alpha = 0.8) +
theme_bw() + guides(color = 'none', fill = guide_legend(title = "Tree \nSpecies", ncol = 2)) +
scale_color_manual(values = c("black", "black"),
aesthetics = "color") +
theme(legend.background = element_rect(colour = NA, fill = NA), legend.justification = c(1, 0),
legend.position = c(0.76, 0.15), legend.text = element_text(size = 3), legend.title = element_text(size = 5),
legend.direction = "vertical", axis.text.x = element_text(size = 8), axis.title.x = element_text(size = 10),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10)) +
# geom_text(data = p1_texta, mapping = aes(x = x, y = y, label = label), size = 5) +
# geom_text(data = p1_textb, mapping = aes(x = x, y = y, label = label), size = 3) +
geom_text(data = data.frame(label = "Mean \n+/- SE", y = 4, x = 2.25, sequence = 'Both Droughts'), mapping = aes(x=x, y=y, label = label), size = 2) +
facet_grid(~ factor(sequence, levels = c('Both Droughts', '2012-2015 Only')))
p1
ggsave(filename = 'SFig10_species_mortality_barplot.png', height=7, width=16, units = 'cm', dpi=900)
