#Create a Pr-ET time series graph
p3 <- ggplot() +
geom_rect(data = data.frame(xmin = as.Date('1998-10-01'), xmax = as.Date('2002-09-30'), ymin = -Inf, ymax = Inf),
fill = "red", alpha = 0.3, mapping = aes(xmin = xmin, xmax = xmax, ymin = ymin, ymax = ymax)) +
geom_rect(data = data.frame(xmin = as.Date('2011-10-01'), xmax = as.Date('2015-09-30'), ymin = -Inf, ymax = Inf),
fill = "red", alpha = 0.3, mapping = aes(xmin = xmin, xmax = xmax, ymin = ymin, ymax = ymax)) +
geom_line(data = time.series, mapping = aes(x = time_start, y = PET_mean, color = drought, linetype = drought), size = 0.5) +
geom_errorbar(data=time.series, mapping=aes(x=time_start, ymin=PET_mean - (PET_stdDev / sqrt(count) * 1.96), ymax=PET_mean + (PET_stdDev / sqrt(count) * 1.96), color = drought, linetype = drought),
size = 0.4, width = 100, alpha = 0.6) +
theme_bw() +
geom_hline(yintercept = 0, linetype='dashed') +
scale_linetype_manual(values=c("solid", "twodash")) +
scale_color_manual(values=c("#E66100", "#5D3A9B")) +
theme(axis.text.x = element_text(size = 8), axis.text.y = element_text(size = 8), axis.title.x = element_text(size = 10), legend.position = 'none',
axis.title.y = element_text(size = 10), plot.margin = unit(c(0,0,0,0), "pt"), legend.title = element_text(size = 8), legend.text = element_text(size = 6)) +
xlab('Year') + ylab(expression(atop(NA, atop(textstyle('Pr-ET'),textstyle(paste('(mm ',yr^{-1},')')))))) +
annotate("text", x = as.Date('1991-10-01'), y = 1050, label = "Water\nSurplus", size = 2) +
annotate("text", x = as.Date('1991-10-01'), y = 0, label = "Water\nDeficit", size = 2)
#Combine the three time series graphs into one
# (p1 / p2 / p3) + plot_annotation(tag_levels = 'a', tag_suffix = ')',
#                                  theme = theme(legend.margin=margin(t = 0, unit='cm'))) + plot_layout(heights = c(0.95,0.95,1))
f1 <- ggarrange(p1, p2, p3, ncol = 1, nrow = 3, common.legend = FALSE, heights = c(0.9, 0.9,1), align = "v", labels = c('a)', 'b)', 'c)'))
f1
#Save and export the figure as a .png file
ggsave(filename = 'Fig2_drought_time_series.png', height=13, width=11, units = 'cm', dpi=900)
p2 <- ggplot() +
geom_rect(data = data.frame(xmin = as.Date('1998-10-01'), xmax = as.Date('2002-09-30'), ymin = -Inf, ymax = Inf),
fill = "red", alpha = 0.3, mapping = aes(xmin = xmin, xmax = xmax, ymin = ymin, ymax = ymax)) +
geom_rect(data = data.frame(xmin = as.Date('2011-10-01'), xmax = as.Date('2015-09-30'), ymin = -Inf, ymax = Inf),
fill = "red", alpha = 0.3, mapping = aes(xmin = xmin, xmax = xmax, ymin = ymin, ymax = ymax)) +
geom_line(data = time.series, mapping = aes(x = time_start, y = dNDMI_mean, color = drought, linetype = drought), size = 0.5) +
geom_errorbar(data=time.series, mapping=aes(x=time_start, ymin=dNDMI_mean - (dNDMI_stdDev / sqrt(count) * 1.96), ymax=dNDMI_mean + (dNDMI_stdDev / sqrt(count) * 1.96), color = drought, linetype = drought),
size = 0.4, width = 100, alpha = 0.6) +
theme_bw() + geom_hline(yintercept = 0, linetype='dashed') +
scale_linetype_manual(values=c("solid", "twodash")) +
scale_color_manual(values=c("#E66100", "#5D3A9B")) + scale_y_reverse() +
theme(axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10), axis.title.x=element_blank(), legend.position = 'none',
axis.text.x=element_blank(), plot.margin = unit(c(0,0,5,0), "pt"), legend.title = element_text(size = 8), legend.text = element_text(size = 6)) +
ylab('Die-off\n(dNDMI)') + geom_text(data = data.frame(label = "95% CI", x = as.Date('2018-11-30'), y = -0.019, sequence = 'Both Droughts'), mapping = aes(x=x, y=y, label = label), size = 2) +
annotate("text", x = as.Date('1991-10-01'), y = -0.0375, label = "More\nSevere", size = 2) +
annotate("text", x = as.Date('1991-10-01'), y = 0.0375, label = "Less\nSevere", size = 2)
#Create a Pr-ET time series graph
p3 <- ggplot() +
geom_rect(data = data.frame(xmin = as.Date('1998-10-01'), xmax = as.Date('2002-09-30'), ymin = -Inf, ymax = Inf),
fill = "red", alpha = 0.3, mapping = aes(xmin = xmin, xmax = xmax, ymin = ymin, ymax = ymax)) +
geom_rect(data = data.frame(xmin = as.Date('2011-10-01'), xmax = as.Date('2015-09-30'), ymin = -Inf, ymax = Inf),
fill = "red", alpha = 0.3, mapping = aes(xmin = xmin, xmax = xmax, ymin = ymin, ymax = ymax)) +
geom_line(data = time.series, mapping = aes(x = time_start, y = PET_mean, color = drought, linetype = drought), size = 0.5) +
geom_errorbar(data=time.series, mapping=aes(x=time_start, ymin=PET_mean - (PET_stdDev / sqrt(count) * 1.96), ymax=PET_mean + (PET_stdDev / sqrt(count) * 1.96), color = drought, linetype = drought),
size = 0.4, width = 100, alpha = 0.6) +
theme_bw() +
geom_hline(yintercept = 0, linetype='dashed') +
scale_linetype_manual(values=c("solid", "twodash")) +
scale_color_manual(values=c("#E66100", "#5D3A9B")) +
theme(axis.text.x = element_text(size = 8), axis.text.y = element_text(size = 8), axis.title.x = element_text(size = 10), legend.position = 'none',
axis.title.y = element_text(size = 10), plot.margin = unit(c(0,0,0,0), "pt"), legend.title = element_text(size = 8), legend.text = element_text(size = 6)) +
xlab('Year') + ylab(expression(atop(NA, atop(textstyle('Pr-ET'),textstyle(paste('(mm ',yr^{-1},')')))))) +
annotate("text", x = as.Date('1991-10-01'), y = 1050, label = "Water\nSurplus", size = 2) +
annotate("text", x = as.Date('1991-10-01'), y = 0, label = "Water\nDeficit", size = 2)
#Combine the three time series graphs into one
# (p1 / p2 / p3) + plot_annotation(tag_levels = 'a', tag_suffix = ')',
#                                  theme = theme(legend.margin=margin(t = 0, unit='cm'))) + plot_layout(heights = c(0.95,0.95,1))
f1 <- ggarrange(p1, p2, p3, ncol = 1, nrow = 3, common.legend = FALSE, heights = c(0.9, 0.9,1), align = "v", labels = c('a)', 'b)', 'c)'))
f1
#Save and export the figure as a .png file
ggsave(filename = 'Fig2_drought_time_series.png', height=13, width=11, units = 'cm', dpi=900)
p2 <- ggplot() +
geom_rect(data = data.frame(xmin = as.Date('1998-10-01'), xmax = as.Date('2002-09-30'), ymin = -Inf, ymax = Inf),
fill = "red", alpha = 0.3, mapping = aes(xmin = xmin, xmax = xmax, ymin = ymin, ymax = ymax)) +
geom_rect(data = data.frame(xmin = as.Date('2011-10-01'), xmax = as.Date('2015-09-30'), ymin = -Inf, ymax = Inf),
fill = "red", alpha = 0.3, mapping = aes(xmin = xmin, xmax = xmax, ymin = ymin, ymax = ymax)) +
geom_line(data = time.series, mapping = aes(x = time_start, y = dNDMI_mean, color = drought, linetype = drought), size = 0.5) +
geom_errorbar(data=time.series, mapping=aes(x=time_start, ymin=dNDMI_mean - (dNDMI_stdDev / sqrt(count) * 1.96), ymax=dNDMI_mean + (dNDMI_stdDev / sqrt(count) * 1.96), color = drought, linetype = drought),
size = 0.4, width = 100, alpha = 0.6) +
theme_bw() + geom_hline(yintercept = 0, linetype='dashed') +
scale_linetype_manual(values=c("solid", "twodash")) +
scale_color_manual(values=c("#E66100", "#5D3A9B")) + scale_y_reverse() +
theme(axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10), axis.title.x=element_blank(), legend.position = 'none',
axis.text.x=element_blank(), plot.margin = unit(c(0,0,5,0), "pt"), legend.title = element_text(size = 8), legend.text = element_text(size = 6)) +
ylab('Die-off\n(dNDMI)') + geom_text(data = data.frame(label = "95% CI", x = as.Date('2018-12-31'), y = -0.019, sequence = 'Both Droughts'), mapping = aes(x=x, y=y, label = label), size = 2) +
annotate("text", x = as.Date('1991-10-01'), y = -0.0375, label = "More\nSevere", size = 2) +
annotate("text", x = as.Date('1991-10-01'), y = 0.0375, label = "Less\nSevere", size = 2)
#Create a Pr-ET time series graph
p3 <- ggplot() +
geom_rect(data = data.frame(xmin = as.Date('1998-10-01'), xmax = as.Date('2002-09-30'), ymin = -Inf, ymax = Inf),
fill = "red", alpha = 0.3, mapping = aes(xmin = xmin, xmax = xmax, ymin = ymin, ymax = ymax)) +
geom_rect(data = data.frame(xmin = as.Date('2011-10-01'), xmax = as.Date('2015-09-30'), ymin = -Inf, ymax = Inf),
fill = "red", alpha = 0.3, mapping = aes(xmin = xmin, xmax = xmax, ymin = ymin, ymax = ymax)) +
geom_line(data = time.series, mapping = aes(x = time_start, y = PET_mean, color = drought, linetype = drought), size = 0.5) +
geom_errorbar(data=time.series, mapping=aes(x=time_start, ymin=PET_mean - (PET_stdDev / sqrt(count) * 1.96), ymax=PET_mean + (PET_stdDev / sqrt(count) * 1.96), color = drought, linetype = drought),
size = 0.4, width = 100, alpha = 0.6) +
theme_bw() +
geom_hline(yintercept = 0, linetype='dashed') +
scale_linetype_manual(values=c("solid", "twodash")) +
scale_color_manual(values=c("#E66100", "#5D3A9B")) +
theme(axis.text.x = element_text(size = 8), axis.text.y = element_text(size = 8), axis.title.x = element_text(size = 10), legend.position = 'none',
axis.title.y = element_text(size = 10), plot.margin = unit(c(0,0,0,0), "pt"), legend.title = element_text(size = 8), legend.text = element_text(size = 6)) +
xlab('Year') + ylab(expression(atop(NA, atop(textstyle('Pr-ET'),textstyle(paste('(mm ',yr^{-1},')')))))) +
annotate("text", x = as.Date('1991-10-01'), y = 1050, label = "Water\nSurplus", size = 2) +
annotate("text", x = as.Date('1991-10-01'), y = 0, label = "Water\nDeficit", size = 2)
#Combine the three time series graphs into one
# (p1 / p2 / p3) + plot_annotation(tag_levels = 'a', tag_suffix = ')',
#                                  theme = theme(legend.margin=margin(t = 0, unit='cm'))) + plot_layout(heights = c(0.95,0.95,1))
f1 <- ggarrange(p1, p2, p3, ncol = 1, nrow = 3, common.legend = FALSE, heights = c(0.9, 0.9,1), align = "v", labels = c('a)', 'b)', 'c)'))
f1
#Save and export the figure as a .png file
ggsave(filename = 'Fig2_drought_time_series.png', height=13, width=11, units = 'cm', dpi=900)
p1 <- ggplot() +
geom_rect(data = data.frame(xmin = as.Date('1998-10-01'), xmax = as.Date('2002-09-30'), ymin = -Inf, ymax = Inf),
fill = "red", alpha = 0.3, mapping = aes(xmin = xmin, xmax = xmax, ymin = ymin, ymax = ymax)) +
geom_rect(data = data.frame(xmin = as.Date('2011-10-01'), xmax = as.Date('2015-09-30'), ymin = -Inf, ymax = Inf),
fill = "red", alpha = 0.3, mapping = aes(xmin = xmin, xmax = xmax, ymin = ymin, ymax = ymax)) +
geom_line(data = time.series, mapping = aes(x = time_start, y = tpa_low_area, color = drought, linetype = drought), size = 0.5, na.rm = TRUE) +
theme_bw() + guides(color = guide_legend(title = 'Drought Sequence', nrow = 2, title.position = 'top'), linetype = "none") +
scale_linetype_manual(values=c("solid", "twodash")) +
geom_hline(yintercept = 0, linetype='dashed') +
scale_color_manual(values=c("#E66100", "#5D3A9B"), labels = c('Both \nDroughts', '2nd Drought \nOnly')) +
theme(axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10), axis.title.x = element_blank(), legend.position = c(0.2, 0.6), legend.background = element_rect(colour = NA, fill = NA),
legend.key = element_rect(fill = NA), axis.text.x = element_blank(), plot.margin = unit(c(0,0,5,-3), "pt"), legend.title = element_text(size = 8), legend.text = element_text(size = 6)) +
ylab(expression(atop(NA, atop(textstyle('Fraction with'),textstyle('Die-off (ADS)')))))
#Create a dNDMI time series
p2 <- ggplot() +
geom_rect(data = data.frame(xmin = as.Date('1998-10-01'), xmax = as.Date('2002-09-30'), ymin = -Inf, ymax = Inf),
fill = "red", alpha = 0.3, mapping = aes(xmin = xmin, xmax = xmax, ymin = ymin, ymax = ymax)) +
geom_rect(data = data.frame(xmin = as.Date('2011-10-01'), xmax = as.Date('2015-09-30'), ymin = -Inf, ymax = Inf),
fill = "red", alpha = 0.3, mapping = aes(xmin = xmin, xmax = xmax, ymin = ymin, ymax = ymax)) +
geom_line(data = time.series, mapping = aes(x = time_start, y = dNDMI_mean, color = drought, linetype = drought), size = 0.5) +
geom_errorbar(data=time.series, mapping=aes(x=time_start, ymin=dNDMI_mean - (dNDMI_stdDev / sqrt(count) * 1.96), ymax=dNDMI_mean + (dNDMI_stdDev / sqrt(count) * 1.96), color = drought, linetype = drought),
size = 0.4, width = 100, alpha = 0.6) +
theme_bw() + geom_hline(yintercept = 0, linetype='dashed') +
scale_linetype_manual(values=c("solid", "twodash")) +
scale_color_manual(values=c("#E66100", "#5D3A9B")) + scale_y_reverse() +
theme(axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10), axis.title.x=element_blank(), legend.position = 'none',
axis.text.x=element_blank(), plot.margin = unit(c(0,0,5,-3), "pt"), legend.title = element_text(size = 8), legend.text = element_text(size = 6)) +
ylab('Die-off\n(dNDMI)') + geom_text(data = data.frame(label = "95% CI", x = as.Date('2018-12-31'), y = -0.019, sequence = 'Both Droughts'), mapping = aes(x=x, y=y, label = label), size = 2) +
annotate("text", x = as.Date('1991-10-01'), y = -0.0375, label = "More\nSevere", size = 2) +
annotate("text", x = as.Date('1991-10-01'), y = 0.0375, label = "Less\nSevere", size = 2)
#Create a Pr-ET time series graph
p3 <- ggplot() +
geom_rect(data = data.frame(xmin = as.Date('1998-10-01'), xmax = as.Date('2002-09-30'), ymin = -Inf, ymax = Inf),
fill = "red", alpha = 0.3, mapping = aes(xmin = xmin, xmax = xmax, ymin = ymin, ymax = ymax)) +
geom_rect(data = data.frame(xmin = as.Date('2011-10-01'), xmax = as.Date('2015-09-30'), ymin = -Inf, ymax = Inf),
fill = "red", alpha = 0.3, mapping = aes(xmin = xmin, xmax = xmax, ymin = ymin, ymax = ymax)) +
geom_line(data = time.series, mapping = aes(x = time_start, y = PET_mean, color = drought, linetype = drought), size = 0.5) +
geom_errorbar(data=time.series, mapping=aes(x=time_start, ymin=PET_mean - (PET_stdDev / sqrt(count) * 1.96), ymax=PET_mean + (PET_stdDev / sqrt(count) * 1.96), color = drought, linetype = drought),
size = 0.4, width = 100, alpha = 0.6) +
theme_bw() +
geom_hline(yintercept = 0, linetype='dashed') +
scale_linetype_manual(values=c("solid", "twodash")) +
scale_color_manual(values=c("#E66100", "#5D3A9B")) +
theme(axis.text.x = element_text(size = 8), axis.text.y = element_text(size = 8), axis.title.x = element_text(size = 10), legend.position = 'none',
axis.title.y = element_text(size = 10), plot.margin = unit(c(0,0,0,-3), "pt"), legend.title = element_text(size = 8), legend.text = element_text(size = 6)) +
xlab('Year') + ylab(expression(atop(NA, atop(textstyle('Pr-ET'),textstyle(paste('(mm ',yr^{-1},')')))))) +
annotate("text", x = as.Date('1991-10-01'), y = 1050, label = "Water\nSurplus", size = 2) +
annotate("text", x = as.Date('1991-10-01'), y = 0, label = "Water\nDeficit", size = 2)
#Combine the three time series graphs into one
# (p1 / p2 / p3) + plot_annotation(tag_levels = 'a', tag_suffix = ')',
#                                  theme = theme(legend.margin=margin(t = 0, unit='cm'))) + plot_layout(heights = c(0.95,0.95,1))
f1 <- ggarrange(p1, p2, p3, ncol = 1, nrow = 3, common.legend = FALSE, heights = c(0.9, 0.9,1), align = "v", labels = c('a)', 'b)', 'c)'))
f1
#Save and export the figure as a .png file
ggsave(filename = 'Fig2_drought_time_series.png', height=13, width=11, units = 'cm', dpi=900)
p1 <- ggplot() +
geom_rect(data = data.frame(xmin = as.Date('1998-10-01'), xmax = as.Date('2002-09-30'), ymin = -Inf, ymax = Inf),
fill = "red", alpha = 0.3, mapping = aes(xmin = xmin, xmax = xmax, ymin = ymin, ymax = ymax)) +
geom_rect(data = data.frame(xmin = as.Date('2011-10-01'), xmax = as.Date('2015-09-30'), ymin = -Inf, ymax = Inf),
fill = "red", alpha = 0.3, mapping = aes(xmin = xmin, xmax = xmax, ymin = ymin, ymax = ymax)) +
geom_line(data = time.series, mapping = aes(x = time_start, y = tpa_low_area, color = drought, linetype = drought), size = 0.5, na.rm = TRUE) +
theme_bw() + guides(color = guide_legend(title = 'Drought Sequence', nrow = 2, title.position = 'top'), linetype = "none") +
scale_linetype_manual(values=c("solid", "twodash")) +
geom_hline(yintercept = 0, linetype='dashed') +
scale_color_manual(values=c("#E66100", "#5D3A9B"), labels = c('Both \nDroughts', '2nd Drought \nOnly')) +
theme(axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10, margin = margin(t=0,b=0,r=0,l=0)), axis.title.x = element_blank(), legend.position = c(0.2, 0.6), legend.background = element_rect(colour = NA, fill = NA),
legend.key = element_rect(fill = NA), axis.text.x = element_blank(), plot.margin = unit(c(0,0,5,0), "pt"), legend.title = element_text(size = 8), legend.text = element_text(size = 6)) +
ylab(expression(atop(NA, atop(textstyle('Fraction with'),textstyle('Die-off (ADS)')))))
#Create a dNDMI time series
p2 <- ggplot() +
geom_rect(data = data.frame(xmin = as.Date('1998-10-01'), xmax = as.Date('2002-09-30'), ymin = -Inf, ymax = Inf),
fill = "red", alpha = 0.3, mapping = aes(xmin = xmin, xmax = xmax, ymin = ymin, ymax = ymax)) +
geom_rect(data = data.frame(xmin = as.Date('2011-10-01'), xmax = as.Date('2015-09-30'), ymin = -Inf, ymax = Inf),
fill = "red", alpha = 0.3, mapping = aes(xmin = xmin, xmax = xmax, ymin = ymin, ymax = ymax)) +
geom_line(data = time.series, mapping = aes(x = time_start, y = dNDMI_mean, color = drought, linetype = drought), size = 0.5) +
geom_errorbar(data=time.series, mapping=aes(x=time_start, ymin=dNDMI_mean - (dNDMI_stdDev / sqrt(count) * 1.96), ymax=dNDMI_mean + (dNDMI_stdDev / sqrt(count) * 1.96), color = drought, linetype = drought),
size = 0.4, width = 100, alpha = 0.6) +
theme_bw() + geom_hline(yintercept = 0, linetype='dashed') +
scale_linetype_manual(values=c("solid", "twodash")) +
scale_color_manual(values=c("#E66100", "#5D3A9B")) + scale_y_reverse() +
theme(axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10, margin = margin(t=0,b=0,r=0,l=0)), axis.title.x=element_blank(), legend.position = 'none',
axis.text.x=element_blank(), plot.margin = unit(c(0,0,5,0), "pt"), legend.title = element_text(size = 8), legend.text = element_text(size = 6)) +
ylab('Die-off\n(dNDMI)') + geom_text(data = data.frame(label = "95% CI", x = as.Date('2018-12-31'), y = -0.019, sequence = 'Both Droughts'), mapping = aes(x=x, y=y, label = label), size = 2) +
annotate("text", x = as.Date('1991-10-01'), y = -0.0375, label = "More\nSevere", size = 2) +
annotate("text", x = as.Date('1991-10-01'), y = 0.0375, label = "Less\nSevere", size = 2)
#Create a Pr-ET time series graph
p3 <- ggplot() +
geom_rect(data = data.frame(xmin = as.Date('1998-10-01'), xmax = as.Date('2002-09-30'), ymin = -Inf, ymax = Inf),
fill = "red", alpha = 0.3, mapping = aes(xmin = xmin, xmax = xmax, ymin = ymin, ymax = ymax)) +
geom_rect(data = data.frame(xmin = as.Date('2011-10-01'), xmax = as.Date('2015-09-30'), ymin = -Inf, ymax = Inf),
fill = "red", alpha = 0.3, mapping = aes(xmin = xmin, xmax = xmax, ymin = ymin, ymax = ymax)) +
geom_line(data = time.series, mapping = aes(x = time_start, y = PET_mean, color = drought, linetype = drought), size = 0.5) +
geom_errorbar(data=time.series, mapping=aes(x=time_start, ymin=PET_mean - (PET_stdDev / sqrt(count) * 1.96), ymax=PET_mean + (PET_stdDev / sqrt(count) * 1.96), color = drought, linetype = drought),
size = 0.4, width = 100, alpha = 0.6) +
theme_bw() +
geom_hline(yintercept = 0, linetype='dashed') +
scale_linetype_manual(values=c("solid", "twodash")) +
scale_color_manual(values=c("#E66100", "#5D3A9B")) +
theme(axis.text.x = element_text(size = 8), axis.text.y = element_text(size = 8), axis.title.x = element_text(size = 10), legend.position = 'none',
axis.title.y = element_text(size = 10, margin = margin(t=0,b=0,r=0,l=0)), plot.margin = unit(c(0,0,0,0), "pt"), legend.title = element_text(size = 8), legend.text = element_text(size = 6)) +
xlab('Year') + ylab(expression(atop(NA, atop(textstyle('Pr-ET'),textstyle(paste('(mm ',yr^{-1},')')))))) +
annotate("text", x = as.Date('1991-10-01'), y = 1050, label = "Water\nSurplus", size = 2) +
annotate("text", x = as.Date('1991-10-01'), y = 0, label = "Water\nDeficit", size = 2)
#Combine the three time series graphs into one
# (p1 / p2 / p3) + plot_annotation(tag_levels = 'a', tag_suffix = ')',
#                                  theme = theme(legend.margin=margin(t = 0, unit='cm'))) + plot_layout(heights = c(0.95,0.95,1))
f1 <- ggarrange(p1, p2, p3, ncol = 1, nrow = 3, common.legend = FALSE, heights = c(0.9, 0.9,1), align = "v", labels = c('a)', 'b)', 'c)'))
f1
#Save and export the figure as a .png file
ggsave(filename = 'Fig2_drought_time_series.png', height=13, width=11, units = 'cm', dpi=900)
all.ca.spi48$both <- '1st Response'#'1999-2002'
all.ca.spi48$second <- '2nd Response'#'2012-2015'
#Plot dNDMI 2004 with SPI48 2002 by SPI48 2015 grid
p1 <- ggplot(subset(all.ca.spi48, count >= 20), mapping = aes(x = spi48_09_2002, y = spi48_09_2015, fill = dNDMI_2004.mean, group = dNDMI_2004.mean)) +
geom_bin2d(mapping = aes(group = dNDMI_2004.mean), binwidth = c(0.1, 0.1)) + theme_bw() +
ylim(-3.5, 0) + xlim(-3, 2) +
ylab(NULL) +  xlab('1st Drought\n(SPI48 1999-2002)') +
# geom_vline(xintercept = 0, size = 0.25) +
# geom_hline(yintercept = 0, size = 0.25) +
geom_vline(xintercept = -1.5, size = 0.5, color = 'black', linetype='dashed') +
geom_hline(yintercept = -1.5, size = 0.5, color = 'black', linetype='dashed') +
guides(fill = guide_colorbar(barwidth = 5, barheight = 1, title.position = "top", title.hjust = 0.5, ticks.colour = "black", reverse = T), alpha = "none") +
theme(axis.text.x = element_text(size = 8), axis.text.y = element_text(size = 8), axis.title.x = element_text(size = 10),
axis.title.y = element_text(size = 10), plot.title = element_text(size = 10, hjust = 0.5), legend.background = element_rect(colour = NA, fill = NA),
legend.justification = c(1, 0), legend.position = c(0.91, 0.65), legend.text = element_text(size = 6),
legend.title = element_text(size = 8), legend.direction = "horizontal", strip.text = element_text(size = 10)) +
scale_fill_gradient2(name = "Die-off (dNDMI)", limits = c(-0.16, 0.07), midpoint = 0, low = "#D41159", mid = "lightyellow1", high = "#1A85FF") +
facet_wrap(~ both) +
annotate(geom="text", x=-1.15, y=-0.5, label="Less\nSevere", color="black", size = 1.5) +
annotate(geom="text", x=1.9, y=-0.5, label="More\nSevere", color="black", size = 1.5) +
annotate(geom="text", x = -2.5, y = -3.2, label="Less\nPrecipitation", size = 2) +
annotate(geom="text", x = -2.5, y = -0.25, label ="More\nPrecipitation", size = 2)
#Plot dNDMI 2017 with SPI48 2002 by SPI48 2015 grid
p2 <-ggplot(subset(all.ca.spi48, count >= 20), mapping = aes(x = spi48_09_2002, y = spi48_09_2015, fill = dNDMI_2017.mean, group = dNDMI_2017.mean)) +
geom_bin2d(mapping = aes(group = dNDMI_2017.mean), binwidth = c(0.1, 0.1)) + theme_bw() +
ylim(-3.5, 0) + xlim(-3, 2) +
ylab(NULL) +  xlab('1st Drought\n(SPI48 1999-2002)') +
# geom_vline(xintercept = 0, size = 0.25) +
# geom_hline(yintercept = 0, size = 0.25) +
geom_vline(xintercept = -1.5, size = 0.5, color = 'black', linetype='dashed') +
geom_hline(yintercept = -1.5, size = 0.5, color = 'black', linetype='dashed') +
guides(fill = "none", alpha = "none") +
theme(axis.text.x = element_text(size = 8), axis.text.y = element_text(size = 8), axis.title.x = element_text(size = 10),
axis.title.y = element_text(size = 10), strip.text = element_text(size = 10)) +
scale_fill_gradient2(name = "Die-off (dNDMI)", limits = c(-0.16, 0.07), midpoint = 0, low = "#D41159", mid = "lightyellow1", high = "#1A85FF") +
annotate("text", x = -0.25, y = -0.75, label = "Neither \nDrought", size = 3) + annotate("text", x = -2.4, y = -0.5, label = "1st Drought \nOnly", size = 3) +
annotate("text", x = -2.4, y = -3, label = "Both \nDroughts", size = 3) + annotate("text", x = 1, y = -2, label = "2nd Drought \nOnly", size = 3) +
facet_wrap( ~ second)
#Combine the two figure panels into one
f1 <- ggarrange(p1, p2, ncol = 2, nrow = 1, widths = c(1, 0.95), common.legend = FALSE)
#Add shared Y label and x-label
annotate_figure(f1, left = textGrob(label = "2nd Drought\n(SPI48 2012-2015)", rot = 90, hjust = 0.25, vjust = 0.5,
gp = gpar(col = "black", fontsize = 10)))#,
# bottom = textGrob(label = '1st Drought Severity \n(SPI48 1999-2002)', vjust = 0.2, hjust = 0.5))
#Save the figure as a png
ggsave(filename = 'Fig3_spi48_dNDMI_SPI48_grid_scatter.png', device = 'png', height=7, width=14, units = 'cm', dpi=900)
p1 <- ggplot(subset(all.ca.spi48, count >= 20), mapping = aes(x = spi48_09_2002, y = spi48_09_2015, fill = dNDMI_2004.mean, group = dNDMI_2004.mean)) +
geom_bin2d(mapping = aes(group = dNDMI_2004.mean), binwidth = c(0.1, 0.1)) + theme_bw() +
ylim(-3.5, 0) + xlim(-3, 2) +
ylab(NULL) +  xlab('1st Drought\n(SPI48 1999-2002)') +
# geom_vline(xintercept = 0, size = 0.25) +
# geom_hline(yintercept = 0, size = 0.25) +
geom_vline(xintercept = -1.5, size = 0.5, color = 'black', linetype='dashed') +
geom_hline(yintercept = -1.5, size = 0.5, color = 'black', linetype='dashed') +
guides(fill = guide_colorbar(barwidth = 5, barheight = 1, title.position = "top", title.hjust = 0.5, ticks.colour = "black", reverse = T), alpha = "none") +
theme(axis.text.x = element_text(size = 8), axis.text.y = element_text(size = 8), axis.title.x = element_text(size = 10),
axis.title.y = element_text(size = 10), plot.title = element_text(size = 10, hjust = 0.5), legend.background = element_rect(colour = NA, fill = NA),
legend.justification = c(1, 0), legend.position = c(0.91, 0.65), legend.text = element_text(size = 6),
legend.title = element_text(size = 8), legend.direction = "horizontal", strip.text = element_text(size = 10)) +
scale_fill_gradient2(name = "Die-off (dNDMI)", limits = c(-0.16, 0.07), midpoint = 0, low = "#D41159", mid = "lightyellow1", high = "#1A85FF") +
facet_wrap(~ both) +
annotate(geom="text", x=-1.15, y=-0.5, label="Less\nSevere", color="black", size = 1.5) +
annotate(geom="text", x=1.9, y=-0.5, label="More\nSevere", color="black", size = 1.5) +
annotate(geom="text", x = -2.5, y = -3.2, label="Less\nPrecipitation", size = 2) +
annotate(geom="text", x = -2.5, y = -0.25, label ="More\nPrecipitation", size = 2)
#Plot dNDMI 2017 with SPI48 2002 by SPI48 2015 grid
p2 <-ggplot(subset(all.ca.spi48, count >= 20), mapping = aes(x = spi48_09_2002, y = spi48_09_2015, fill = dNDMI_2017.mean, group = dNDMI_2017.mean)) +
geom_bin2d(mapping = aes(group = dNDMI_2017.mean), binwidth = c(0.1, 0.1)) + theme_bw() +
ylim(-3.5, 0) + xlim(-3, 2) +
ylab(NULL) +  xlab('1st Drought\n(SPI48 1999-2002)') +
# geom_vline(xintercept = 0, size = 0.25) +
# geom_hline(yintercept = 0, size = 0.25) +
geom_vline(xintercept = -1.5, size = 0.5, color = 'black', linetype='dashed') +
geom_hline(yintercept = -1.5, size = 0.5, color = 'black', linetype='dashed') +
guides(fill = "none", alpha = "none") +
theme(axis.text.x = element_text(size = 8), axis.text.y = element_blank(), axis.title.x = element_text(size = 10),
axis.title.y = element_blank(), strip.text = element_text(size = 10)) +
scale_fill_gradient2(name = "Die-off (dNDMI)", limits = c(-0.16, 0.07), midpoint = 0, low = "#D41159", mid = "lightyellow1", high = "#1A85FF") +
annotate("text", x = -0.25, y = -0.75, label = "Neither \nDrought", size = 3) + annotate("text", x = -2.4, y = -0.5, label = "1st Drought \nOnly", size = 3) +
annotate("text", x = -2.4, y = -3, label = "Both \nDroughts", size = 3) + annotate("text", x = 1, y = -2, label = "2nd Drought \nOnly", size = 3) +
facet_wrap( ~ second)
#Combine the two figure panels into one
f1 <- ggarrange(p1, p2, ncol = 2, nrow = 1, widths = c(1, 0.95), common.legend = FALSE)
#Add shared Y label and x-label
annotate_figure(f1, left = textGrob(label = expression(atop(NA,atop("2nd Drought", "(SPI48 2012-2015)"))), rot = 90, hjust = 0.25, vjust = 0.5,
gp = gpar(col = "black", fontsize = 10)))#,
# bottom = textGrob(label = '1st Drought Severity \n(SPI48 1999-2002)', vjust = 0.2, hjust = 0.5))
#Save the figure as a png
ggsave(filename = 'Fig3_spi48_dNDMI_SPI48_grid_scatter.png', device = 'png', height=7, width=14, units = 'cm', dpi=900)
annotate_figure(f1, left = textGrob(label = expression(atop(NA,atop(textstyle("2nd Drought"), textstyle("(SPI48 2012-2015)")))), rot = 90, hjust = 0.25, vjust = 0.1,
gp = gpar(col = "black", fontsize = 10)))#,
# bottom = textGrob(label = '1st Drought Severity \n(SPI48 1999-2002)', vjust = 0.2, hjust = 0.5))
#Save the figure as a png
ggsave(filename = 'Fig3_spi48_dNDMI_SPI48_grid_scatter.png', device = 'png', height=7, width=14, units = 'cm', dpi=900)
annotate_figure(f1, left = textGrob(label = expression(atop(NA,atop(textstyle("2nd Drought"), textstyle("(SPI48 2012-2015)")))), rot = 90, hjust = 0.25, vjust = 0.8,
gp = gpar(col = "black", fontsize = 10)))#,
# bottom = textGrob(label = '1st Drought Severity \n(SPI48 1999-2002)', vjust = 0.2, hjust = 0.5))
#Save the figure as a png
ggsave(filename = 'Fig3_spi48_dNDMI_SPI48_grid_scatter.png', device = 'png', height=7, width=14, units = 'cm', dpi=900)
p1 <- ggplot(subset(all.ca.spi48, count >= 20), mapping = aes(x = spi48_09_2002, y = spi48_09_2015, fill = dNDMI_2004.mean, group = dNDMI_2004.mean)) +
geom_bin2d(mapping = aes(group = dNDMI_2004.mean), binwidth = c(0.1, 0.1)) + theme_bw() +
ylim(-3.5, 0) + xlim(-3, 2) +
ylab(expression(atop(NA,atop(textstyle("2nd Drought"), textstyle("(SPI48 2012-2015)"))))) +  xlab('1st Drought\n(SPI48 1999-2002)') +
# geom_vline(xintercept = 0, size = 0.25) +
# geom_hline(yintercept = 0, size = 0.25) +
geom_vline(xintercept = -1.5, size = 0.5, color = 'black', linetype='dashed') +
geom_hline(yintercept = -1.5, size = 0.5, color = 'black', linetype='dashed') +
guides(fill = guide_colorbar(barwidth = 5, barheight = 1, title.position = "top", title.hjust = 0.5, ticks.colour = "black", reverse = T), alpha = "none") +
theme(axis.text.x = element_text(size = 8), axis.text.y = element_text(size = 8), axis.title.x = element_text(size = 10),
axis.title.y = element_text(size = 10), plot.title = element_text(size = 10, hjust = 0.5), legend.background = element_rect(colour = NA, fill = NA),
legend.justification = c(1, 0), legend.position = c(0.93, 0.65), legend.text = element_text(size = 6),
legend.title = element_text(size = 8), legend.direction = "horizontal", strip.text = element_text(size = 10)) +
scale_fill_gradient2(name = "Die-off (dNDMI)", limits = c(-0.16, 0.07), midpoint = 0, low = "#D41159", mid = "lightyellow1", high = "#1A85FF") +
facet_wrap(~ both) +
annotate(geom="text", x=-1.15, y=-0.5, label="Less\nSevere", color="black", size = 1.5) +
annotate(geom="text", x=1.9, y=-0.5, label="More\nSevere", color="black", size = 1.5) +
annotate(geom="text", x = -2.5, y = -3.2, label="Less\nPrecipitation", size = 2) +
annotate(geom="text", x = -2.5, y = -0.25, label ="More\nPrecipitation", size = 2)
#Plot dNDMI 2017 with SPI48 2002 by SPI48 2015 grid
p2 <-ggplot(subset(all.ca.spi48, count >= 20), mapping = aes(x = spi48_09_2002, y = spi48_09_2015, fill = dNDMI_2017.mean, group = dNDMI_2017.mean)) +
geom_bin2d(mapping = aes(group = dNDMI_2017.mean), binwidth = c(0.1, 0.1)) + theme_bw() +
ylim(-3.5, 0) + xlim(-3, 2) +
ylab(NULL) +  xlab('1st Drought\n(SPI48 1999-2002)') +
# geom_vline(xintercept = 0, size = 0.25) +
# geom_hline(yintercept = 0, size = 0.25) +
geom_vline(xintercept = -1.5, size = 0.5, color = 'black', linetype='dashed') +
geom_hline(yintercept = -1.5, size = 0.5, color = 'black', linetype='dashed') +
guides(fill = "none", alpha = "none") +
theme(axis.text.x = element_text(size = 8), axis.text.y = element_blank(), axis.title.x = element_text(size = 10),
axis.title.y = element_blank(), strip.text = element_text(size = 10)) +
scale_fill_gradient2(name = "Die-off (dNDMI)", limits = c(-0.16, 0.07), midpoint = 0, low = "#D41159", mid = "lightyellow1", high = "#1A85FF") +
annotate("text", x = -0.25, y = -0.75, label = "Neither \nDrought", size = 3) + annotate("text", x = -2.4, y = -0.5, label = "1st Drought \nOnly", size = 3) +
annotate("text", x = -2.4, y = -3, label = "Both \nDroughts", size = 3) + annotate("text", x = 1, y = -2, label = "2nd Drought \nOnly", size = 3) +
facet_wrap( ~ second)
#Combine the two figure panels into one
f1 <- ggarrange(p1, p2, ncol = 2, nrow = 1, widths = c(1, 0.95), labels = c('a)', 'b)'), common.legend = FALSE)
#Add shared Y label and x-label
# annotate_figure(f1, left = textGrob(label = expression(atop(NA,atop(textstyle("2nd Drought"), textstyle("(SPI48 2012-2015)")))), rot = 90, hjust = 0.25, vjust = 0.8,
#                                     gp = gpar(col = "black", fontsize = 10)))#,
# bottom = textGrob(label = '1st Drought Severity \n(SPI48 1999-2002)', vjust = 0.2, hjust = 0.5))
#Save the figure as a png
ggsave(filename = 'Fig3_spi48_dNDMI_SPI48_grid_scatter.png', device = 'png', height=7, width=14, units = 'cm', dpi=900)
#Save the figure as a png
ggsave(filename = 'Fig3_spi48_dNDMI_SPI48_grid_scatter.png', device = 'png', height=7, width=16, units = 'cm', dpi=900)
#Save the figure as a png
ggsave(filename = 'Fig3_spi48_dNDMI_SPI48_grid_scatter.png', device = 'png', height=7, width=15, units = 'cm', dpi=900)
p2 <-ggplot(subset(all.ca.spi48, count >= 20), mapping = aes(x = spi48_09_2002, y = spi48_09_2015, fill = dNDMI_2017.mean, group = dNDMI_2017.mean)) +
geom_bin2d(mapping = aes(group = dNDMI_2017.mean), binwidth = c(0.1, 0.1)) + theme_bw() +
ylim(-3.5, 0) + xlim(-3, 2) +
ylab(NULL) +  xlab('1st Drought\n(SPI48 1999-2002)') +
# geom_vline(xintercept = 0, size = 0.25) +
# geom_hline(yintercept = 0, size = 0.25) +
geom_vline(xintercept = -1.5, size = 0.5, color = 'black', linetype='dashed') +
geom_hline(yintercept = -1.5, size = 0.5, color = 'black', linetype='dashed') +
guides(fill = "none", alpha = "none") +
theme(axis.text.x = element_text(size = 8), axis.text.y = element_blank(), axis.title.x = element_text(size = 10),
axis.title.y = element_blank(), strip.text = element_text(size = 10), plot.margin = unit(c(0,0,0,5), "pt")) +
scale_fill_gradient2(name = "Die-off (dNDMI)", limits = c(-0.16, 0.07), midpoint = 0, low = "#D41159", mid = "lightyellow1", high = "#1A85FF") +
annotate("text", x = -0.25, y = -0.75, label = "Neither \nDrought", size = 3) + annotate("text", x = -2.4, y = -0.5, label = "1st Drought \nOnly", size = 3) +
annotate("text", x = -2.4, y = -3, label = "Both \nDroughts", size = 3) + annotate("text", x = 1, y = -2, label = "2nd Drought \nOnly", size = 3) +
facet_wrap( ~ second)
#Combine the two figure panels into one
f1 <- ggarrange(p1, p2, ncol = 2, nrow = 1, widths = c(1, 0.9), labels = c('a)', 'b)'), common.legend = FALSE)
#Add shared Y label and x-label
# annotate_figure(f1, left = textGrob(label = expression(atop(NA,atop(textstyle("2nd Drought"), textstyle("(SPI48 2012-2015)")))), rot = 90, hjust = 0.25, vjust = 0.8,
#                                     gp = gpar(col = "black", fontsize = 10)))#,
# bottom = textGrob(label = '1st Drought Severity \n(SPI48 1999-2002)', vjust = 0.2, hjust = 0.5))
#Save the figure as a png
ggsave(filename = 'Fig3_spi48_dNDMI_SPI48_grid_scatter.png', device = 'png', height=7, width=15, units = 'cm', dpi=900)
p1 <- ggplot(subset(all.ca.spi48, count >= 20), mapping = aes(x = spi48_09_2002, y = spi48_09_2015, fill = dNDMI_2004.mean, group = dNDMI_2004.mean)) +
geom_bin2d(mapping = aes(group = dNDMI_2004.mean), binwidth = c(0.1, 0.1)) + theme_bw() +
ylim(-3.5, 0) + xlim(-3, 2) +
ylab(expression(atop(NA,atop(textstyle("2nd Drought"), textstyle("(SPI48 2012-2015)"))))) +  xlab('1st Drought\n(SPI48 1999-2002)') +
# geom_vline(xintercept = 0, size = 0.25) +
# geom_hline(yintercept = 0, size = 0.25) +
geom_vline(xintercept = -1.5, size = 0.5, color = 'black', linetype='dashed') +
geom_hline(yintercept = -1.5, size = 0.5, color = 'black', linetype='dashed') +
guides(fill = guide_colorbar(barwidth = 5, barheight = 1, title.position = "top", title.hjust = 0.5, ticks.colour = "black", reverse = T), alpha = "none") +
theme(axis.text.x = element_text(size = 8), axis.text.y = element_text(size = 8), axis.title.x = element_text(size = 10),
axis.title.y = element_text(size = 10), plot.title = element_text(size = 10, hjust = 0.5), legend.background = element_rect(colour = NA, fill = NA),
legend.justification = c(1, 0), legend.position = c(0.93, 0.65), legend.text = element_text(size = 6),
legend.title = element_text(size = 8), legend.direction = "horizontal", strip.text = element_text(size = 10),
plot.margin = unit(c(0,0,0,0), "pt")) +
scale_fill_gradient2(name = "Die-off (dNDMI)", limits = c(-0.16, 0.07), midpoint = 0, low = "#D41159", mid = "lightyellow1", high = "#1A85FF") +
facet_wrap(~ both) +
annotate(geom="text", x=-1.15, y=-0.5, label="Less\nSevere", color="black", size = 1.5) +
annotate(geom="text", x=1.9, y=-0.5, label="More\nSevere", color="black", size = 1.5) +
annotate(geom="text", x = -2.5, y = -3.2, label="Less\nPrecipitation", size = 2) +
annotate(geom="text", x = -2.5, y = -0.25, label ="More\nPrecipitation", size = 2)
#Plot dNDMI 2017 with SPI48 2002 by SPI48 2015 grid
p2 <-ggplot(subset(all.ca.spi48, count >= 20), mapping = aes(x = spi48_09_2002, y = spi48_09_2015, fill = dNDMI_2017.mean, group = dNDMI_2017.mean)) +
geom_bin2d(mapping = aes(group = dNDMI_2017.mean), binwidth = c(0.1, 0.1)) + theme_bw() +
ylim(-3.5, 0) + xlim(-3, 2) +
ylab(NULL) +  xlab('1st Drought\n(SPI48 1999-2002)') +
# geom_vline(xintercept = 0, size = 0.25) +
# geom_hline(yintercept = 0, size = 0.25) +
geom_vline(xintercept = -1.5, size = 0.5, color = 'black', linetype='dashed') +
geom_hline(yintercept = -1.5, size = 0.5, color = 'black', linetype='dashed') +
guides(fill = "none", alpha = "none") +
theme(axis.text.x = element_text(size = 8), axis.text.y = element_blank(), axis.title.x = element_text(size = 10),
axis.title.y = element_blank(), strip.text = element_text(size = 10), plot.margin = unit(c(0,0,0,5), "pt")) +
scale_fill_gradient2(name = "Die-off (dNDMI)", limits = c(-0.16, 0.07), midpoint = 0, low = "#D41159", mid = "lightyellow1", high = "#1A85FF") +
annotate("text", x = -0.25, y = -0.75, label = "Neither \nDrought", size = 3) + annotate("text", x = -2.4, y = -0.5, label = "1st Drought \nOnly", size = 3) +
annotate("text", x = -2.4, y = -3, label = "Both \nDroughts", size = 3) + annotate("text", x = 1, y = -2, label = "2nd Drought \nOnly", size = 3) +
facet_wrap( ~ second)
#Combine the two figure panels into one
f1 <- ggarrange(p1, p2, ncol = 2, nrow = 1, widths = c(1, 0.9), labels = c('a)', 'b)'), align = 'h', common.legend = FALSE)
#Add shared Y label and x-label
# annotate_figure(f1, left = textGrob(label = expression(atop(NA,atop(textstyle("2nd Drought"), textstyle("(SPI48 2012-2015)")))), rot = 90, hjust = 0.25, vjust = 0.8,
#                                     gp = gpar(col = "black", fontsize = 10)))#,
# bottom = textGrob(label = '1st Drought Severity \n(SPI48 1999-2002)', vjust = 0.2, hjust = 0.5))
#Save the figure as a png
ggsave(filename = 'Fig3_spi48_dNDMI_SPI48_grid_scatter.png', device = 'png', height=7, width=15, units = 'cm', dpi=900)
p2 <-ggplot(subset(all.ca.spi48, count >= 20), mapping = aes(x = spi48_09_2002, y = spi48_09_2015, fill = dNDMI_2017.mean, group = dNDMI_2017.mean)) +
geom_bin2d(mapping = aes(group = dNDMI_2017.mean), binwidth = c(0.1, 0.1)) + theme_bw() +
ylim(-3.5, 0) + xlim(-3, 2) +
ylab(NULL) +  xlab('1st Drought\n(SPI48 1999-2002)') +
# geom_vline(xintercept = 0, size = 0.25) +
# geom_hline(yintercept = 0, size = 0.25) +
geom_vline(xintercept = -1.5, size = 0.5, color = 'black', linetype='dashed') +
geom_hline(yintercept = -1.5, size = 0.5, color = 'black', linetype='dashed') +
guides(fill = "none", alpha = "none") +
theme(axis.text.x = element_text(size = 8), axis.text.y = element_blank(), axis.title.x = element_text(size = 10),
axis.title.y = element_blank(), strip.text = element_text(size = 10), plot.margin = unit(c(0,0,0,10), "pt")) +
scale_fill_gradient2(name = "Die-off (dNDMI)", limits = c(-0.16, 0.07), midpoint = 0, low = "#D41159", mid = "lightyellow1", high = "#1A85FF") +
annotate("text", x = -0.25, y = -0.75, label = "Neither \nDrought", size = 3) + annotate("text", x = -2.4, y = -0.5, label = "1st Drought \nOnly", size = 3) +
annotate("text", x = -2.4, y = -3, label = "Both \nDroughts", size = 3) + annotate("text", x = 1, y = -2, label = "2nd Drought \nOnly", size = 3) +
facet_wrap( ~ second)
#Combine the two figure panels into one
f1 <- ggarrange(p1, p2, ncol = 2, nrow = 1, widths = c(1, 0.9), labels = c('a)', 'b)'), align = 'h', common.legend = FALSE)
f1
#Save the figure as a png
ggsave(filename = 'Fig3_spi48_dNDMI_SPI48_grid_scatter.png', device = 'png', height=7, width=15, units = 'cm', dpi=900)
p2 <-ggplot(subset(all.ca.spi48, count >= 20), mapping = aes(x = spi48_09_2002, y = spi48_09_2015, fill = dNDMI_2017.mean, group = dNDMI_2017.mean)) +
geom_bin2d(mapping = aes(group = dNDMI_2017.mean), binwidth = c(0.1, 0.1)) + theme_bw() +
ylim(-3.5, 0) + xlim(-3, 2) +
ylab(NULL) +  xlab('1st Drought\n(SPI48 1999-2002)') +
# geom_vline(xintercept = 0, size = 0.25) +
# geom_hline(yintercept = 0, size = 0.25) +
geom_vline(xintercept = -1.5, size = 0.5, color = 'black', linetype='dashed') +
geom_hline(yintercept = -1.5, size = 0.5, color = 'black', linetype='dashed') +
guides(fill = "none", alpha = "none") +
theme(axis.text.x = element_text(size = 8), axis.text.y = element_blank(), axis.title.x = element_text(size = 10),
axis.title.y = element_blank(), strip.text = element_text(size = 10), plot.margin = unit(c(0,0,0,20), "pt")) +
scale_fill_gradient2(name = "Die-off (dNDMI)", limits = c(-0.16, 0.07), midpoint = 0, low = "#D41159", mid = "lightyellow1", high = "#1A85FF") +
annotate("text", x = -0.25, y = -0.75, label = "Neither \nDrought", size = 3) + annotate("text", x = -2.4, y = -0.5, label = "1st Drought \nOnly", size = 3) +
annotate("text", x = -2.4, y = -3, label = "Both \nDroughts", size = 3) + annotate("text", x = 1, y = -2, label = "2nd Drought \nOnly", size = 3) +
facet_wrap( ~ second)
#Combine the two figure panels into one
f1 <- ggarrange(p1, p2, ncol = 2, nrow = 1, widths = c(1, 0.9), labels = c('a)', 'b)'), align = 'h', common.legend = FALSE)
f1
#Save the figure as a png
#Save the figure as a png
ggsave(filename = 'Fig3_spi48_dNDMI_SPI48_grid_scatter.png', device = 'png', height=7, width=15, units = 'cm', dpi=900)
p1 <- ggplot(subset(all.ca.spi48, count >= 20), mapping = aes(x = spi48_09_2002, y = spi48_09_2015, fill = dNDMI_2004.mean, group = dNDMI_2004.mean)) +
geom_bin2d(mapping = aes(group = dNDMI_2004.mean), binwidth = c(0.1, 0.1)) + theme_bw() +
ylim(-3.5, 0) + xlim(-3, 2) +
ylab(expression(atop(NA,atop(textstyle("2nd Drought Severity"), textstyle("(SPI48 2012-2015)"))))) +  xlab('1st Drought Severity\n(SPI48 1999-2002)') +
# geom_vline(xintercept = 0, size = 0.25) +
# geom_hline(yintercept = 0, size = 0.25) +
geom_vline(xintercept = -1.5, size = 0.5, color = 'black', linetype='dashed') +
geom_hline(yintercept = -1.5, size = 0.5, color = 'black', linetype='dashed') +
guides(fill = guide_colorbar(barwidth = 5, barheight = 1, title.position = "top", title.hjust = 0.5, ticks.colour = "black", reverse = T), alpha = "none") +
theme(axis.text.x = element_text(size = 8), axis.text.y = element_text(size = 8), axis.title.x = element_text(size = 10),
axis.title.y = element_text(size = 10), plot.title = element_text(size = 10, hjust = 0.5), legend.background = element_rect(colour = NA, fill = NA),
legend.justification = c(1, 0), legend.position = c(0.93, 0.65), legend.text = element_text(size = 6),
legend.title = element_text(size = 8), legend.direction = "horizontal", strip.text = element_text(size = 10),
plot.margin = unit(c(0,0,0,0), "pt")) +
scale_fill_gradient2(name = "Die-off (dNDMI)", limits = c(-0.16, 0.07), midpoint = 0, low = "#D41159", mid = "lightyellow1", high = "#1A85FF") +
facet_wrap(~ both) +
annotate(geom="text", x=-1.15, y=-0.5, label="Less\nSevere", color="black", size = 1.5) +
annotate(geom="text", x=1.9, y=-0.5, label="More\nSevere", color="black", size = 1.5) +
annotate(geom="text", x = -2.5, y = -3.2, label="Less\nPrecipitation", size = 2) +
annotate(geom="text", x = -2.5, y = -0.25, label ="More\nPrecipitation", size = 2)
#Plot dNDMI 2017 with SPI48 2002 by SPI48 2015 grid
p2 <-ggplot(subset(all.ca.spi48, count >= 20), mapping = aes(x = spi48_09_2002, y = spi48_09_2015, fill = dNDMI_2017.mean, group = dNDMI_2017.mean)) +
geom_bin2d(mapping = aes(group = dNDMI_2017.mean), binwidth = c(0.1, 0.1)) + theme_bw() +
ylim(-3.5, 0) + xlim(-3, 2) +
ylab(NULL) +  xlab('1st Drought Severity\n(SPI48 1999-2002)') +
# geom_vline(xintercept = 0, size = 0.25) +
# geom_hline(yintercept = 0, size = 0.25) +
geom_vline(xintercept = -1.5, size = 0.5, color = 'black', linetype='dashed') +
geom_hline(yintercept = -1.5, size = 0.5, color = 'black', linetype='dashed') +
guides(fill = "none", alpha = "none") +
theme(axis.text.x = element_text(size = 8), axis.text.y = element_blank(), axis.title.x = element_text(size = 10),
axis.title.y = element_blank(), strip.text = element_text(size = 10), plot.margin = unit(c(0,0,0,20), "pt")) +
scale_fill_gradient2(name = "Die-off (dNDMI)", limits = c(-0.16, 0.07), midpoint = 0, low = "#D41159", mid = "lightyellow1", high = "#1A85FF") +
annotate("text", x = -0.25, y = -0.75, label = "Neither \nDrought", size = 3) + annotate("text", x = -2.4, y = -0.5, label = "1st Drought \nOnly", size = 3) +
annotate("text", x = -2.4, y = -3, label = "Both \nDroughts", size = 3) + annotate("text", x = 1, y = -2, label = "2nd Drought \nOnly", size = 3) +
facet_wrap( ~ second)
#Combine the two figure panels into one
f1 <- ggarrange(p1, p2, ncol = 2, nrow = 1, widths = c(1, 0.9), labels = c('a)', 'b)'), align = 'h', common.legend = FALSE)
f1
#Save the figure as a png
ggsave(filename = 'Fig3_spi48_dNDMI_SPI48_grid_scatter.png', device = 'png', height=7, width=15, units = 'cm', dpi=900)
