ggsave(filename = 'SFig6_basal_area_boxplot.png', height=14, width=16, units = 'cm', dpi=900)
p3 <- ggbarplot(all.forest %>% group_by(time.period, sequence, pltID) %>% summarize(BAA.all.sum = sum(BAA.all), BAA.live = sum(BAA), BAA.dead.sum = sum(BAA.dead), BAA.mort = sum(BAA.dead) / sum(BAA.all) * 100), #%>% filter(COMMON_NAME %in% sp.both.2002[! sp.both.2002 %in% c('curlleaf mountain-mahogany', 'California live oak')]), #, (sequence == 'Both Droughts' & drought == '1999-2002') | (sequence == '2012-2015 Only' & drought == '2012-2015')),
x = "time.period", y = "BAA.all.sum", position = position_dodge(), color = "sequence", fill = 'gray',
add = "mean_se" , error.plot = "errorbar", alpha = 0.8, ylab = expression('Basal Area (m'^2*' ha'^-1*')')) +
theme_bw() + guides(color = 'none', fill = 'none') +
scale_color_manual(values = c("black", "black"), aesthetics = "color") +
theme(legend.background = element_rect(colour = NA, fill = NA), legend.justification = c(1, 0),
legend.position = c(0.76, 0.15), legend.text = element_text(size = 6), legend.title = element_text(size = 8),
legend.direction = "vertical", axis.text.x = element_blank(), axis.title.x = element_blank(),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10)) +
# geom_text(data = p1_texta, mapping = aes(x = x, y = y, label = label), size = 5) +
# geom_text(data = p1_textb, mapping = aes(x = x, y = y, label = label), size = 3) +
geom_text(data = data.frame(label = "Mean \n+/- SE", y = 20.2, x = 1.2, sequence = 'Both Droughts'), mapping = aes(x=x, y=y, label = label), size = 2) +
facet_grid(~ factor(sequence, levels = c('Both Droughts', '2nd Drought Only')))
p3
#Total Basal Area
p4 <- ggbarplot(all.forest.type %>% filter(tree_type != 'other conifer' & tree_type != 'deciduous'),
x = "time.period", y = "BAA.all.sum", position = position_dodge(), fill = 'tree_type.f', color = "sequence",
add = "mean_se" , error.plot = "errorbar", alpha = 0.8, ylab = expression('Basal Area (m'^2*' ha'^-1*')'),
xlab = "Time Period") +
theme_bw() + guides(color = 'none', fill = guide_legend(title = "Tree Type", ncol = 1)) +
scale_color_manual(values = c("black", "black"), aesthetics = "color") +
scale_fill_discrete(labels = c("pine" = "Pine", "fir" = "Fir", "juniper" = "Juniper", "oak" = "Oak", "cedar" = "Cedar")) +
theme(legend.background = element_rect(colour = NA, fill = NA), legend.justification = c(1, 0),
legend.position = c(0.5, 0.32), legend.text = element_text(size = 8), legend.title = element_text(size = 10),
legend.direction = "vertical", axis.text.x = element_text(size = 8), axis.title.x = element_text(size = 10),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10), plot.margin = unit(c(0.5,0.5,0.5,0.5), "pt"),
strip.background = element_blank(), strip.text.x = element_blank()) +
# geom_text(data = p1_texta, mapping = aes(x = x, y = y, label = label), size = 5) +
# geom_text(data = p1_textb, mapping = aes(x = x, y = y, label = label), size = 3) +
# geom_text(data = data.frame(label = "Mean \n+/- SE", y = 7.9, x = 1.4, sequence = 'Both Droughts'), mapping = aes(x=x, y=y, label = label), size = 2) +
facet_grid(~ factor(sequence, levels = c('Both Droughts', '2nd Drought Only')))
p4
f2 <- ggarrange(p3, p4, ncol = 1, labels = "auto", align = "v", nrow = 2, heights = c(1, 0.95), common.legend = FALSE)
f2
ggsave(filename = 'SFig6_basal_area_boxplot.png', height=14, width=16, units = 'cm', dpi=900)
aov.all <- aov(data = all.forest %>% group_by(time.period, sequence, pltID) %>%
summarize(BAA.all.sum = sum(BAA.all), BAA.live = sum(BAA),
BAA.dead.sum = sum(BAA.dead),
BAA.mort = sum(BAA.dead) / sum(BAA.all) * 100), BAA.all.sum ~ time.period * sequence)
summary(aov.all)
#Tukey HSD
all.tHSD <- TukeyHSD(aov.all)
all.tHSD
View(all.forest.type.summary)
all.forest.type.summary <- all.forest.type %>% #mutate(BAA.mort = replace(BAA.mort, is.na(BAA.mort), 0)) %>%
mutate(live = case_when(BAA.all.sum > 0 ~ 1, BAA.all.sum == 0 ~ 0),
dead = case_when(BAA.mort > 0 ~ 1, BAA.mort == 0 ~ 0, is.na(BAA.mort ~ 0))) %>%
group_by(tree_type, time.period, sequence) %>% summarize(BAA.all.mean = mean(BAA.all.sum), BAA.all.sd = sd(BAA.all.sum),
BAA.live.mean = mean(BAA.live.sum), BAA.sd = sd(BAA.live.sum),
BAA.dead.mean = mean(BAA.dead.sum), BAA.dead.sd = sd(BAA.dead.sum),
BAA.mort.mean = mean(BAA.mort), BAA.mort.sd = sd(BAA.mort), count = n(),
live.count = sum(live), dead.count = sum(dead))
all.forest.type.summary <- all.forest.type %>% #mutate(BAA.mort = replace(BAA.mort, is.na(BAA.mort), 0)) %>%
mutate(live = case_when(BAA.all.sum > 0 ~ 1, BAA.all.sum == 0 ~ 0),
dead = case_when(BAA.mort > 0 ~ 1, BAA.mort == 0 ~ 0, is.na(BAA.mort ~ 0)))
all.forest.type.summary <- all.forest.type %>% #mutate(BAA.mort = replace(BAA.mort, is.na(BAA.mort), 0)) %>%
mutate(live = case_when(BAA.all.sum > 0 ~ 1, BAA.all.sum == 0 ~ 0),
dead = case_when(BAA.mort > 0 ~ 1, BAA.mort == 0 | is.na(BAA.mort ~ 0))) %>%
group_by(tree_type, time.period, sequence) %>% summarize(BAA.all.mean = mean(BAA.all.sum), BAA.all.sd = sd(BAA.all.sum),
BAA.live.mean = mean(BAA.live.sum), BAA.sd = sd(BAA.live.sum),
BAA.dead.mean = mean(BAA.dead.sum), BAA.dead.sd = sd(BAA.dead.sum),
BAA.mort.mean = mean(BAA.mort), BAA.mort.sd = sd(BAA.mort), count = n(),
live.count = sum(live), dead.count = sum(dead))
all.forest.type.summary <- all.forest.type %>% #mutate(BAA.mort = replace(BAA.mort, is.na(BAA.mort), 0)) %>%
mutate(live = case_when(BAA.all.sum > 0 ~ 1, BAA.all.sum == 0 ~ 0),
dead = case_when(BAA.mort > 0 ~ 1, BAA.mort == 0 | is.na(BAA.mort) ~ 0)) %>%
group_by(tree_type, time.period, sequence) %>% summarize(BAA.all.mean = mean(BAA.all.sum), BAA.all.sd = sd(BAA.all.sum),
BAA.live.mean = mean(BAA.live.sum), BAA.sd = sd(BAA.live.sum),
BAA.dead.mean = mean(BAA.dead.sum), BAA.dead.sd = sd(BAA.dead.sum),
BAA.mort.mean = mean(BAA.mort), BAA.mort.sd = sd(BAA.mort), count = n(),
live.count = sum(live), dead.count = sum(dead))
View(all.forest.type.summary)
p3_texta <- data.frame(label = c("a", "a", "b", "b"),
sequence   = c('Both Droughts', 'Both Droughts', '2nd Drought Only', '2nd Drought Only'),
# tree_type = c('pine/fir', 'other tree', 'pine/fir', 'other tree',
#               'pine/fir', 'other tree', 'pine/fir', 'other tree'),
y     = c(28, 26, 32, 32),
x     = c(1, 2, 1, 2)
)
#Letters to indicate sample sizes
p3_textb <- data.frame(label = c("n = 74", "n = 47", "n = 279", "n = 252"),
sequence   = c('Both Droughts', 'Both Droughts', '2nd Drought Only', '2nd Drought Only'),
y     = c(25, 23, 29, 29),
x     = c(1, 2, 1, 2)
)
#Summary of Total Basal Area
p3 <- ggbarplot(all.forest %>% group_by(time.period, sequence, pltID) %>% summarize(BAA.all.sum = sum(BAA.all), BAA.live = sum(BAA), BAA.dead.sum = sum(BAA.dead), BAA.mort = sum(BAA.dead) / sum(BAA.all) * 100), #%>% filter(COMMON_NAME %in% sp.both.2002[! sp.both.2002 %in% c('curlleaf mountain-mahogany', 'California live oak')]), #, (sequence == 'Both Droughts' & drought == '1999-2002') | (sequence == '2012-2015 Only' & drought == '2012-2015')),
x = "time.period", y = "BAA.all.sum", position = position_dodge(), color = "sequence", fill = 'gray',
add = "mean_se" , error.plot = "errorbar", alpha = 0.8, ylab = expression('Basal Area (m'^2*' ha'^-1*')')) +
theme_bw() + guides(color = 'none', fill = 'none') +
scale_color_manual(values = c("black", "black"), aesthetics = "color") +
theme(legend.background = element_rect(colour = NA, fill = NA), legend.justification = c(1, 0),
legend.position = c(0.76, 0.15), legend.text = element_text(size = 6), legend.title = element_text(size = 8),
legend.direction = "vertical", axis.text.x = element_blank(), axis.title.x = element_blank(),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10)) +
geom_text(data = p3_texta, mapping = aes(x = x, y = y, label = label), size = 5) +
geom_text(data = p3_textb, mapping = aes(x = x, y = y, label = label), size = 3) +
geom_text(data = data.frame(label = "Mean \n+/- SE", y = 20.2, x = 1.2, sequence = 'Both Droughts'), mapping = aes(x=x, y=y, label = label), size = 2) +
facet_grid(~ factor(sequence, levels = c('Both Droughts', '2nd Drought Only')))
p3
p3_texta <- data.frame(label = c("a", "a", "b", "b"),
sequence   = c('Both Droughts', 'Both Droughts', '2nd Drought Only', '2nd Drought Only'),
# tree_type = c('pine/fir', 'other tree', 'pine/fir', 'other tree',
#               'pine/fir', 'other tree', 'pine/fir', 'other tree'),
y     = c(25, 24, 35, 35),
x     = c(1, 2, 1, 2)
)
#Letters to indicate sample sizes
p3_textb <- data.frame(label = c("n = 74", "n = 47", "n = 279", "n = 252"),
sequence   = c('Both Droughts', 'Both Droughts', '2nd Drought Only', '2nd Drought Only'),
y     = c(22, 21, 32, 32),
x     = c(1, 2, 1, 2)
)
#Summary of Total Basal Area
p3 <- ggbarplot(all.forest %>% group_by(time.period, sequence, pltID) %>% summarize(BAA.all.sum = sum(BAA.all), BAA.live = sum(BAA), BAA.dead.sum = sum(BAA.dead), BAA.mort = sum(BAA.dead) / sum(BAA.all) * 100), #%>% filter(COMMON_NAME %in% sp.both.2002[! sp.both.2002 %in% c('curlleaf mountain-mahogany', 'California live oak')]), #, (sequence == 'Both Droughts' & drought == '1999-2002') | (sequence == '2012-2015 Only' & drought == '2012-2015')),
x = "time.period", y = "BAA.all.sum", position = position_dodge(), color = "sequence", fill = 'gray',
add = "mean_se" , error.plot = "errorbar", alpha = 0.8, ylab = expression('Basal Area (m'^2*' ha'^-1*')')) +
theme_bw() + guides(color = 'none', fill = 'none') +
scale_color_manual(values = c("black", "black"), aesthetics = "color") +
theme(legend.background = element_rect(colour = NA, fill = NA), legend.justification = c(1, 0),
legend.position = c(0.76, 0.15), legend.text = element_text(size = 6), legend.title = element_text(size = 8),
legend.direction = "vertical", axis.text.x = element_blank(), axis.title.x = element_blank(),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10)) +
geom_text(data = p3_texta, mapping = aes(x = x, y = y, label = label), size = 5) +
geom_text(data = p3_textb, mapping = aes(x = x, y = y, label = label), size = 3) +
geom_text(data = data.frame(label = "Mean \n+/- SE", y = 20.2, x = 1.2, sequence = 'Both Droughts'), mapping = aes(x=x, y=y, label = label), size = 2) +
facet_grid(~ factor(sequence, levels = c('Both Droughts', '2nd Drought Only')))
p3
p3_texta <- data.frame(label = c("a", "a", "b", "b"),
sequence   = c('Both Droughts', 'Both Droughts', '2nd Drought Only', '2nd Drought Only'),
# tree_type = c('pine/fir', 'other tree', 'pine/fir', 'other tree',
#               'pine/fir', 'other tree', 'pine/fir', 'other tree'),
y     = c(25, 21, 35, 35),
x     = c(1, 2, 1, 2)
)
#Letters to indicate sample sizes
p3_textb <- data.frame(label = c("n = 74", "n = 47", "n = 279", "n = 252"),
sequence   = c('Both Droughts', 'Both Droughts', '2nd Drought Only', '2nd Drought Only'),
y     = c(22, 18, 32, 32),
x     = c(1, 2, 1, 2)
)
#Summary of Total Basal Area
p3 <- ggbarplot(all.forest %>% group_by(time.period, sequence, pltID) %>% summarize(BAA.all.sum = sum(BAA.all), BAA.live = sum(BAA), BAA.dead.sum = sum(BAA.dead), BAA.mort = sum(BAA.dead) / sum(BAA.all) * 100), #%>% filter(COMMON_NAME %in% sp.both.2002[! sp.both.2002 %in% c('curlleaf mountain-mahogany', 'California live oak')]), #, (sequence == 'Both Droughts' & drought == '1999-2002') | (sequence == '2012-2015 Only' & drought == '2012-2015')),
x = "time.period", y = "BAA.all.sum", position = position_dodge(), color = "sequence", fill = 'gray',
add = "mean_se" , error.plot = "errorbar", alpha = 0.8, ylab = expression('Basal Area (m'^2*' ha'^-1*')')) +
theme_bw() + guides(color = 'none', fill = 'none') +
scale_color_manual(values = c("black", "black"), aesthetics = "color") +
theme(legend.background = element_rect(colour = NA, fill = NA), legend.justification = c(1, 0),
legend.position = c(0.76, 0.15), legend.text = element_text(size = 6), legend.title = element_text(size = 8),
legend.direction = "vertical", axis.text.x = element_blank(), axis.title.x = element_blank(),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10)) +
geom_text(data = p3_texta, mapping = aes(x = x, y = y, label = label), size = 5) +
geom_text(data = p3_textb, mapping = aes(x = x, y = y, label = label), size = 3) +
geom_text(data = data.frame(label = "Mean \n+/- SE", y = 20.2, x = 1.2, sequence = 'Both Droughts'), mapping = aes(x=x, y=y, label = label), size = 2) +
facet_grid(~ factor(sequence, levels = c('Both Droughts', '2nd Drought Only')))
p3
p3_texta <- data.frame(label = c("a", "a", "b", "b"),
sequence   = c('Both Droughts', 'Both Droughts', '2nd Drought Only', '2nd Drought Only'),
# tree_type = c('pine/fir', 'other tree', 'pine/fir', 'other tree',
#               'pine/fir', 'other tree', 'pine/fir', 'other tree'),
y     = c(25, 20, 35, 35),
x     = c(1, 2, 1, 2)
)
#Letters to indicate sample sizes
p3_textb <- data.frame(label = c("n = 74", "n = 47", "n = 279", "n = 252"),
sequence   = c('Both Droughts', 'Both Droughts', '2nd Drought Only', '2nd Drought Only'),
y     = c(22, 17, 32, 32),
x     = c(1, 2, 1, 2)
)
#Summary of Total Basal Area
p3 <- ggbarplot(all.forest %>% group_by(time.period, sequence, pltID) %>% summarize(BAA.all.sum = sum(BAA.all), BAA.live = sum(BAA), BAA.dead.sum = sum(BAA.dead), BAA.mort = sum(BAA.dead) / sum(BAA.all) * 100), #%>% filter(COMMON_NAME %in% sp.both.2002[! sp.both.2002 %in% c('curlleaf mountain-mahogany', 'California live oak')]), #, (sequence == 'Both Droughts' & drought == '1999-2002') | (sequence == '2012-2015 Only' & drought == '2012-2015')),
x = "time.period", y = "BAA.all.sum", position = position_dodge(), color = "sequence", fill = 'gray',
add = "mean_se" , error.plot = "errorbar", alpha = 0.8, ylab = expression('Basal Area (m'^2*' ha'^-1*')')) +
theme_bw() + guides(color = 'none', fill = 'none') +
scale_color_manual(values = c("black", "black"), aesthetics = "color") +
theme(legend.background = element_rect(colour = NA, fill = NA), legend.justification = c(1, 0),
legend.position = c(0.76, 0.15), legend.text = element_text(size = 6), legend.title = element_text(size = 8),
legend.direction = "vertical", axis.text.x = element_blank(), axis.title.x = element_blank(),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10)) +
geom_text(data = p3_texta, mapping = aes(x = x, y = y, label = label), size = 5) +
geom_text(data = p3_textb, mapping = aes(x = x, y = y, label = label), size = 3) +
geom_text(data = data.frame(label = "Mean \n+/- SE", y = 20.2, x = 1.2, sequence = 'Both Droughts'), mapping = aes(x=x, y=y, label = label), size = 2) +
facet_grid(~ factor(sequence, levels = c('Both Droughts', '2nd Drought Only')))
p3
p3_texta <- data.frame(label = c("a", "a", "b", "b"),
sequence   = c('Both Droughts', 'Both Droughts', '2nd Drought Only', '2nd Drought Only'),
# tree_type = c('pine/fir', 'other tree', 'pine/fir', 'other tree',
#               'pine/fir', 'other tree', 'pine/fir', 'other tree'),
y     = c(25, 20, 35, 35.5),
x     = c(1, 2, 1, 2)
)
#Letters to indicate sample sizes
p3_textb <- data.frame(label = c("n = 74", "n = 47", "n = 279", "n = 252"),
sequence   = c('Both Droughts', 'Both Droughts', '2nd Drought Only', '2nd Drought Only'),
y     = c(22, 17, 32, 32.5),
x     = c(1, 2, 1, 2)
)
#Summary of Total Basal Area
p3 <- ggbarplot(all.forest %>% group_by(time.period, sequence, pltID) %>% summarize(BAA.all.sum = sum(BAA.all), BAA.live = sum(BAA), BAA.dead.sum = sum(BAA.dead), BAA.mort = sum(BAA.dead) / sum(BAA.all) * 100), #%>% filter(COMMON_NAME %in% sp.both.2002[! sp.both.2002 %in% c('curlleaf mountain-mahogany', 'California live oak')]), #, (sequence == 'Both Droughts' & drought == '1999-2002') | (sequence == '2012-2015 Only' & drought == '2012-2015')),
x = "time.period", y = "BAA.all.sum", position = position_dodge(), color = "sequence", fill = 'gray',
add = "mean_se" , error.plot = "errorbar", alpha = 0.8, ylab = expression('Basal Area (m'^2*' ha'^-1*')')) +
theme_bw() + guides(color = 'none', fill = 'none') +
scale_color_manual(values = c("black", "black"), aesthetics = "color") +
theme(legend.background = element_rect(colour = NA, fill = NA), legend.justification = c(1, 0),
legend.position = c(0.76, 0.15), legend.text = element_text(size = 6), legend.title = element_text(size = 8),
legend.direction = "vertical", axis.text.x = element_blank(), axis.title.x = element_blank(),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10)) +
geom_text(data = p3_texta, mapping = aes(x = x, y = y, label = label), size = 5) +
geom_text(data = p3_textb, mapping = aes(x = x, y = y, label = label), size = 3) +
geom_text(data = data.frame(label = "Mean \n+/- SE", y = 20.2, x = 1.2, sequence = 'Both Droughts'), mapping = aes(x=x, y=y, label = label), size = 2) +
facet_grid(~ factor(sequence, levels = c('Both Droughts', '2nd Drought Only')))
p3
p4 <- ggbarplot(all.forest.type %>% filter(tree_type != 'other conifer' & tree_type != 'deciduous'),
x = "time.period", y = "BAA.all.sum", position = position_dodge(), fill = 'tree_type.f', color = "sequence",
add = "mean_se" , error.plot = "errorbar", alpha = 0.8, ylab = expression('Basal Area (m'^2*' ha'^-1*')'),
xlab = "Time Period") +
theme_bw() + guides(color = 'none', fill = guide_legend(title = "Tree Type", ncol = 1)) +
scale_color_manual(values = c("black", "black"), aesthetics = "color") +
scale_fill_discrete(labels = c("pine" = "Pine", "fir" = "Fir", "juniper" = "Juniper", "oak" = "Oak", "cedar" = "Cedar")) +
theme(legend.background = element_rect(colour = NA, fill = NA), legend.justification = c(1, 0),
legend.position = c(0.5, 0.32), legend.text = element_text(size = 8), legend.title = element_text(size = 10),
legend.direction = "vertical", axis.text.x = element_text(size = 8), axis.title.x = element_text(size = 10),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10), plot.margin = unit(c(0.5,0.5,0.5,0.5), "pt"),
strip.background = element_blank(), strip.text.x = element_blank()) +
# geom_text(data = p1_texta, mapping = aes(x = x, y = y, label = label), size = 5) +
# geom_text(data = p1_textb, mapping = aes(x = x, y = y, label = label), size = 3) +
# geom_text(data = data.frame(label = "Mean \n+/- SE", y = 7.9, x = 1.4, sequence = 'Both Droughts'), mapping = aes(x=x, y=y, label = label), size = 2) +
facet_grid(~ factor(sequence, levels = c('Both Droughts', '2nd Drought Only')))
p4
f2 <- ggarrange(p3, p4, ncol = 1, labels = "auto", align = "v", nrow = 2, heights = c(1, 0.95), common.legend = FALSE)
f2
ggsave(filename = 'SFig6_basal_area_boxplot.png', height=14, width=16, units = 'cm', dpi=900)
p4 <- ggbarplot(all.forest.type %>% filter(tree_type != 'other conifer' & tree_type != 'deciduous'),
x = "time.period", y = "BAA.all.sum", position = position_dodge(), fill = 'tree_type.f', color = "sequence",
add = "mean_se" , error.plot = "errorbar", alpha = 0.8, ylab = expression('Basal Area (m'^2*' ha'^-1*')'),
xlab = "Time Period") +
theme_bw() + guides(color = 'none', fill = guide_legend(title = "Tree Type", ncol = 1)) +
scale_color_manual(values = c("black", "black"), aesthetics = "color") +
scale_fill_discrete(labels = c("pine" = "Pine", "fir" = "Fir", "juniper" = "Juniper", "oak" = "Oak", "cedar" = "Cedar")) +
theme(legend.background = element_rect(colour = NA, fill = NA), legend.justification = c(1, 0),
legend.position = c(1.5, 0.32), legend.text = element_text(size = 8), legend.title = element_text(size = 10),
legend.direction = "vertical", axis.text.x = element_text(size = 8), axis.title.x = element_text(size = 10),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10), plot.margin = unit(c(0.5,0.5,0.5,0.5), "pt"),
strip.background = element_blank(), strip.text.x = element_blank()) +
# geom_text(data = p1_texta, mapping = aes(x = x, y = y, label = label), size = 5) +
# geom_text(data = p1_textb, mapping = aes(x = x, y = y, label = label), size = 3) +
# geom_text(data = data.frame(label = "Mean \n+/- SE", y = 7.9, x = 1.4, sequence = 'Both Droughts'), mapping = aes(x=x, y=y, label = label), size = 2) +
facet_grid(~ factor(sequence, levels = c('Both Droughts', '2nd Drought Only')))
p4
f2 <- ggarrange(p3, p4, ncol = 1, labels = "auto", align = "v", nrow = 2, heights = c(1, 0.95), common.legend = FALSE)
f2
ggsave(filename = 'SFig6_basal_area_boxplot.png', height=14, width=16, units = 'cm', dpi=900)
p4 <- ggbarplot(all.forest.type %>% filter(tree_type != 'other conifer' & tree_type != 'deciduous'),
x = "time.period", y = "BAA.all.sum", position = position_dodge(), fill = 'tree_type.f', color = "sequence",
add = "mean_se" , error.plot = "errorbar", alpha = 0.8, ylab = expression('Basal Area (m'^2*' ha'^-1*')'),
xlab = "Time Period") +
theme_bw() + guides(color = 'none', fill = guide_legend(title = "Tree Type", ncol = 1)) +
scale_color_manual(values = c("black", "black"), aesthetics = "color") +
scale_fill_discrete(labels = c("pine" = "Pine", "fir" = "Fir", "juniper" = "Juniper", "oak" = "Oak", "cedar" = "Cedar")) +
theme(legend.background = element_rect(colour = NA, fill = NA), legend.justification = c(1, 0),
legend.position = c(0.9, 0.32), legend.text = element_text(size = 8), legend.title = element_text(size = 10),
legend.direction = "vertical", axis.text.x = element_text(size = 8), axis.title.x = element_text(size = 10),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10), plot.margin = unit(c(0.5,0.5,0.5,0.5), "pt"),
strip.background = element_blank(), strip.text.x = element_blank()) +
# geom_text(data = p1_texta, mapping = aes(x = x, y = y, label = label), size = 5) +
# geom_text(data = p1_textb, mapping = aes(x = x, y = y, label = label), size = 3) +
# geom_text(data = data.frame(label = "Mean \n+/- SE", y = 7.9, x = 1.4, sequence = 'Both Droughts'), mapping = aes(x=x, y=y, label = label), size = 2) +
facet_grid(~ factor(sequence, levels = c('Both Droughts', '2nd Drought Only')))
p4
f2 <- ggarrange(p3, p4, ncol = 1, labels = "auto", align = "v", nrow = 2, heights = c(1, 0.95), common.legend = FALSE)
f2
ggsave(filename = 'SFig6_basal_area_boxplot.png', height=14, width=16, units = 'cm', dpi=900)
p4 <- ggbarplot(all.forest.type %>% filter(tree_type != 'other conifer' & tree_type != 'deciduous'),
x = "time.period", y = "BAA.all.sum", position = position_dodge(), fill = 'tree_type.f', color = "sequence",
add = "mean_se" , error.plot = "errorbar", alpha = 0.8, ylab = expression('Basal Area (m'^2*' ha'^-1*')'),
xlab = "Time Period") +
theme_bw() + guides(color = 'none', fill = guide_legend(title = "Tree Type", ncol = 1)) +
scale_color_manual(values = c("black", "black"), aesthetics = "color") +
scale_fill_discrete(labels = c("pine" = "Pine", "fir" = "Fir", "juniper" = "Juniper", "oak" = "Oak", "cedar" = "Cedar")) +
theme(legend.background = element_rect(colour = NA, fill = NA), legend.justification = c(1, 0),
legend.position = c(0.95, 0.32), legend.text = element_text(size = 8), legend.title = element_text(size = 10),
legend.direction = "vertical", axis.text.x = element_text(size = 8), axis.title.x = element_text(size = 10),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10), plot.margin = unit(c(0.5,0.5,0.5,0.5), "pt"),
strip.background = element_blank(), strip.text.x = element_blank()) +
# geom_text(data = p1_texta, mapping = aes(x = x, y = y, label = label), size = 5) +
# geom_text(data = p1_textb, mapping = aes(x = x, y = y, label = label), size = 3) +
# geom_text(data = data.frame(label = "Mean \n+/- SE", y = 7.9, x = 1.4, sequence = 'Both Droughts'), mapping = aes(x=x, y=y, label = label), size = 2) +
facet_grid(~ factor(sequence, levels = c('Both Droughts', '2nd Drought Only')))
p4
f2 <- ggarrange(p3, p4, ncol = 1, labels = "auto", align = "v", nrow = 2, heights = c(1, 0.95), common.legend = FALSE)
f2
ggsave(filename = 'SFig6_basal_area_boxplot.png', height=14, width=16, units = 'cm', dpi=900)
p4 <- ggbarplot(all.forest.type %>% filter(tree_type != 'other conifer' & tree_type != 'deciduous'),
x = "time.period", y = "BAA.all.sum", position = position_dodge(), fill = 'tree_type.f', color = "sequence",
add = "mean_se" , error.plot = "errorbar", alpha = 0.8, ylab = expression('Basal Area (m'^2*' ha'^-1*')'),
xlab = "Time Period") +
theme_bw() + guides(color = 'none', fill = guide_legend(title = "Tree Type", ncol = 1)) +
scale_color_manual(values = c("black", "black"), aesthetics = "color") +
scale_fill_discrete(labels = c("pine" = "Pine", "fir" = "Fir", "juniper" = "Juniper", "oak" = "Oak", "cedar" = "Cedar")) +
theme(legend.background = element_rect(colour = NA, fill = NA), legend.justification = c(1, 0),
legend.position = c(1.0, 0.32), legend.text = element_text(size = 8), legend.title = element_text(size = 10),
legend.direction = "vertical", axis.text.x = element_text(size = 8), axis.title.x = element_text(size = 10),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10), plot.margin = unit(c(0.5,0.5,0.5,0.5), "pt"),
strip.background = element_blank(), strip.text.x = element_blank()) +
# geom_text(data = p1_texta, mapping = aes(x = x, y = y, label = label), size = 5) +
# geom_text(data = p1_textb, mapping = aes(x = x, y = y, label = label), size = 3) +
# geom_text(data = data.frame(label = "Mean \n+/- SE", y = 7.9, x = 1.4, sequence = 'Both Droughts'), mapping = aes(x=x, y=y, label = label), size = 2) +
facet_grid(~ factor(sequence, levels = c('Both Droughts', '2nd Drought Only')))
p4
f2 <- ggarrange(p3, p4, ncol = 1, labels = "auto", align = "v", nrow = 2, heights = c(1, 0.95), common.legend = FALSE)
f2
ggsave(filename = 'SFig6_basal_area_boxplot.png', height=14, width=16, units = 'cm', dpi=900)
p4 <- ggbarplot(all.forest.type %>% filter(tree_type != 'other conifer' & tree_type != 'deciduous'),
x = "time.period", y = "BAA.all.sum", position = position_dodge(), fill = 'tree_type.f', color = "sequence",
add = "mean_se" , error.plot = "errorbar", alpha = 0.8, ylab = expression('Basal Area (m'^2*' ha'^-1*')'),
xlab = "Time Period") +
theme_bw() + guides(color = 'none', fill = guide_legend(title = "Tree Type", ncol = 1, label.position = "bottom")) +
scale_color_manual(values = c("black", "black"), aesthetics = "color") +
scale_fill_discrete(labels = c("pine" = "Pine", "fir" = "Fir", "juniper" = "Juniper", "oak" = "Oak", "cedar" = "Cedar")) +
theme(legend.background = element_rect(colour = NA, fill = NA), legend.justification = c(1, 0),
legend.position = c(0.1, 0.6), legend.text = element_text(size = 8), legend.title = element_text(size = 10),
legend.direction = "horizontal",axis.text.x = element_text(size = 8), axis.title.x = element_text(size = 10),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10), plot.margin = unit(c(0.5,0.5,0.5,0.5), "pt"),
strip.background = element_blank(), strip.text.x = element_blank()) +
# geom_text(data = p1_texta, mapping = aes(x = x, y = y, label = label), size = 5) +
# geom_text(data = p1_textb, mapping = aes(x = x, y = y, label = label), size = 3) +
# geom_text(data = data.frame(label = "Mean \n+/- SE", y = 7.9, x = 1.4, sequence = 'Both Droughts'), mapping = aes(x=x, y=y, label = label), size = 2) +
facet_grid(~ factor(sequence, levels = c('Both Droughts', '2nd Drought Only')))
p4
f2 <- ggarrange(p3, p4, ncol = 1, labels = "auto", align = "v", nrow = 2, heights = c(1, 0.95), common.legend = FALSE)
f2
ggsave(filename = 'SFig6_basal_area_boxplot.png', height=14, width=16, units = 'cm', dpi=900)
p4 <- ggbarplot(all.forest.type %>% filter(tree_type != 'other conifer' & tree_type != 'deciduous'),
x = "time.period", y = "BAA.all.sum", position = position_dodge(), fill = 'tree_type.f', color = "sequence",
add = "mean_se" , error.plot = "errorbar", alpha = 0.8, ylab = expression('Basal Area (m'^2*' ha'^-1*')'),
xlab = "Time Period") +
theme_bw() + guides(color = 'none', fill = guide_legend(title = "Tree Type",  label.position = "bottom")) +
scale_color_manual(values = c("black", "black"), aesthetics = "color") +
scale_fill_discrete(labels = c("pine" = "Pine", "fir" = "Fir", "juniper" = "Juniper", "oak" = "Oak", "cedar" = "Cedar")) +
theme(legend.background = element_rect(colour = NA, fill = NA), legend.justification = c(1, 0),
legend.position = c(0.1, 0.6), legend.text = element_text(size = 8), legend.title = element_text(size = 10),
legend.direction = "horizontal",axis.text.x = element_text(size = 8), axis.title.x = element_text(size = 10),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10), plot.margin = unit(c(0.5,0.5,0.5,0.5), "pt"),
strip.background = element_blank(), strip.text.x = element_blank()) +
# geom_text(data = p1_texta, mapping = aes(x = x, y = y, label = label), size = 5) +
# geom_text(data = p1_textb, mapping = aes(x = x, y = y, label = label), size = 3) +
# geom_text(data = data.frame(label = "Mean \n+/- SE", y = 7.9, x = 1.4, sequence = 'Both Droughts'), mapping = aes(x=x, y=y, label = label), size = 2) +
facet_grid(~ factor(sequence, levels = c('Both Droughts', '2nd Drought Only')))
p4
f2 <- ggarrange(p3, p4, ncol = 1, labels = "auto", align = "v", nrow = 2, heights = c(1, 0.95), common.legend = FALSE)
f2
ggsave(filename = 'SFig6_basal_area_boxplot.png', height=14, width=16, units = 'cm', dpi=900)
p4 <- ggbarplot(all.forest.type %>% filter(tree_type != 'other conifer' & tree_type != 'deciduous'),
x = "time.period", y = "BAA.all.sum", position = position_dodge(), fill = 'tree_type.f', color = "sequence",
add = "mean_se" , error.plot = "errorbar", alpha = 0.8, ylab = expression('Basal Area (m'^2*' ha'^-1*')'),
xlab = "Time Period") +
theme_bw() + guides(color = 'none', fill = guide_legend(title = "Tree Type",  label.position = "bottom")) +
scale_color_manual(values = c("black", "black"), aesthetics = "color") +
scale_fill_discrete(labels = c("pine" = "Pine", "fir" = "Fir", "juniper" = "Juniper", "oak" = "Oak", "cedar" = "Cedar")) +
theme(legend.background = element_rect(colour = NA, fill = NA), legend.justification = c(1, 0),
legend.position = c(0.4, 0.6), legend.text = element_text(size = 8), legend.title = element_text(size = 10),
legend.direction = "horizontal",axis.text.x = element_text(size = 8), axis.title.x = element_text(size = 10),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10), plot.margin = unit(c(0.5,0.5,0.5,0.5), "pt"),
strip.background = element_blank(), strip.text.x = element_blank()) +
# geom_text(data = p1_texta, mapping = aes(x = x, y = y, label = label), size = 5) +
# geom_text(data = p1_textb, mapping = aes(x = x, y = y, label = label), size = 3) +
# geom_text(data = data.frame(label = "Mean \n+/- SE", y = 7.9, x = 1.4, sequence = 'Both Droughts'), mapping = aes(x=x, y=y, label = label), size = 2) +
facet_grid(~ factor(sequence, levels = c('Both Droughts', '2nd Drought Only')))
p4
f2 <- ggarrange(p3, p4, ncol = 1, labels = "auto", align = "v", nrow = 2, heights = c(1, 0.95), common.legend = FALSE)
f2
ggsave(filename = 'SFig6_basal_area_boxplot.png', height=14, width=16, units = 'cm', dpi=900)
p4 <- ggbarplot(all.forest.type %>% filter(tree_type != 'other conifer' & tree_type != 'deciduous'),
x = "time.period", y = "BAA.all.sum", position = position_dodge(), fill = 'tree_type.f', color = "sequence",
add = "mean_se" , error.plot = "errorbar", alpha = 0.8, ylab = expression('Basal Area (m'^2*' ha'^-1*')'),
xlab = "Time Period") +
theme_bw() + guides(color = 'none', fill = guide_legend(title = "Tree Type",  label.position = "bottom", title.position="top", title.hjust = 0.5)) +
scale_color_manual(values = c("black", "black"), aesthetics = "color") +
scale_fill_discrete(labels = c("pine" = "Pine", "fir" = "Fir", "juniper" = "Juniper", "oak" = "Oak", "cedar" = "Cedar")) +
theme(legend.background = element_rect(colour = NA, fill = NA), legend.justification = c(1, 0),
legend.position = c(0.4, 0.6), legend.text = element_text(size = 8), legend.title = element_text(size = 10),
legend.direction = "horizontal",axis.text.x = element_text(size = 8), axis.title.x = element_text(size = 10),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10), plot.margin = unit(c(0.5,0.5,0.5,0.5), "pt"),
strip.background = element_blank(), strip.text.x = element_blank()) +
# geom_text(data = p1_texta, mapping = aes(x = x, y = y, label = label), size = 5) +
# geom_text(data = p1_textb, mapping = aes(x = x, y = y, label = label), size = 3) +
# geom_text(data = data.frame(label = "Mean \n+/- SE", y = 7.9, x = 1.4, sequence = 'Both Droughts'), mapping = aes(x=x, y=y, label = label), size = 2) +
facet_grid(~ factor(sequence, levels = c('Both Droughts', '2nd Drought Only')))
p4
f2 <- ggarrange(p3, p4, ncol = 1, labels = "auto", align = "v", nrow = 2, heights = c(1, 0.95), common.legend = FALSE)
f2
ggsave(filename = 'SFig6_basal_area_boxplot.png', height=14, width=16, units = 'cm', dpi=900)
p4 <- ggbarplot(all.forest.type %>% filter(tree_type != 'other conifer' & tree_type != 'deciduous'),
x = "time.period", y = "BAA.all.sum", position = position_dodge(), fill = 'tree_type.f', color = "sequence",
add = "mean_se" , error.plot = "errorbar", alpha = 0.8, ylab = expression('Basal Area (m'^2*' ha'^-1*')'),
xlab = "Time Period") +
theme_bw() + guides(color = 'none', fill = guide_legend(title = "Tree Type",  label.position = "bottom", title.position="top", title.hjust = 0.5)) +
scale_color_manual(values = c("black", "black"), aesthetics = "color") +
scale_fill_discrete(labels = c("pine" = "Pine", "fir" = "Fir", "juniper" = "Juniper", "oak" = "Oak", "cedar" = "Cedar")) +
theme(legend.background = element_rect(colour = NA, fill = NA),
legend.position = c(0.4, 0.6), legend.text = element_text(size = 8), legend.title = element_text(size = 10),
legend.direction = "horizontal",axis.text.x = element_text(size = 8), axis.title.x = element_text(size = 10),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10), plot.margin = unit(c(0.5,0.5,0.5,0.5), "pt"),
strip.background = element_blank(), strip.text.x = element_blank()) +
# geom_text(data = p1_texta, mapping = aes(x = x, y = y, label = label), size = 5) +
# geom_text(data = p1_textb, mapping = aes(x = x, y = y, label = label), size = 3) +
# geom_text(data = data.frame(label = "Mean \n+/- SE", y = 7.9, x = 1.4, sequence = 'Both Droughts'), mapping = aes(x=x, y=y, label = label), size = 2) +
facet_grid(~ factor(sequence, levels = c('Both Droughts', '2nd Drought Only')))
p4
f2 <- ggarrange(p3, p4, ncol = 1, labels = "auto", align = "v", nrow = 2, heights = c(1, 0.95), common.legend = FALSE)
f2
ggsave(filename = 'SFig6_basal_area_boxplot.png', height=14, width=16, units = 'cm', dpi=900)
p4 <- ggbarplot(all.forest.type %>% filter(tree_type != 'other conifer' & tree_type != 'deciduous'),
x = "time.period", y = "BAA.all.sum", position = position_dodge(), fill = 'tree_type.f', color = "sequence",
add = "mean_se" , error.plot = "errorbar", alpha = 0.8, ylab = expression('Basal Area (m'^2*' ha'^-1*')'),
xlab = "Time Period") +
theme_bw() + guides(color = 'none', fill = guide_legend(title = "Tree Type",  label.position = "bottom", title.position="top", title.hjust = 0.5)) +
scale_color_manual(values = c("black", "black"), aesthetics = "color") +
scale_fill_discrete(labels = c("pine" = "Pine", "fir" = "Fir", "juniper" = "Juniper", "oak" = "Oak", "cedar" = "Cedar")) +
theme(legend.background = element_rect(colour = NA, fill = NA),
legend.position = c(0.3, 0.7), legend.text = element_text(size = 8), legend.title = element_text(size = 10),
legend.direction = "horizontal",axis.text.x = element_text(size = 8), axis.title.x = element_text(size = 10),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10), plot.margin = unit(c(0.5,0.5,0.5,0.5), "pt"),
strip.background = element_blank(), strip.text.x = element_blank()) +
# geom_text(data = p1_texta, mapping = aes(x = x, y = y, label = label), size = 5) +
# geom_text(data = p1_textb, mapping = aes(x = x, y = y, label = label), size = 3) +
# geom_text(data = data.frame(label = "Mean \n+/- SE", y = 7.9, x = 1.4, sequence = 'Both Droughts'), mapping = aes(x=x, y=y, label = label), size = 2) +
facet_grid(~ factor(sequence, levels = c('Both Droughts', '2nd Drought Only')))
p4
f2 <- ggarrange(p3, p4, ncol = 1, labels = "auto", align = "v", nrow = 2, heights = c(1, 0.95), common.legend = FALSE)
f2
ggsave(filename = 'SFig6_basal_area_boxplot.png', height=14, width=16, units = 'cm', dpi=900)
x = "time.period", y = "BAA.all.sum", position = position_dodge(), fill = 'tree_type.f', color = "sequence",
add = "mean_se" , error.plot = "errorbar", alpha = 0.8, ylab = expression('Basal Area (m'^2*' ha'^-1*')'),
xlab = "Time Period") +
theme_bw() + guides(color = 'none', fill = guide_legend(title = "Tree Type",  label.position = "bottom", title.position="top", title.hjust = 0.5)) +
scale_color_manual(values = c("black", "black"), aesthetics = "color") +
scale_fill_discrete(labels = c("pine" = "Pine", "fir" = "Fir", "juniper" = "Juniper", "oak" = "Oak", "cedar" = "Cedar")) +
theme(legend.background = element_rect(colour = NA, fill = NA),
legend.position = c(0.1, 0.85), legend.text = element_text(size = 8), legend.title = element_text(size = 10),
legend.direction = "horizontal",axis.text.x = element_text(size = 8), axis.title.x = element_text(size = 10),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10), plot.margin = unit(c(0.5,0.5,0.5,0.5), "pt"),
strip.background = element_blank(), strip.text.x = element_blank()) +
# geom_text(data = p1_texta, mapping = aes(x = x, y = y, label = label), size = 5) +
# geom_text(data = p1_textb, mapping = aes(x = x, y = y, label = label), size = 3) +
# geom_text(data = data.frame(label = "Mean \n+/- SE", y = 7.9, x = 1.4, sequence = 'Both Droughts'), mapping = aes(x=x, y=y, label = label), size = 2) +
facet_grid(~ factor(sequence, levels = c('Both Droughts', '2nd Drought Only')))
p4
f2 <- ggarrange(p3, p4, ncol = 1, labels = "auto", align = "v", nrow = 2, heights = c(1, 0.95), common.legend = FALSE)
f2
ggsave(filename = 'SFig6_basal_area_boxplot.png', height=14, width=16, units = 'cm', dpi=900)
p4 <- ggbarplot(all.forest.type %>% filter(tree_type != 'other conifer' & tree_type != 'deciduous'),
x = "time.period", y = "BAA.all.sum", position = position_dodge(), fill = 'tree_type.f', color = "sequence",
add = "mean_se" , error.plot = "errorbar", alpha = 0.8, ylab = expression('Basal Area (m'^2*' ha'^-1*')'),
xlab = "Time Period") +
theme_bw() + guides(color = 'none', fill = guide_legend(title = "Tree Type",  label.position = "bottom", title.position="top", title.hjust = 0.5)) +
scale_color_manual(values = c("black", "black"), aesthetics = "color") +
scale_fill_discrete(labels = c("pine" = "Pine", "fir" = "Fir", "juniper" = "Juniper", "oak" = "Oak", "cedar" = "Cedar")) +
theme(legend.background = element_rect(colour = NA, fill = NA),
legend.position = c(0.1, 0.85), legend.text = element_text(size = 8), legend.title = element_text(size = 10),
legend.direction = "horizontal",axis.text.x = element_text(size = 8), axis.title.x = element_text(size = 10),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10), plot.margin = unit(c(0.5,0.5,0.5,0.5), "pt"),
strip.background = element_blank(), strip.text.x = element_blank()) +
# geom_text(data = p1_texta, mapping = aes(x = x, y = y, label = label), size = 5) +
# geom_text(data = p1_textb, mapping = aes(x = x, y = y, label = label), size = 3) +
# geom_text(data = data.frame(label = "Mean \n+/- SE", y = 7.9, x = 1.4, sequence = 'Both Droughts'), mapping = aes(x=x, y=y, label = label), size = 2) +
facet_grid(~ factor(sequence, levels = c('Both Droughts', '2nd Drought Only')))
p4
f2 <- ggarrange(p3, p4, ncol = 1, labels = "auto", align = "v", nrow = 2, heights = c(1, 0.95), common.legend = FALSE)
f2
ggsave(filename = 'SFig6_basal_area_boxplot.png', height=14, width=16, units = 'cm', dpi=900)
p4 <- ggbarplot(all.forest.type %>% filter(tree_type != 'other conifer' & tree_type != 'deciduous'),
x = "time.period", y = "BAA.all.sum", position = position_dodge(), fill = 'tree_type.f', color = "sequence",
add = "mean_se" , error.plot = "errorbar", alpha = 0.8, ylab = expression('Basal Area (m'^2*' ha'^-1*')'),
xlab = "Time Period") +
theme_bw() + guides(color = 'none', fill = guide_legend(title = "Tree Type",  label.position = "bottom", title.position="top", title.hjust = 0.5)) +
scale_color_manual(values = c("black", "black"), aesthetics = "color") +
scale_fill_discrete(labels = c("pine" = "Pine", "fir" = "Fir", "juniper" = "Juniper", "oak" = "Oak", "cedar" = "Cedar")) +
theme(legend.background = element_rect(colour = NA, fill = NA),
legend.position = c(0.2, 0.8), legend.text = element_text(size = 8), legend.title = element_text(size = 10),
legend.direction = "horizontal",axis.text.x = element_text(size = 8), axis.title.x = element_text(size = 10),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10), plot.margin = unit(c(0.5,0.5,0.5,0.5), "pt"),
strip.background = element_blank(), strip.text.x = element_blank()) +
# geom_text(data = p1_texta, mapping = aes(x = x, y = y, label = label), size = 5) +
# geom_text(data = p1_textb, mapping = aes(x = x, y = y, label = label), size = 3) +
# geom_text(data = data.frame(label = "Mean \n+/- SE", y = 7.9, x = 1.4, sequence = 'Both Droughts'), mapping = aes(x=x, y=y, label = label), size = 2) +
facet_grid(~ factor(sequence, levels = c('Both Droughts', '2nd Drought Only')))
p4
f2 <- ggarrange(p3, p4, ncol = 1, labels = "auto", align = "v", nrow = 2, heights = c(1, 0.95), common.legend = FALSE)
f2
ggsave(filename = 'SFig6_basal_area_boxplot.png', height=14, width=16, units = 'cm', dpi=900)
p4 <- ggbarplot(all.forest.type %>% filter(tree_type != 'other conifer' & tree_type != 'deciduous'),
x = "time.period", y = "BAA.all.sum", position = position_dodge(), fill = 'tree_type.f', color = "sequence",
add = "mean_se" , error.plot = "errorbar", alpha = 0.8, ylab = expression('Basal Area (m'^2*' ha'^-1*')'),
xlab = "Time Period") +
theme_bw() + guides(color = 'none', fill = guide_legend(title = "Tree Type",  label.position = "bottom", title.position="top", title.hjust = 0.5)) +
scale_color_manual(values = c("black", "black"), aesthetics = "color") +
scale_fill_discrete(labels = c("pine" = "Pine", "fir" = "Fir", "juniper" = "Juniper", "oak" = "Oak", "cedar" = "Cedar")) +
theme(legend.background = element_rect(colour = NA, fill = NA),
legend.position = c(0.2, 0.8), legend.text = element_text(size = 6), legend.title = element_text(size = 8),
legend.direction = "horizontal",axis.text.x = element_text(size = 8), axis.title.x = element_text(size = 10),
axis.text.y = element_text(size = 8), axis.title.y = element_text(size = 10), plot.margin = unit(c(0.5,0.5,0.5,0.5), "pt"),
strip.background = element_blank(), strip.text.x = element_blank()) +
# geom_text(data = p1_texta, mapping = aes(x = x, y = y, label = label), size = 5) +
# geom_text(data = p1_textb, mapping = aes(x = x, y = y, label = label), size = 3) +
# geom_text(data = data.frame(label = "Mean \n+/- SE", y = 7.9, x = 1.4, sequence = 'Both Droughts'), mapping = aes(x=x, y=y, label = label), size = 2) +
facet_grid(~ factor(sequence, levels = c('Both Droughts', '2nd Drought Only')))
p4
f2 <- ggarrange(p3, p4, ncol = 1, labels = "auto", align = "v", nrow = 2, heights = c(1, 0.95), common.legend = FALSE)
f2
ggsave(filename = 'SFig6_basal_area_boxplot.png', height=14, width=16, units = 'cm', dpi=900)
