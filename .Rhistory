#four-year Pr-ET
PET_4yr.both.t <- t.test(data = all.ca.both, x = all.ca.both$PET_4yr_2002, y = all.ca.both$PET_4yr_2015, paired = TRUE)
PET_4yr.2015.t <- t.test(data = all.ca.2015, x = all.ca.2015$PET_4yr_2002, y = all.ca.2015$PET_4yr_2015, paired = TRUE)
#four-year Precip
ppt_4yr.both.t <- t.test(data = all.ca.both, x = all.ca.both$ppt_4yr_2002, y = all.ca.both$ppt_4yr_2015, paired = TRUE)
ppt_4yr.2015.t <- t.test(data = all.ca.2015, x = all.ca.2015$ppt_4yr_2002, y = all.ca.2015$ppt_4yr_2015, paired = TRUE)
#four-year ET
ET_4yr.both.t <- t.test(data = all.ca.both, x = all.ca.both$ET_4yr_2002, y = all.ca.both$ET_4yr_2015, paired = TRUE)
ET_4yr.2015.t <- t.test(data = all.ca.2015, x = all.ca.2015$ET_4yr_2002, y = all.ca.2015$ET_4yr_2015, paired = TRUE)
#four-year Tmax
tmax_4yr.both.t <- t.test(data = all.ca.both, x = all.ca.both$tmax_4yr_2002, y = all.ca.both$tmax_4yr_2015, paired = TRUE)
tmax_4yr.2015.t <- t.test(data = all.ca.2015, x = all.ca.2015$tmax_4yr_2002, y = all.ca.2015$tmax_4yr_2015, paired = TRUE)
#dNDMI
dNDMI.both.t <- t.test(data = all.ca.both, x = all.ca.both$dNDMI_2004, y = all.ca.both$dNDMI_2017, paired = TRUE)
dNDMI.2015.t <- t.test(data = all.ca.2015, x = all.ca.2015$dNDMI_2004, y = all.ca.2015$dNDMI_2017, paired = TRUE)
#Combine all the t-test results in a list
t <- list(biomass.both.t, biomass.2015.t, dNDMI.both.t, dNDMI.2015.t,
PET_4yr.both.t, PET_4yr.2015.t, tmax_4yr.both.t, tmax_4yr.2015.t)
#Combine the t-test results in a data frame
df.t <- as.data.frame(purrr::map_df(t, tidy))
all.ca.sample %>% filter(drought == '1999-2002' & sequence == 'Both Droughts' & region == 'Southern California') %>% count()
all.ca.sample %>% filter(drought == '1999-2002' & sequence == 'Both Droughts' & region == 'Sierra Nevada') %>% count()
all.ca.sample %>% filter(drought == '1999-2002' & sequence == '2nd Drought Only' & region == 'Southern California') %>% count()
all.ca.sample %>% filter(drought == '1999-2002' & sequence == '2nd Drought Only' & region == 'Sierra Nevada') %>% count()
dataset.2 <- all.ca.sample %>% dplyr::filter(sequence == 'Both Droughts' | sequence == '2012-2015 Only') %>%
dplyr::select('PET_4yr', 'ET_4yr', 'ppt_4yr', 'dNDMI', 'drought.f', 'sequence.f', 'biomass', 'pixel.id', 'tmax_4yr', 'ADS.cat')
#Convert dummy variables to factors
dataset$sequence.f <- as.factor(dataset$sequence.c)
dataset$drought.f <- as.factor(dataset$drought.c)
task = makeClassifTask(data = dataset, target = "sequence.f")
task.under = undersample(task, rate = 0.2)
#The undersampled dataset
dataset.under <- getTaskData(task.under)
dataset.under$dNDMI.scale <- scale(dataset.under$dNDMI)
dataset.under$PET_4yr.scale <- scale(dataset.under$PET_4yr)
dataset.under$biomass.scale <- scale(dataset.under$biomass)
dataset.under$tmax_4yr.scale <- scale(dataset.under$tmax_4yr)
dataset.under$sequence.scale <- scale(as.numeric(dataset.under$sequence.f))
dataset.under$drought.scale <- scale(as.numeric(dataset.under$drought.f))
all.ca.sample %>% filter(drought == '1999-2002' & sequence == 'Both Droughts' & region == 'Southern California') %>% count()
all.ca.sample %>% filter(drought == '1999-2002' & sequence == 'Both Droughts' & region == 'Sierra Nevada') %>% count()
all.ca.sample %>% filter(drought == '1999-2002' & sequence == '2nd Drought Only' & region == 'Southern California') %>% count()
all.ca.sample %>% filter(drought == '1999-2002' & sequence == '2nd Drought Only' & region == 'Sierra Nevada') %>% count()
dataset.2 <- all.ca.sample %>% dplyr::filter(sequence == 'Both Droughts' | sequence == '2012-2015 Only') %>%
dplyr::select('PET_4yr', 'ET_4yr', 'ppt_4yr', 'dNDMI', 'drought.f', 'sequence.f', 'biomass', 'pixel.id', 'tmax_4yr', 'ADS.cat')
all.ca.sample
all.ca.sample %>% summary()
all.ca.sample$sequence.f <- as.factor(all.ca.sample$sequence.c)
all.ca.sample$drought.f <- as.factor(all.ca.sample$drought.c)
all.ca.sample %>% filter(drought == '1999-2002' & sequence == 'Both Droughts' & region == 'Southern California') %>% count()
all.ca.sample %>% filter(drought == '1999-2002' & sequence == 'Both Droughts' & region == 'Sierra Nevada') %>% count()
all.ca.sample %>% filter(drought == '1999-2002' & sequence == '2nd Drought Only' & region == 'Southern California') %>% count()
all.ca.sample %>% filter(drought == '1999-2002' & sequence == '2nd Drought Only' & region == 'Sierra Nevada') %>% count()
#Store filtered and sampled drought sequence data as its own vector
dataset.2 <- all.ca.sample %>% dplyr::filter(sequence == 'Both Droughts' | sequence == '2012-2015 Only') %>%
dplyr::select('PET_4yr', 'ET_4yr', 'ppt_4yr', 'dNDMI', 'drought.f', 'sequence.f', 'biomass', 'pixel.id', 'tmax_4yr', 'ADS.cat')
#Create a task to use with the caret package
task.2 <- makeClassifTask(data = dataset.2, target = "sequence.f")
#Under sample the data by 20%
task.2.under <- undersample(task.2, rate = 0.2)
#Get the actual data o]ut of the caret task
dataset.2.under <- getTaskData(task.2.under)
#Make variables into dummy categorical variables for statistical analysis
dataset.2.under <- dataset.2.under %>% mutate(sequence = case_when(
sequence.f == 0 ~ 'Both Droughts',
sequence.f == 1 ~ '2012-2015 Only'))
#Create column with the years for the data as a string
dataset.2.under <- dataset.2.under %>% mutate(drought = case_when(
drought.f == 0 ~ '1999-2002',
drought.f == 1 ~ '2012-2015'))
all.ca.sample$sequence.f <- as.factor(all.ca.sample$sequence)
all.ca.sample$drought.f <- as.factor(all.ca.sample$drought)
all.ca.sample %>% filter(drought == '1999-2002' & sequence == 'Both Droughts' & region == 'Southern California') %>% count()
all.ca.sample %>% filter(drought == '1999-2002' & sequence == 'Both Droughts' & region == 'Sierra Nevada') %>% count()
all.ca.sample %>% filter(drought == '1999-2002' & sequence == '2nd Drought Only' & region == 'Southern California') %>% count()
all.ca.sample %>% filter(drought == '1999-2002' & sequence == '2nd Drought Only' & region == 'Sierra Nevada') %>% count()
#Store filtered and sampled drought sequence data as its own vector
dataset.2 <- all.ca.sample %>% dplyr::filter(sequence == 'Both Droughts' | sequence == '2012-2015 Only') %>%
dplyr::select('PET_4yr', 'ET_4yr', 'ppt_4yr', 'dNDMI', 'drought.f', 'sequence.f', 'biomass', 'pixel.id', 'tmax_4yr', 'ADS.cat')
#Create a task to use with the caret package
task.2 <- makeClassifTask(data = dataset.2, target = "sequence.f")
#Under sample the data by 20%
task.2.under <- undersample(task.2, rate = 0.2)
#Get the actual data o]ut of the caret task
dataset.2.under <- getTaskData(task.2.under)
#Make variables into dummy categorical variables for statistical analysis
dataset.2.under <- dataset.2.under %>% mutate(sequence = case_when(
sequence.f == 0 ~ 'Both Droughts',
sequence.f == 1 ~ '2012-2015 Only'))
#Create column with the years for the data as a string
dataset.2.under <- dataset.2.under %>% mutate(drought = case_when(
drought.f == 0 ~ '1999-2002',
drought.f == 1 ~ '2012-2015'))
#Sort the data by drought and pixel.id to prepare for Chi-squared test
dataset.3 <- dataset.2.under %>% arrange(drought.f, pixel.id, by_group = TRUE)
#Combined anova/t-test analysis for Biomass by year collected and drought sequence
biomass.aov <- aov(data = dataset.2.under, biomass ~ drought*sequence)
#Tukey Post Hoc analysis for biomass
biomass.tHSD <- TukeyHSD(biomass.aov)
#ANOVA for Pr-ET
PET_4yr.aov <- aov(data = dataset.2.under, PET_4yr ~ drought*sequence)
#Tukey Post Hoc analysis for Pr-ET
PET_4yr.tHSD <- TukeyHSD(PET_4yr.aov)
#ANOVA for Precip
ppt_4yr.aov <- aov(data = dataset.2.under, ppt_4yr ~ drought*sequence)
#Tukey Post Hoc analysis for Pr-ET
ppt_4yr.tHSD <- TukeyHSD(ppt_4yr.aov)
#ANOVA for ET
ET_4yr.aov <- aov(data = dataset.2.under, ET_4yr ~ drought*sequence)
#Tukey Post Hoc analysis for ET
ET_4yr.tHSD <- TukeyHSD(ET_4yr.aov)
#ANOVA for Tmax
tmax_4yr.aov <- aov(data = dataset.2.under, tmax_4yr ~ drought*sequence)
#Tukey Post Hoc analysis for Tmax
tmax_4yr.tHSD <- TukeyHSD(tmax_4yr.aov)
#ANOVA for dNDMI
dNDMI.aov <- aov(data = dataset.2.under, dNDMI ~ drought*sequence)
#Tukey Post Hoc analysis for dNDMI
dNDMI.tHSD <- TukeyHSD(dNDMI.aov)
#Create a combined a list of Tukey HSD tests
tHSD <- list(biomass.tHSD, dNDMI.tHSD,
PET_4yr.tHSD, tmax_4yr.tHSD)
#Create a data frame of tukey HSD tests
df.tHSD <- as.data.frame(purrr::map_df(tHSD, tidy))
#Create labels for columns in HTML format
df.tHSD$variable <- c('Biomass (Mg ha<sup>-1</sup>)', 'Biomass (Mg ha<sup>-1</sup>)', 'Biomass (Mg ha<sup>-1</sup>)', 'Biomass (Mg ha<sup>-1</sup>)', 'Biomass (Mg ha<sup>-1</sup>)', 'Biomass (Mg ha<sup>-1</sup>)', 'Biomass (Mg ha<sup>-1</sup>)', 'Biomass (Mg ha<sup>-1</sup>)',
'dNDMI', 'dNDMI', 'dNDMI', 'dNDMI', 'dNDMI', 'dNDMI', 'dNDMI', 'dNDMI',
'Pr-ET (mm 4yr<sup>-1</sup>)', 'Pr-ET (mm 4yr<sup>-1</sup>)', 'Pr-ET (mm 4yr<sup>-1</sup>)', 'Pr-ET (mm 4yr<sup>-1</sup>)', 'Pr-ET (mm 4yr<sup>-1</sup>)', 'Pr-ET (mm 4yr<sup>-1</sup>)', 'Pr-ET (mm 4yr<sup>-1</sup>)', 'Pr-ET (mm 4yr<sup>-1</sup>)',
'Temperature (C)', 'Temperature (C)', 'Temperature (C)', 'Temperature (C)', 'Temperature (C)', 'Temperature (C)', 'Temperature (C)', 'Temperature (C)')
#Get the sample size for the two main drought sequences
dataset.2.under %>% filter(sequence == '2012-2015 Only' & drought == '1999-2002') %>% count()
dataset.2.under %>% filter(sequence == 'Both Droughts' & drought == '1999-2002') %>% count()
#Add mean values for Estimate 1
df.tHSD$estimate.1 <- c(#Biomass density
mean((dataset.2.under %>% filter(drought == '2012-2015'))$biomass), mean((dataset.2.under %>% filter(sequence == 'Both Droughts'))$biomass),
mean((dataset.2.under %>% filter(drought == '2012-2015' & sequence == '2012-2015 Only'))$biomass), mean((dataset.2.under %>% filter(drought == '1999-2002' & sequence == 'Both Droughts'))$biomass),
mean((dataset.2.under %>% filter(drought == '2012-2015' & sequence == 'Both Droughts'))$biomass), mean((dataset.2.under %>% filter(drought == '1999-2002' & sequence == 'Both Droughts'))$biomass),
mean((dataset.2.under %>% filter(drought == '2012-2015' & sequence == 'Both Droughts'))$biomass), mean((dataset.2.under %>% filter(drought == '2012-2015' & sequence == 'Both Droughts'))$biomass),
#dNDMI
mean((dataset.2.under %>% filter(drought == '2012-2015'))$dNDMI), mean((dataset.2.under %>% filter(sequence == 'Both Droughts'))$dNDMI),
mean((dataset.2.under %>% filter(drought == '2012-2015' & sequence == '2012-2015 Only'))$dNDMI), mean((dataset.2.under %>% filter(drought == '1999-2002' & sequence == 'Both Droughts'))$dNDMI),
mean((dataset.2.under %>% filter(drought == '2012-2015' & sequence == 'Both Droughts'))$dNDMI), mean((dataset.2.under %>% filter(drought == '1999-2002' & sequence == 'Both Droughts'))$dNDMI),
mean((dataset.2.under %>% filter(drought == '2012-2015' & sequence == 'Both Droughts'))$dNDMI), mean((dataset.2.under %>% filter(drought == '2012-2015' & sequence == 'Both Droughts'))$dNDMI),
#PET 4yr
mean((dataset.2.under %>% filter(drought == '2012-2015'))$PET_4yr), mean((dataset.2.under %>% filter(sequence == 'Both Droughts'))$PET_4yr),
mean((dataset.2.under %>% filter(drought == '2012-2015' & sequence == '2012-2015 Only'))$PET_4yr), mean((dataset.2.under %>% filter(drought == '1999-2002' & sequence == 'Both Droughts'))$PET_4yr),
mean((dataset.2.under %>% filter(drought == '2012-2015' & sequence == 'Both Droughts'))$PET_4yr), mean((dataset.2.under %>% filter(drought == '1999-2002' & sequence == 'Both Droughts'))$PET_4yr),
mean((dataset.2.under %>% filter(drought == '2012-2015' & sequence == 'Both Droughts'))$PET_4yr), mean((dataset.2.under %>% filter(drought == '2012-2015' & sequence == 'Both Droughts'))$PET_4yr),
#Temperature 4yr
mean((dataset.2.under %>% filter(drought == '2012-2015'))$tmax_4yr), mean((dataset.2.under %>% filter(sequence == 'Both Droughts'))$tmax_4yr),
mean((dataset.2.under %>% filter(drought == '2012-2015' & sequence == '2012-2015 Only'))$tmax_4yr), mean((dataset.2.under %>% filter(drought == '1999-2002' & sequence == 'Both Droughts'))$tmax_4yr),
mean((dataset.2.under %>% filter(drought == '2012-2015' & sequence == 'Both Droughts'))$tmax_4yr), mean((dataset.2.under %>% filter(drought == '1999-2002' & sequence == 'Both Droughts'))$tmax_4yr),
mean((dataset.2.under %>% filter(drought == '2012-2015' & sequence == 'Both Droughts'))$tmax_4yr), mean((dataset.2.under %>% filter(drought == '2012-2015' & sequence == 'Both Droughts'))$tmax_4yr))
#Add mean values for Estimate 2
df.tHSD$estimate.2 <- c(#Biomass
mean((dataset.2.under %>% filter(drought == '1999-2002'))$biomass), mean((dataset.2.under %>% filter(sequence == '2012-2015 Only'))$biomass),
mean((dataset.2.under %>% filter(drought == '1999-2002' & sequence == '2012-2015 Only'))$biomass), mean((dataset.2.under %>% filter(drought == '1999-2002' & sequence == '2012-2015 Only'))$biomass),
mean((dataset.2.under %>% filter(drought == '1999-2002' & sequence == '2012-2015 Only'))$biomass), mean((dataset.2.under %>% filter(drought == '2012-2015' & sequence == '2012-2015 Only'))$biomass),
mean((dataset.2.under %>% filter(drought == '2012-2015' & sequence == '2012-2015 Only'))$biomass), mean((dataset.2.under %>% filter(drought == '1999-2002' & sequence == 'Both Droughts'))$biomass),
#dNDMI
mean((dataset.2.under %>% filter(drought == '1999-2002'))$dNDMI), mean((dataset.2.under %>% filter(sequence == '2012-2015 Only'))$dNDMI),
mean((dataset.2.under %>% filter(drought == '1999-2002' & sequence == '2012-2015 Only'))$dNDMI), mean((dataset.2.under %>% filter(drought == '1999-2002' & sequence == '2012-2015 Only'))$dNDMI),
mean((dataset.2.under %>% filter(drought == '1999-2002' & sequence == '2012-2015 Only'))$dNDMI), mean((dataset.2.under %>% filter(drought == '2012-2015' & sequence == '2012-2015 Only'))$dNDMI),
mean((dataset.2.under %>% filter(drought == '2012-2015' & sequence == '2012-2015 Only'))$dNDMI), mean((dataset.2.under %>% filter(drought == '1999-2002' & sequence == 'Both Droughts'))$dNDMI),
#PrET 4yr
mean((dataset.2.under %>% filter(drought == '1999-2002'))$PET_4yr), mean((dataset.2.under %>% filter(sequence == '2012-2015 Only'))$PET_4yr),
mean((dataset.2.under %>% filter(drought == '1999-2002' & sequence == '2012-2015 Only'))$PET_4yr), mean((dataset.2.under %>% filter(drought == '1999-2002' & sequence == '2012-2015 Only'))$PET_4yr),
mean((dataset.2.under %>% filter(drought == '1999-2002' & sequence == '2012-2015 Only'))$PET_4yr), mean((dataset.2.under %>% filter(drought == '2012-2015' & sequence == '2012-2015 Only'))$PET_4yr),
mean((dataset.2.under %>% filter(drought == '2012-2015' & sequence == '2012-2015 Only'))$PET_4yr), mean((dataset.2.under %>% filter(drought == '1999-2002' & sequence == 'Both Droughts'))$PET_4yr),
#Tmax 4yr
mean((dataset.2.under %>% filter(drought == '1999-2002'))$tmax_4yr), mean((dataset.2.under %>% filter(sequence == '2012-2015 Only'))$tmax_4yr),
mean((dataset.2.under %>% filter(drought == '1999-2002' & sequence == '2012-2015 Only'))$tmax_4yr), mean((dataset.2.under %>% filter(drought == '1999-2002' & sequence == '2012-2015 Only'))$tmax_4yr),
mean((dataset.2.under %>% filter(drought == '1999-2002' & sequence == '2012-2015 Only'))$tmax_4yr), mean((dataset.2.under %>% filter(drought == '2012-2015' & sequence == '2012-2015 Only'))$tmax_4yr),
mean((dataset.2.under %>% filter(drought == '2012-2015' & sequence == '2012-2015 Only'))$tmax_4yr), mean((dataset.2.under %>% filter(drought == '1999-2002' & sequence == 'Both Droughts'))$tmax_4yr))
#Select and sort the tukey HSD columns and
df.tHSD.pub <- df.tHSD %>% dplyr::select(variable, contrast, estimate.1, estimate.2, estimate, conf.low, conf.high, adj.p.value)
#Name the columns of the data frame
colnames(df.tHSD.pub) <- c('Variable', 'Comparison', 'Estimate 1', 'Estimate 2','Difference', 'Low 95% CI', 'High 95% CI', 'p-value')
summary(all.ca.sample)
dataset.2 %>% summary()
dataset.2 <- all.ca.sample %>% dplyr::filter(sequence == 'Both Droughts' | sequence == '2nd Drought Only') %>%
dplyr::select('PET_4yr', 'ET_4yr', 'ppt_4yr', 'dNDMI', 'drought.f', 'sequence.f', 'biomass', 'pixel.id', 'tmax_4yr', 'ADS.cat')
dataset.2 %>% summary()
#Create a task to use with the caret package
task.2 <- makeClassifTask(data = dataset.2, target = "sequence.f")
View(task.2)
task.2.under <- undersample(task.2, rate = 0.2)
dataset.2.under <- dataset.2.under %>% mutate(sequence = case_when(
sequence.f == 0 ~ 'Both Droughts',
sequence.f == 1 ~ '2nd Drought Only'))
#Create column with the years for the data as a string
dataset.2.under <- dataset.2.under %>% mutate(drought = case_when(
drought.f == 0 ~ '1999-2002',
drought.f == 1 ~ '2012-2015'))
#Sort the data by drought and pixel.id to prepare for Chi-squared test
dataset.3 <- dataset.2.under %>% arrange(drought.f, pixel.id, by_group = TRUE)
#Combined anova/t-test analysis for Biomass by year collected and drought sequence
biomass.aov <- aov(data = dataset.2.under, biomass ~ drought*sequence)
#Tukey Post Hoc analysis for biomass
biomass.tHSD <- TukeyHSD(biomass.aov)
#ANOVA for Pr-ET
PET_4yr.aov <- aov(data = dataset.2.under, PET_4yr ~ drought*sequence)
#Tukey Post Hoc analysis for Pr-ET
PET_4yr.tHSD <- TukeyHSD(PET_4yr.aov)
#ANOVA for Precip
ppt_4yr.aov <- aov(data = dataset.2.under, ppt_4yr ~ drought*sequence)
#Tukey Post Hoc analysis for Pr-ET
ppt_4yr.tHSD <- TukeyHSD(ppt_4yr.aov)
#ANOVA for ET
ET_4yr.aov <- aov(data = dataset.2.under, ET_4yr ~ drought*sequence)
#Tukey Post Hoc analysis for ET
ET_4yr.tHSD <- TukeyHSD(ET_4yr.aov)
#ANOVA for Tmax
tmax_4yr.aov <- aov(data = dataset.2.under, tmax_4yr ~ drought*sequence)
#Tukey Post Hoc analysis for Tmax
tmax_4yr.tHSD <- TukeyHSD(tmax_4yr.aov)
#ANOVA for dNDMI
dNDMI.aov <- aov(data = dataset.2.under, dNDMI ~ drought*sequence)
#Tukey Post Hoc analysis for dNDMI
dNDMI.tHSD <- TukeyHSD(dNDMI.aov)
#Create a combined a list of Tukey HSD tests
tHSD <- list(biomass.tHSD, dNDMI.tHSD,
PET_4yr.tHSD, tmax_4yr.tHSD)
#Create a data frame of tukey HSD tests
df.tHSD <- as.data.frame(purrr::map_df(tHSD, tidy))
dataset.2.under
#Get the actual data o]ut of the caret task
dataset.2.under <- getTaskData(task.2.under)
dataset.2.under <- dataset.2.under %>% mutate(sequence = case_when(
sequence.f == 0 ~ 'Both Droughts',
sequence.f == 1 ~ '2nd Drought Only'))
#Create column with the years for the data as a string
dataset.2.under <- dataset.2.under %>% mutate(drought = case_when(
drought.f == 0 ~ '1999-2002',
drought.f == 1 ~ '2012-2015'))
#Sort the data by drought and pixel.id to prepare for Chi-squared test
dataset.3 <- dataset.2.under %>% arrange(drought.f, pixel.id, by_group = TRUE)
#Combined anova/t-test analysis for Biomass by year collected and drought sequence
biomass.aov <- aov(data = dataset.2.under, biomass ~ drought*sequence)
#Tukey Post Hoc analysis for biomass
biomass.tHSD <- TukeyHSD(biomass.aov)
#ANOVA for Pr-ET
PET_4yr.aov <- aov(data = dataset.2.under, PET_4yr ~ drought*sequence)
#Tukey Post Hoc analysis for Pr-ET
PET_4yr.tHSD <- TukeyHSD(PET_4yr.aov)
#ANOVA for Precip
ppt_4yr.aov <- aov(data = dataset.2.under, ppt_4yr ~ drought*sequence)
#Tukey Post Hoc analysis for Pr-ET
ppt_4yr.tHSD <- TukeyHSD(ppt_4yr.aov)
#ANOVA for ET
ET_4yr.aov <- aov(data = dataset.2.under, ET_4yr ~ drought*sequence)
#Tukey Post Hoc analysis for ET
ET_4yr.tHSD <- TukeyHSD(ET_4yr.aov)
#ANOVA for Tmax
tmax_4yr.aov <- aov(data = dataset.2.under, tmax_4yr ~ drought*sequence)
#Tukey Post Hoc analysis for Tmax
tmax_4yr.tHSD <- TukeyHSD(tmax_4yr.aov)
#ANOVA for dNDMI
dNDMI.aov <- aov(data = dataset.2.under, dNDMI ~ drought*sequence)
#Tukey Post Hoc analysis for dNDMI
dNDMI.tHSD <- TukeyHSD(dNDMI.aov)
#Create a combined a list of Tukey HSD tests
tHSD <- list(biomass.tHSD, dNDMI.tHSD,
PET_4yr.tHSD, tmax_4yr.tHSD)
#Create a data frame of tukey HSD tests
df.tHSD <- as.data.frame(purrr::map_df(tHSD, tidy))
#Create labels for columns in HTML format
df.tHSD$variable <- c('Biomass (Mg ha<sup>-1</sup>)', 'Biomass (Mg ha<sup>-1</sup>)', 'Biomass (Mg ha<sup>-1</sup>)', 'Biomass (Mg ha<sup>-1</sup>)', 'Biomass (Mg ha<sup>-1</sup>)', 'Biomass (Mg ha<sup>-1</sup>)', 'Biomass (Mg ha<sup>-1</sup>)', 'Biomass (Mg ha<sup>-1</sup>)',
'dNDMI', 'dNDMI', 'dNDMI', 'dNDMI', 'dNDMI', 'dNDMI', 'dNDMI', 'dNDMI',
'Pr-ET (mm 4yr<sup>-1</sup>)', 'Pr-ET (mm 4yr<sup>-1</sup>)', 'Pr-ET (mm 4yr<sup>-1</sup>)', 'Pr-ET (mm 4yr<sup>-1</sup>)', 'Pr-ET (mm 4yr<sup>-1</sup>)', 'Pr-ET (mm 4yr<sup>-1</sup>)', 'Pr-ET (mm 4yr<sup>-1</sup>)', 'Pr-ET (mm 4yr<sup>-1</sup>)',
'Temperature (C)', 'Temperature (C)', 'Temperature (C)', 'Temperature (C)', 'Temperature (C)', 'Temperature (C)', 'Temperature (C)', 'Temperature (C)')
#Get the sample size for the two main drought sequences
dataset.2.under %>% filter(sequence == '2012-2015 Only' & drought == '1999-2002') %>% count()
dataset.2.under %>% filter(sequence == 'Both Droughts' & drought == '1999-2002') %>% count()
#Combined anova/t-test analysis for Biomass by year collected and drought sequence
biomass.aov <- aov(data = dataset.2.under, biomass ~ drought* as.factor(sequence))
#Combined anova/t-test analysis for Biomass by year collected and drought sequence
#There now seems to an error is starting here about factors
summary(dataset.under.2)
#Combined anova/t-test analysis for Biomass by year collected and drought sequence
#There now seems to an error is starting here about factors
summary(dataset.2.under)
biomass.aov <- aov(data = dataset.2.under, biomass ~ drought.f*sequence.f)
biomass.tHSD <- TukeyHSD(biomass.aov)
#ANOVA for Pr-ET
PET_4yr.aov <- aov(data = dataset.2.under, PET_4yr ~ drought.f*sequence.f)
#Tukey Post Hoc analysis for Pr-ET
PET_4yr.tHSD <- TukeyHSD(PET_4yr.aov)
#ANOVA for Precip
ppt_4yr.aov <- aov(data = dataset.2.under, ppt_4yr ~ drought.f*sequence.f)
#Tukey Post Hoc analysis for Pr-ET
ppt_4yr.tHSD <- TukeyHSD(ppt_4yr.aov)
#ANOVA for ET
ET_4yr.aov <- aov(data = dataset.2.under, ET_4yr ~ drought.f*sequence.f)
#Tukey Post Hoc analysis for ET
ET_4yr.tHSD <- TukeyHSD(ET_4yr.aov)
#ANOVA for Tmax
tmax_4yr.aov <- aov(data = dataset.2.under, tmax_4yr ~ drought.f*sequence.f)
#Tukey Post Hoc analysis for Tmax
tmax_4yr.tHSD <- TukeyHSD(tmax_4yr.aov)
#ANOVA for dNDMI
dNDMI.aov <- aov(data = dataset.2.under, dNDMI ~ drought.f*sequence.f)
dNDMI.tHSD <- TukeyHSD(dNDMI.aov)
#Create a combined a list of Tukey HSD tests
tHSD <- list(biomass.tHSD, dNDMI.tHSD,
PET_4yr.tHSD, tmax_4yr.tHSD)
#Create a data frame of tukey HSD tests
df.tHSD <- as.data.frame(purrr::map_df(tHSD, tidy))
#Create labels for columns in HTML format
df.tHSD$variable <- c('Biomass (Mg ha<sup>-1</sup>)', 'Biomass (Mg ha<sup>-1</sup>)', 'Biomass (Mg ha<sup>-1</sup>)', 'Biomass (Mg ha<sup>-1</sup>)', 'Biomass (Mg ha<sup>-1</sup>)', 'Biomass (Mg ha<sup>-1</sup>)', 'Biomass (Mg ha<sup>-1</sup>)', 'Biomass (Mg ha<sup>-1</sup>)',
'dNDMI', 'dNDMI', 'dNDMI', 'dNDMI', 'dNDMI', 'dNDMI', 'dNDMI', 'dNDMI',
'Pr-ET (mm 4yr<sup>-1</sup>)', 'Pr-ET (mm 4yr<sup>-1</sup>)', 'Pr-ET (mm 4yr<sup>-1</sup>)', 'Pr-ET (mm 4yr<sup>-1</sup>)', 'Pr-ET (mm 4yr<sup>-1</sup>)', 'Pr-ET (mm 4yr<sup>-1</sup>)', 'Pr-ET (mm 4yr<sup>-1</sup>)', 'Pr-ET (mm 4yr<sup>-1</sup>)',
'Temperature (C)', 'Temperature (C)', 'Temperature (C)', 'Temperature (C)', 'Temperature (C)', 'Temperature (C)', 'Temperature (C)', 'Temperature (C)')
#Get the sample size for the two main drought sequences
dataset.2.under %>% filter(sequence == '2012-2015 Only' & drought == '1999-2002') %>% count()
dataset.2.under %>% filter(sequence == 'Both Droughts' & drought == '1999-2002') %>% count()
df.tHSD$estimate.1 <- c(#Biomass density
mean((dataset.2.under %>% filter(drought == '2012-2015'))$biomass), mean((dataset.2.under %>% filter(sequence == 'Both Droughts'))$biomass),
mean((dataset.2.under %>% filter(drought == '2012-2015' & sequence == '2012-2015 Only'))$biomass), mean((dataset.2.under %>% filter(drought == '1999-2002' & sequence == 'Both Droughts'))$biomass),
mean((dataset.2.under %>% filter(drought == '2012-2015' & sequence == 'Both Droughts'))$biomass), mean((dataset.2.under %>% filter(drought == '1999-2002' & sequence == 'Both Droughts'))$biomass),
mean((dataset.2.under %>% filter(drought == '2012-2015' & sequence == 'Both Droughts'))$biomass), mean((dataset.2.under %>% filter(drought == '2012-2015' & sequence == 'Both Droughts'))$biomass),
#dNDMI
mean((dataset.2.under %>% filter(drought == '2012-2015'))$dNDMI), mean((dataset.2.under %>% filter(sequence == 'Both Droughts'))$dNDMI),
mean((dataset.2.under %>% filter(drought == '2012-2015' & sequence == '2012-2015 Only'))$dNDMI), mean((dataset.2.under %>% filter(drought == '1999-2002' & sequence == 'Both Droughts'))$dNDMI),
mean((dataset.2.under %>% filter(drought == '2012-2015' & sequence == 'Both Droughts'))$dNDMI), mean((dataset.2.under %>% filter(drought == '1999-2002' & sequence == 'Both Droughts'))$dNDMI),
mean((dataset.2.under %>% filter(drought == '2012-2015' & sequence == 'Both Droughts'))$dNDMI), mean((dataset.2.under %>% filter(drought == '2012-2015' & sequence == 'Both Droughts'))$dNDMI),
#PET 4yr
mean((dataset.2.under %>% filter(drought == '2012-2015'))$PET_4yr), mean((dataset.2.under %>% filter(sequence == 'Both Droughts'))$PET_4yr),
mean((dataset.2.under %>% filter(drought == '2012-2015' & sequence == '2012-2015 Only'))$PET_4yr), mean((dataset.2.under %>% filter(drought == '1999-2002' & sequence == 'Both Droughts'))$PET_4yr),
mean((dataset.2.under %>% filter(drought == '2012-2015' & sequence == 'Both Droughts'))$PET_4yr), mean((dataset.2.under %>% filter(drought == '1999-2002' & sequence == 'Both Droughts'))$PET_4yr),
mean((dataset.2.under %>% filter(drought == '2012-2015' & sequence == 'Both Droughts'))$PET_4yr), mean((dataset.2.under %>% filter(drought == '2012-2015' & sequence == 'Both Droughts'))$PET_4yr),
#Temperature 4yr
mean((dataset.2.under %>% filter(drought == '2012-2015'))$tmax_4yr), mean((dataset.2.under %>% filter(sequence == 'Both Droughts'))$tmax_4yr),
mean((dataset.2.under %>% filter(drought == '2012-2015' & sequence == '2012-2015 Only'))$tmax_4yr), mean((dataset.2.under %>% filter(drought == '1999-2002' & sequence == 'Both Droughts'))$tmax_4yr),
mean((dataset.2.under %>% filter(drought == '2012-2015' & sequence == 'Both Droughts'))$tmax_4yr), mean((dataset.2.under %>% filter(drought == '1999-2002' & sequence == 'Both Droughts'))$tmax_4yr),
mean((dataset.2.under %>% filter(drought == '2012-2015' & sequence == 'Both Droughts'))$tmax_4yr), mean((dataset.2.under %>% filter(drought == '2012-2015' & sequence == 'Both Droughts'))$tmax_4yr))
#Add mean values for Estimate 2
df.tHSD$estimate.2 <- c(#Biomass
mean((dataset.2.under %>% filter(drought == '1999-2002'))$biomass), mean((dataset.2.under %>% filter(sequence == '2012-2015 Only'))$biomass),
mean((dataset.2.under %>% filter(drought == '1999-2002' & sequence == '2012-2015 Only'))$biomass), mean((dataset.2.under %>% filter(drought == '1999-2002' & sequence == '2012-2015 Only'))$biomass),
mean((dataset.2.under %>% filter(drought == '1999-2002' & sequence == '2012-2015 Only'))$biomass), mean((dataset.2.under %>% filter(drought == '2012-2015' & sequence == '2012-2015 Only'))$biomass),
mean((dataset.2.under %>% filter(drought == '2012-2015' & sequence == '2012-2015 Only'))$biomass), mean((dataset.2.under %>% filter(drought == '1999-2002' & sequence == 'Both Droughts'))$biomass),
#dNDMI
mean((dataset.2.under %>% filter(drought == '1999-2002'))$dNDMI), mean((dataset.2.under %>% filter(sequence == '2012-2015 Only'))$dNDMI),
mean((dataset.2.under %>% filter(drought == '1999-2002' & sequence == '2012-2015 Only'))$dNDMI), mean((dataset.2.under %>% filter(drought == '1999-2002' & sequence == '2012-2015 Only'))$dNDMI),
mean((dataset.2.under %>% filter(drought == '1999-2002' & sequence == '2012-2015 Only'))$dNDMI), mean((dataset.2.under %>% filter(drought == '2012-2015' & sequence == '2012-2015 Only'))$dNDMI),
mean((dataset.2.under %>% filter(drought == '2012-2015' & sequence == '2012-2015 Only'))$dNDMI), mean((dataset.2.under %>% filter(drought == '1999-2002' & sequence == 'Both Droughts'))$dNDMI),
#PrET 4yr
mean((dataset.2.under %>% filter(drought == '1999-2002'))$PET_4yr), mean((dataset.2.under %>% filter(sequence == '2012-2015 Only'))$PET_4yr),
mean((dataset.2.under %>% filter(drought == '1999-2002' & sequence == '2012-2015 Only'))$PET_4yr), mean((dataset.2.under %>% filter(drought == '1999-2002' & sequence == '2012-2015 Only'))$PET_4yr),
mean((dataset.2.under %>% filter(drought == '1999-2002' & sequence == '2012-2015 Only'))$PET_4yr), mean((dataset.2.under %>% filter(drought == '2012-2015' & sequence == '2012-2015 Only'))$PET_4yr),
mean((dataset.2.under %>% filter(drought == '2012-2015' & sequence == '2012-2015 Only'))$PET_4yr), mean((dataset.2.under %>% filter(drought == '1999-2002' & sequence == 'Both Droughts'))$PET_4yr),
#Tmax 4yr
mean((dataset.2.under %>% filter(drought == '1999-2002'))$tmax_4yr), mean((dataset.2.under %>% filter(sequence == '2012-2015 Only'))$tmax_4yr),
mean((dataset.2.under %>% filter(drought == '1999-2002' & sequence == '2012-2015 Only'))$tmax_4yr), mean((dataset.2.under %>% filter(drought == '1999-2002' & sequence == '2012-2015 Only'))$tmax_4yr),
mean((dataset.2.under %>% filter(drought == '1999-2002' & sequence == '2012-2015 Only'))$tmax_4yr), mean((dataset.2.under %>% filter(drought == '2012-2015' & sequence == '2012-2015 Only'))$tmax_4yr),
mean((dataset.2.under %>% filter(drought == '2012-2015' & sequence == '2012-2015 Only'))$tmax_4yr), mean((dataset.2.under %>% filter(drought == '1999-2002' & sequence == 'Both Droughts'))$tmax_4yr))
#Select and sort the tukey HSD columns and
df.tHSD.pub <- df.tHSD %>% dplyr::select(variable, contrast, estimate.1, estimate.2, estimate, conf.low, conf.high, adj.p.value)
#Name the columns of the data frame
colnames(df.tHSD.pub) <- c('Variable', 'Comparison', 'Estimate 1', 'Estimate 2','Difference', 'Low 95% CI', 'High 95% CI', 'p-value')
#ANOVA and Tukey HSD comparing by time period and drought sequence
tb1 <- kbl(df.tHSD.pub, format = 'html', caption = "Table S2: ANOVA and Tukey HSD Results", digits = 3, escape = F) %>% kable_classic_2(font_size = 14, full_width = F)
as_image(x = tb1, width = 10, file = "STable1_tHSD_test_results.png", zoom = 5.0)
#Create same table as Table 1, but add a percent change column, not included with manuscript
#Calculate proportion differences from Tukey HSD tests
df.tHSD$diff.pct <- df.tHSD$estimate / df.tHSD$estimate.1 * 100
df.tHSD$low.pct <- df.tHSD$conf.low / df.tHSD$estimate.1 * 100
df.tHSD$high.pct <- df.tHSD$conf.high / df.tHSD$estimate.1 * 100
tb1 <- kbl(df.tHSD.pub, format = 'html', caption = "Table S2: ANOVA and Tukey HSD Results", digits = 3, escape = F) %>% kable_classic_2(font_size = 14, full_width = F)
as_image(x = tb1, width = 10, file = "STable2_tHSD_test_results.png", zoom = 5.0)
df.tHSD$diff.pct <- df.tHSD$estimate / df.tHSD$estimate.1 * 100
df.tHSD$low.pct <- df.tHSD$conf.low / df.tHSD$estimate.1 * 100
df.tHSD$high.pct <- df.tHSD$conf.high / df.tHSD$estimate.1 * 100
#Select and sort the tukey HSD columns and
df.tHSD.sup <- df.tHSD %>% dplyr::select(variable, contrast, estimate.1, estimate.2, estimate, conf.low, conf.high, diff.pct, high.pct, low.pct, adj.p.value)
#Name the columns of the data frame
colnames(df.tHSD.sup) <- c('Variable', 'Comparison', 'Estimate 1', 'Estimate 2','Difference', 'Low 95% CI', 'High 95% CI', 'Difference (%)', 'Low (%)', 'High (%)', 'p-value')
#ANOVA and Tukey HSD comparing by time period and drought sequence, same as Table S3 plus % changes
tb3 <- kbl(df.tHSD.sup, format = 'html', caption = "Table S15: ANOVA and Tukey HSD Results", digits = 3, escape = F) %>% kable_classic_2(font_size = 14, full_width = F)
as_image(x = tb3, width = 10, file = "STable15_tHSD_test_results.png", zoom = 5.0)
all.ca.both <- all.ca %>% dplyr::filter(drought.sequence == 'Both Droughts')
all.ca.2015 <- all.ca %>% dplyr::filter(drought.sequence == '2012-2015 Only')
#Paired t-tests for Geo-spatial data sets
#Biomass
biomass.both.t <- t.test(data = all.ca.both, x = all.ca.both$biomass_1999, y = all.ca.both$biomass_2012, paired = TRUE)
biomass.2015.t <- t.test(data = all.ca.2015, x = all.ca.2015$biomass_1999, y = all.ca.2015$biomass_2012, paired = TRUE)
#four-year Pr-ET
PET_4yr.both.t <- t.test(data = all.ca.both, x = all.ca.both$PET_4yr_2002, y = all.ca.both$PET_4yr_2015, paired = TRUE)
PET_4yr.2015.t <- t.test(data = all.ca.2015, x = all.ca.2015$PET_4yr_2002, y = all.ca.2015$PET_4yr_2015, paired = TRUE)
#four-year Precip
ppt_4yr.both.t <- t.test(data = all.ca.both, x = all.ca.both$ppt_4yr_2002, y = all.ca.both$ppt_4yr_2015, paired = TRUE)
ppt_4yr.2015.t <- t.test(data = all.ca.2015, x = all.ca.2015$ppt_4yr_2002, y = all.ca.2015$ppt_4yr_2015, paired = TRUE)
#four-year ET
ET_4yr.both.t <- t.test(data = all.ca.both, x = all.ca.both$ET_4yr_2002, y = all.ca.both$ET_4yr_2015, paired = TRUE)
ET_4yr.2015.t <- t.test(data = all.ca.2015, x = all.ca.2015$ET_4yr_2002, y = all.ca.2015$ET_4yr_2015, paired = TRUE)
#four-year Tmax
tmax_4yr.both.t <- t.test(data = all.ca.both, x = all.ca.both$tmax_4yr_2002, y = all.ca.both$tmax_4yr_2015, paired = TRUE)
tmax_4yr.2015.t <- t.test(data = all.ca.2015, x = all.ca.2015$tmax_4yr_2002, y = all.ca.2015$tmax_4yr_2015, paired = TRUE)
#dNDMI
dNDMI.both.t <- t.test(data = all.ca.both, x = all.ca.both$dNDMI_2004, y = all.ca.both$dNDMI_2017, paired = TRUE)
dNDMI.2015.t <- t.test(data = all.ca.2015, x = all.ca.2015$dNDMI_2004, y = all.ca.2015$dNDMI_2017, paired = TRUE)
#Combine all the t-test results in a list
t <- list(biomass.both.t, biomass.2015.t, dNDMI.both.t, dNDMI.2015.t,
PET_4yr.both.t, PET_4yr.2015.t, tmax_4yr.both.t, tmax_4yr.2015.t)
#Combine the t-test results in a data frame
df.t <- as.data.frame(purrr::map_df(t, tidy))
#Filtering by drought sequence
summary(all.ca)
all.ca.both <- all.ca %>% dplyr::filter(drought.sequence == 'Both Droughts')
all.ca.2015 <- all.ca %>% dplyr::filter(drought.sequence == '2nd Drought Only')
#Paired t-tests for Geo-spatial data sets
#Biomass
biomass.both.t <- t.test(data = all.ca.both, x = all.ca.both$biomass_1999, y = all.ca.both$biomass_2012, paired = TRUE)
biomass.2015.t <- t.test(data = all.ca.2015, x = all.ca.2015$biomass_1999, y = all.ca.2015$biomass_2012, paired = TRUE)
#four-year Pr-ET
PET_4yr.both.t <- t.test(data = all.ca.both, x = all.ca.both$PET_4yr_2002, y = all.ca.both$PET_4yr_2015, paired = TRUE)
PET_4yr.2015.t <- t.test(data = all.ca.2015, x = all.ca.2015$PET_4yr_2002, y = all.ca.2015$PET_4yr_2015, paired = TRUE)
#four-year Precip
ppt_4yr.both.t <- t.test(data = all.ca.both, x = all.ca.both$ppt_4yr_2002, y = all.ca.both$ppt_4yr_2015, paired = TRUE)
ppt_4yr.2015.t <- t.test(data = all.ca.2015, x = all.ca.2015$ppt_4yr_2002, y = all.ca.2015$ppt_4yr_2015, paired = TRUE)
#four-year ET
ET_4yr.both.t <- t.test(data = all.ca.both, x = all.ca.both$ET_4yr_2002, y = all.ca.both$ET_4yr_2015, paired = TRUE)
ET_4yr.2015.t <- t.test(data = all.ca.2015, x = all.ca.2015$ET_4yr_2002, y = all.ca.2015$ET_4yr_2015, paired = TRUE)
#four-year Tmax
tmax_4yr.both.t <- t.test(data = all.ca.both, x = all.ca.both$tmax_4yr_2002, y = all.ca.both$tmax_4yr_2015, paired = TRUE)
tmax_4yr.2015.t <- t.test(data = all.ca.2015, x = all.ca.2015$tmax_4yr_2002, y = all.ca.2015$tmax_4yr_2015, paired = TRUE)
#dNDMI
dNDMI.both.t <- t.test(data = all.ca.both, x = all.ca.both$dNDMI_2004, y = all.ca.both$dNDMI_2017, paired = TRUE)
dNDMI.2015.t <- t.test(data = all.ca.2015, x = all.ca.2015$dNDMI_2004, y = all.ca.2015$dNDMI_2017, paired = TRUE)
t <- list(biomass.both.t, biomass.2015.t, dNDMI.both.t, dNDMI.2015.t,
PET_4yr.both.t, PET_4yr.2015.t, tmax_4yr.both.t, tmax_4yr.2015.t)
#Combine the t-test results in a data frame
df.t <- as.data.frame(purrr::map_df(t, tidy))
#Add a variable label column
df.t$variable <- c('Biomass (Mg ha<sup>-1</sup>)','Biomass (Mg ha<sup>-1</sup>)','dNDMI','dNDMI',
'Pr-ET (mm 4yr<sup>-1</sup>)','Pr-ET (mm 4yr<sup>-1</sup>)','Temperature (C)','Temperature (C)')
#Add a drought sequence column
df.t$sequence <- c('Both Droughts', '2nd Drougth Only', 'Both Droughts', '2nd Drougth Only',
'Both Droughts', '2nd Drougth Only','Both Droughts', '2nd Drougth Only')
#Add mean values for 1999-2002
df.t$value.1999 <- c(mean(all.ca.both$biomass_1999), mean(all.ca.2015$biomass_1999), mean(all.ca.both$dNDMI_2004), mean(all.ca.2015$dNDMI_2004),
mean(all.ca.both$PET_4yr_2002), mean(all.ca.2015$PET_4yr_2002), mean(all.ca.both$tmax_4yr_2002), mean(all.ca.2015$tmax_4yr_2002))
#Add mean values for 2012-2015
df.t$value.2012 <- c(mean(all.ca.both$biomass_2012), mean(all.ca.2015$biomass_2012), mean(all.ca.both$dNDMI_2017), mean(all.ca.2015$dNDMI_2017),
mean(all.ca.both$PET_4yr_2015), mean(all.ca.2015$PET_4yr_2015), mean(all.ca.both$tmax_4yr_2015), mean(all.ca.2015$tmax_4yr_2015))
#Select columns and put them in order
df.t.label <- df.t %>% dplyr::select(variable, sequence, value.1999, value.2012, estimate, conf.low, conf.high, statistic, p.value)
#Give the different columns names
colnames(df.t.label) <- c('Variable','Drought Sequence', 'Estimate 1', 'Estimate 2', 'Difference', 'Low 95% CI', 'High 95% CI', 't', 'p-value')
tb2 <- kbl(df.t.label, format = 'html', caption = "Table S1: Paired two-tailed T-Test Results", escape = F, digits = 3) %>% kable_classic_2(font_size = 14, full_width = F)
as_image(x = tb2, width = 10, file = "STable1_paired_t_test_results.png", zoom = 5.0)
df.t$diff.pct <- df.t$estimate / df.t$value.1999 * 100
df.t$low.pct <- df.t$conf.low / df.t$value.1999 * 100
df.t$high.pct <- df.t$conf.high / df.t$value.1999 * 100
#Select columns
df.t.sup <- df.t %>% dplyr::select(variable, sequence, value.1999, value.2012, estimate, conf.low, conf.high, diff.pct, low.pct, high.pct, statistic, p.value, parameter)
#Give the different columns names
colnames(df.t.sup) <- c('Variable','Drought Sequence', 'Estimate 1', 'Estimate 2', 'Difference', 'Low 95% CI', 'High 95% CI', 'Difference (%)', 'Low (%)', 'High (%)', 't', 'p-value', 'df (n-1)')
#Paired T-test table
tb4 <- kbl(df.t.sup, format = 'html', caption = "Table S7: Paired two-tailed T-Test Results", escape = F, digits = 3) %>% kable_classic_2(font_size = 14, full_width = F)
as_image(x = tb4, width = 10, file = "STable7_t_test_results.png", zoom = 5.0)
#Select out ADS die-off data for chi-square test
ADS.1999.both.alive <- all.ca.sample %>% dplyr::filter(sequence == 'Both Droughts' & drought == '1999-2002' & ADS.cat == 0) %>% count()
ADS.1999.both.alive
ADS.1999.both.dead <- all.ca.sample %>% dplyr::filter(sequence == 'Both Droughts' & drought == '1999-2002' & ADS.cat == 1) %>% count()
ADS.1999.both.dead
ADS.2015.both.alive <- all.ca.sample %>% dplyr::filter(sequence == 'Both Droughts' & drought == '2012-2015' & ADS.cat == 0) %>% count()
ADS.2015.both.alive
ADS.2015.both.dead <- all.ca.sample %>% dplyr::filter(sequence == 'Both Droughts' & drought == '2012-2015' & ADS.cat == 1) %>% count()
ADS.2015.both.dead
ADS.1999.second.alive <- all.ca.sample %>% dplyr::filter(sequence == '2nd Drought Only' & drought == '1999-2002' & ADS.cat == 0) %>% count()
ADS.1999.second.alive
ADS.1999.second.dead <- all.ca.sample %>% dplyr::filter(sequence == '2nd Drought Only' & drought == '1999-2002' & ADS.cat == 1) %>% count()
ADS.1999.second.dead
ADS.2015.second.alive <- all.ca.sample %>% dplyr::filter(sequence == '2nd Drought Only' & drought == '2012-2015' & ADS.cat == 0) %>% count()
ADS.2015.second.alive
ADS.2015.second.dead <- all.ca.sample %>% dplyr::filter(sequence == '2nd Drought Only' & drought == '2012-2015' & ADS.cat == 1) %>% count()
ADS.2015.second.dead
#Create a frequency matrix for a chi-square test
ADS <- matrix(c(as.numeric(ADS.1999.both.dead), as.numeric(ADS.2015.both.dead), as.numeric(ADS.1999.second.dead), as.numeric(ADS.2015.second.dead),
as.numeric(ADS.1999.both.alive), as.numeric(ADS.2015.both.alive), as.numeric(ADS.1999.second.alive), as.numeric(ADS.2015.second.alive)), ncol=2)
#Give the matrix column and row names
colnames(ADS) <- c("Mortality", "No Mortality")
rownames(ADS) <- c('Both Droughts: 1999-2002', 'Both Droughts: 2012-2015', '2nd Drought Only: 1999-2002','2nd Drought Only: 2012-2015')
#Convert the matrix to a data frame
ADS <- as.data.frame(ADS)
ADS
#Do the chi-squared test
mychi <- chisq.test(ADS)
#Print the results of the chi-square
mychi
#Print the expected result if there is no association
mychi$expected
#Calculate proportion of ADS mortality and no mortality by drought sequence and time period
#2012-2015 Only sample in 1999-2002
second.2002 <- all.ca.sample %>% filter(sequence == '2nd Drought Only' & drought == '1999-2002') %>% dplyr::select(ADS.cat) %>% sum()
second.2002.total <- all.ca.sample %>% filter(sequence == '2nd Drought Only' & drought == '1999-2002') %>% dplyr::select(ADS.cat) %>% count()
second.2002 / second.2002.total
#2nd Drought Only sample in 2012-2015
second.2015 <- all.ca.sample %>% filter(sequence == '2nd Drought Only' & drought == '2012-2015') %>% dplyr::select(ADS.cat) %>% sum()
second.2015.total <- all.ca.sample %>% filter(sequence == '2nd Drought Only' & drought == '2012-2015') %>% dplyr::select(ADS.cat) %>% count()
second.2015 / second.2015.total
#Both Droughts sample in 1999-2002
both.2002 <- all.ca.sample %>% filter(sequence == 'Both Droughts' & drought == '1999-2002') %>% dplyr::select(ADS.cat) %>% sum()
both.2002.total <- all.ca.sample %>% filter(sequence == 'Both Droughts' & drought == '1999-2002') %>% dplyr::select(ADS.cat) %>% count()
both.2002 / both.2002.total
#Both Droughts sample in 2012-2015
both.2015 <- all.ca.sample %>% filter(sequence == 'Both Droughts' & drought == '2012-2015') %>% dplyr::select(ADS.cat) %>% sum()
both.2015.total <- all.ca.sample %>% filter(sequence == 'Both Droughts' & drought == '2012-2015') %>% dplyr::select(ADS.cat) %>% count()
both.2015 / both.2015.total
dndmi.relimp
